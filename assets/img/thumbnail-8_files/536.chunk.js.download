/*! For license information please see undefined.LICENSE.txt */
(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["536"],{3865:function(e,t,n){(function(e){var t,r,i,s;(function e(n,r,i){function s(u,a){if(!r[u]){if(!n[u]){if(!a&&"function"==typeof t&&t)return t(u,!0);if(o)return o(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var l=r[u]={exports:{}};n[u][0].call(l.exports,function(e){return s(n[u][1][e]||e)},l,l.exports,e,n,r,i)}return r[u].exports}for(var o="function"==typeof t&&t,u=0;u<i.length;u++)s(i[u]);return s})({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./src/Api/Api");n.Api=r;var i=e("./src/FloodgateEngine");n.FloodgateEngine=i.FloodgateEngine},{"./src/Api/Api":5,"./src/FloodgateEngine":18}],2:[function(e,t,n){"use strict";var r=(function(){function e(e){if(!e)throw new Error("trackingSet must not be null");if(e.getList().length>32)throw new Error("trackingSet list size must be less than 32");this.isOrdered=e.getIsOrdered();this.trackedActivities=e.getList();this.currentIndex=0;this.activationMask=0;this.currentActivationFlags=0;this.isActivationByInitPending=!1;this.currentCounts=new Array(this.trackedActivities.length);this.currentStartTimes=new Array(this.trackedActivities.length);this.currentSessionCounts=new Array(this.trackedActivities.length);for(var t=0;t<this.trackedActivities.length;t++){this.currentCounts[t]=0;this.currentSessionCounts[t]=0}for(t=0;t<this.trackedActivities.length;t++){this.activationMask|=1<<t;this.trackedActivities[t].getCount()<1&&this.trackedActivities[t].setCount(1)}}e.prototype.getCount=function(e){return this.isValidIndex(e)?this.currentCounts[e]:0};e.prototype.getSessionCount=function(e){return this.isValidIndex(e)?this.currentSessionCounts[e]:0};e.prototype.getStartTime=function(e){return this.isValidIndex(e)?this.currentStartTimes[e]:null};e.prototype.moveSessionCountIntoBaseCount=function(e){if(!this.isValidIndex(e))return 0;var t=this.currentSessionCounts[e];this.currentSessionCounts[e]=0;return t};e.prototype.initCounts=function(e,t,n){void 0===n&&(n=!1);for(var r=0;r<this.trackedActivities.length&&!(this.isOrdered&&r>this.currentIndex);r++){if(r<t.length&&t[r]){this.currentSessionCounts[r]=this.currentCounts[r]=t[r].tracker.getSessionCount(t[r].index);this.currentStartTimes[r]=t[r].tracker.getStartTime(t[r].index)}this.trackedActivities[r].getIsAggregate()&&r<e.length&&(this.currentCounts[r]+=e[r]);this.hasCountCrossedThreshold(r)&&this.finishActivityAtIndex(r)}this.isActivated()&&!n&&(this.isActivationByInitPending=!0)};e.prototype.generateActivityIndexList=function(){for(var t=new Array,n=0;n<this.trackedActivities.length;n++){var r=new e.ActivityIndex;r.activity=this.trackedActivities[n].getActivity();r.index=n;t.push(r)}return t};e.prototype.incrementActivity=function(t,n){if(!this.isValidIndex(t))return e.IncrementResult.Pending;if(n<0)throw new Error("increment must be non-negative");if(this.isOrdered&&t>this.currentIndex)return e.IncrementResult.Pending;var r=!this.hasCountCrossedThreshold(t);this.currentCounts[t]+=n;this.currentSessionCounts[t]+=n;if(this.isActivationByInitPending)return this.isPermittedIndexForActivationByInit(t)?this.commitActivation():e.IncrementResult.Pending;if(!r||!this.hasCountCrossedThreshold(t))return e.IncrementResult.Pending;this.finishActivityAtIndex(t);return this.isActivated()?this.commitActivation():e.IncrementResult.SingleActivityActivated};e.prototype.startTime=function(e,t){this.isValidIndex(e)&&(this.currentStartTimes[e]=t||new Date)};e.prototype.stopTime=function(e,t){if(!this.isValidIndex(e))return 0;var n=this.currentStartTimes[e];this.currentStartTimes[e]=null;return n?n>(t=t||new Date)?0:(t.getTime()-n.getTime())/1e3:0};e.prototype.isValidIndex=function(e){return e<this.trackedActivities.length};e.prototype.isActivated=function(){return(this.currentActivationFlags&this.activationMask)===this.activationMask};e.prototype.finishActivityAtIndex=function(e){if(!this.isValidIndex(e))throw new Error("Index is not valid");this.currentActivationFlags|=1<<e;e+1<this.trackedActivities.length&&(this.currentIndex=e+1)};e.prototype.hasCountCrossedThreshold=function(e){if(!this.isValidIndex(e))throw new Error("Index is not valid");return this.currentCounts[e]>=this.trackedActivities[e].getCount()};e.prototype.isPermittedIndexForActivationByInit=function(e){return!this.isOrdered||e+1===this.currentCounts.length};e.prototype.commitActivation=function(){this.isActivationByInitPending=!1;return e.IncrementResult.AllActivitiesActivated};return e})();(function(e){var t=function(){};e.ActivityIndex=t;(function(e){e[e.Pending=0]="Pending";e[e.SingleActivityActivated=1]="SingleActivityActivated";e[e.AllActivitiesActivated=2]="AllActivitiesActivated"})(e.IncrementResult||(e.IncrementResult={}))})(r||(r={}));t.exports=r},{}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=(function(){function e(e,t,n){this.activity=e;this.count=t;this.isAggregate=n}e.prototype.getActivity=function(){return this.activity};e.prototype.getCount=function(){return this.count};e.prototype.setCount=function(e){this.count=e};e.prototype.getIsAggregate=function(){return this.isAggregate};return e})();n.ActivityTrackingData=r},{}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=(function(){function e(e,t){this.isOrdered=e;this.list=t}e.prototype.getIsOrdered=function(){return this.isOrdered};e.prototype.getList=function(){return this.list};return e})();n.ActivityTrackingSet=r},{}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./../ISurveyInfo");n.ISurveyInfo=r;var i=e("./IActivityListener");n.IActivityListener=i;var s=e("./IFloodgateSettingIdMap");n.IFloodgateSettingIdMap=s;var o=e("./IFloodgateStorageProvider");n.IFloodgateStorageProvider=o;var u=e("./IFloodgateStringProvider");n.IFloodgateStringProvider=u;var a=e("./ISurvey");n.ISurvey=a;var f=e("./ISurveyComponent");n.ISurveyComponent=f},{"./../ISurveyInfo":24,"./IActivityListener":6,"./IFloodgateSettingIdMap":7,"./IFloodgateStorageProvider":8,"./IFloodgateStringProvider":9,"./ISurvey":11,"./ISurveyComponent":12}],6:[function(e,t,n){"use strict";var r;(function(e){var t=(function(){function e(){}e.AppLaunch="AppLaunch";e.AppUsageTime="AppUsageTime";e.AppResume="AppResume";return e})();e.ActivityName=t})(r||(r={}));t.exports=r},{}],7:[function(e,t,n){"use strict";var r;(function(e){e.RoamingSettingIdMap={CampaignStates:1258,GovernedChannelStates:1257,SurveyActivationStats:1259}})(r||(r={}));t.exports=r},{}],8:[function(e,t,n){"use strict";var r;(function(e){(function(e){e[e.FloodgateSettings=0]="FloodgateSettings";e[e.SurveyActivationStats=1]="SurveyActivationStats";e[e.SurveyEventActivityStats=2]="SurveyEventActivityStats";e[e.CampaignDefinitions=3]="CampaignDefinitions";e[e.CampaignStates=4]="CampaignStates";e[e.GovernedChannelStates=5]="GovernedChannelStates"})(e.FileType||(e.FileType={}))})(r||(r={}));t.exports=r},{}],9:[function(e,t,n){"use strict";var r;(function(e){(function(e){e[e.NpsPromptTitle=0]="NpsPromptTitle";e[e.NpsPromptQuestion=1]="NpsPromptQuestion";e[e.NpsPromptYesLabel=2]="NpsPromptYesLabel";e[e.NpsPromptNotNowLabel=3]="NpsPromptNotNowLabel";e[e.NpsRatingQuestion=4]="NpsRatingQuestion";e[e.Nps11RatingValue0=5]="Nps11RatingValue0";e[e.Nps11RatingValue1=6]="Nps11RatingValue1";e[e.Nps11RatingValue2=7]="Nps11RatingValue2";e[e.Nps11RatingValue3=8]="Nps11RatingValue3";e[e.Nps11RatingValue4=9]="Nps11RatingValue4";e[e.Nps11RatingValue5=10]="Nps11RatingValue5";e[e.Nps11RatingValue6=11]="Nps11RatingValue6";e[e.Nps11RatingValue7=12]="Nps11RatingValue7";e[e.Nps11RatingValue8=13]="Nps11RatingValue8";e[e.Nps11RatingValue9=14]="Nps11RatingValue9";e[e.Nps11RatingValue10=15]="Nps11RatingValue10";e[e.Nps5RatingValue1=16]="Nps5RatingValue1";e[e.Nps5RatingValue2=17]="Nps5RatingValue2";e[e.Nps5RatingValue3=18]="Nps5RatingValue3";e[e.Nps5RatingValue4=19]="Nps5RatingValue4";e[e.Nps5RatingValue5=20]="Nps5RatingValue5";e[e.NpsCommentQuestion=21]="NpsCommentQuestion";e[e.PsatPromptTitle=22]="PsatPromptTitle";e[e.PsatPromptQuestion=23]="PsatPromptQuestion";e[e.PsatPromptYesLabel=24]="PsatPromptYesLabel";e[e.PsatPromptNotNowLabel=25]="PsatPromptNotNowLabel";e[e.PsatRatingQuestion=26]="PsatRatingQuestion";e[e.PsatRatingValue1=27]="PsatRatingValue1";e[e.PsatRatingValue2=28]="PsatRatingValue2";e[e.PsatRatingValue3=29]="PsatRatingValue3";e[e.PsatRatingValue4=30]="PsatRatingValue4";e[e.PsatRatingValue5=31]="PsatRatingValue5";e[e.PsatCommentQuestion=32]="PsatCommentQuestion";e[e.BpsPromptTitle=33]="BpsPromptTitle";e[e.BpsPromptQuestion=34]="BpsPromptQuestion";e[e.BpsPromptYesLabel=35]="BpsPromptYesLabel";e[e.BpsPromptNotNowLabel=36]="BpsPromptNotNowLabel";e[e.BpsRatingQuestion=37]="BpsRatingQuestion";e[e.BpsRatingValue1=38]="BpsRatingValue1";e[e.BpsRatingValue2=39]="BpsRatingValue2";e[e.BpsCommentQuestion=40]="BpsCommentQuestion"})(e.StringType||(e.StringType={}))})(r||(r={}));t.exports=r},{}],10:[function(e,t,n){"use strict";var r;(function(e){(function(e){e[e.Unselected=0]="Unselected";e[e.Yes=1]="Yes";e[e.No=2]="No"})(e.PromptButton||(e.PromptButton={}))})(r||(r={}));t.exports=r},{}],11:[function(e,t,n){"use strict";var r;(function(e){(function(e){e[e.Feedback=0]="Feedback";e[e.Nps=1]="Nps";e[e.Psat=2]="Psat";e[e.Bps=3]="Bps";e[e.Fps=4]="Fps";e[e.Nlqs=5]="Nlqs"})(e.Type||(e.Type={}));e.DOM_FEEDBACKSURVEY_TAGNAME="FeedbackSurvey";e.DOM_NPS_TAGNAME="Nps";e.DOM_PSAT_TAGNAME="Psat";e.DOM_BPS_TAGNAME="Bps";e.DOM_FPS_TAGNAME="Fps";e.DOM_NLQS_TAGNAME="Nlqs"})(r||(r={}));t.exports=r},{}],12:[function(e,t,n){"use strict";var r;(function(e){(function(e){e[e.Prompt="Prompt"]="Prompt";e[e.Comment="Comment"]="Comment";e[e.Rating="Rating"]="Rating";e[e.MultipleChoice="MultipleChoice"]="MultipleChoice"})(e.Type||(e.Type={}));e.DOM_PROMPT_TAGNAME="Prompt";e.DOM_COMMENT_TAGNAME="Comment";e.DOM_RATING_TAGNAME="Rating";e.DOM_MULTIPLECHOICE_TAGNAME="MultipleChoice";e.JSON_PROMPT_KEYNAME="prompt";e.JSON_COMMENT_KEYNAME="comment";e.JSON_RATING_KEYNAME="rating";e.JSON_MULTIPLECHOICE_KEYNAME="multipleChoice";e.JSON_APPLICATION_KEYNAME="application";e.JSON_EXTENDEDMANIFESTDATA_KEYNAME="extendedManifestData"})(r||(r={}));t.exports=r},{}],13:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var s=e("../Api/IFloodgateStorageProvider"),o=e("../FloodgateEngine"),u=e("../GovernedChannel"),a=e("../ISurveyInfo"),f=e("../Utils"),l=(function(){function e(){}e.deserialize=function(e){var t;e&&0===e.Type&&(t=c.deserialize(e));return void 0===t?null:t};e.prototype.validate=function(){return!0};return e})();n.CampaignLanguageRange=l;var c=(function(e){i(t,e);function t(){return e.call(this)||this}t.deserialize=function(e){var n=new t;e&&(n.languageSubTag=e.Value);return n.validate()?n:null};t.prototype.isInRange=function(e){if(f.isNullOrUndefined(e))return!1;var t=f.extractLanguageSubtag(e);return!f.isNullOrUndefined(t)&&t.toLocaleUpperCase()===this.languageSubTag.toLocaleUpperCase()};t.prototype.validate=function(){return!!e.prototype.validate.call(this)&&(!(f.isNullOrUndefined(this.languageSubTag)||!f.isString(this.languageSubTag))&&!!f.isValidLanguageSubTag(this.languageSubTag))};return t})(l);n.CampaignLanguageRangeLanguageSubtag=c;var h=(function(){function e(){}e.deserialize=function(e){var t;if(f.isNullOrUndefined(e))return null;switch(e.Type){case 0:t=p.deserialize(e);break;case 1:t=d.deserialize(e)}return void 0===t?null:t};e.prototype.validate=function(){return!0};return e})();n.CampaignScope=h;var p=(function(e){i(t,e);function t(){return e.call(this)||this}t.deserialize=function(e){return new t};t.prototype.isInScope=function(e){return!0};t.prototype.validate=function(){return!!e.prototype.validate.call(this)};return t})(h);n.CampaignScopeAny=p;var d=(function(e){i(t,e);function t(){return e.call(this)||this}t.deserialize=function(e){var n=new t,r=[];if(f.isNullOrUndefined(e))return null;for(var i in e.Languages)if(e.Languages.hasOwnProperty(i)){var s=e.Languages[i];s&&r.push(l.deserialize(s))}0===r.length&&(r=null);n.languageRanges=r;return n.validate()?n:null};t.prototype.isInScope=function(e){if(f.isNullOrUndefined(this.languageRanges))return!0;if(f.isNullOrUndefined(e)||!e.getLanguage())return!1;for(var t in this.languageRanges)if(this.languageRanges.hasOwnProperty(t)){if(this.languageRanges[t].isInRange(e.getLanguage()))return!0}return!1};t.prototype.validate=function(){if(!e.prototype.validate.call(this))return!1;if(this.languageRanges)for(var t in this.languageRanges)if(this.languageRanges.hasOwnProperty(t)&&!this.languageRanges[t])return!1;return!0};return t})(h);n.CampaignScopeEnvironmentCrossProduct=d;var v=(function(){function e(){}e.deserialize=function(e){var t;if(f.isNullOrUndefined(e))return null;switch(e.Type){case 0:t=m.deserialize(e);break;case 1:t=g.deserialize(e)}return void 0===t?null:t};e.prototype.validate=function(){return!0};return e})();n.CampaignDuration=v;var m=(function(e){i(t,e);function t(){return e.call(this)||this}t.deserialize=function(e){var n=new t;e&&(n.intervalSeconds=e.IntervalSeconds);return n.validate()?n:null};t.prototype.asTimeIntervalSeconds=function(){return this.intervalSeconds};t.prototype.validate=function(){return!!e.prototype.validate.call(this)&&!!f.isNumber(this.intervalSeconds)};return t})(v);n.CampaignDurationTimeInterval=m;var g=(function(e){i(t,e);function t(){return e.call(this)||this}t.deserialize=function(e){return new t};t.prototype.asTimeIntervalSeconds=function(){return null};return t})(v);n.CampaignDurationSingleBuildChange=g;var y=(function(){function e(){}e.deserialize=function(t){var n=new e;if(!f.isNullOrUndefined(t)){n.additionalData=[];for(var r=0,i=t;r<i.length;r++){"EmailAddress"===i[r]&&n.additionalData.push(a.AdditionalDataType.EmailAddress)}}return n.validate()?n:null};e.prototype.validate=function(){return!f.isNullOrUndefined(this.additionalData)};return e})();n.CampaignAdditionalDataRequested=y;var b=(function(){function e(){}e.deserialize=function(e){var t;e&&0===e.Type&&(t=w.deserialize(e));return void 0===t?null:t};e.prototype.validate=function(){return!0};return e})();n.CampaignDistribution=b;var w=(function(e){i(t,e);function t(){return e.call(this)||this}t.deserialize=function(e){var n=new t;if(e){n.maxDelaySeconds=e.MaxDelaySeconds;n.chunks=e.Chunks}return n.validate()?n:null};t.prototype.validate=function(){return!!e.prototype.validate.call(this)&&(!(!f.isNumber(this.maxDelaySeconds)||this.maxDelaySeconds<0)&&!(!f.isNumber(this.chunks)||this.chunks<0))};return t})(b);n.CampaignDistributionRamp=w;var E=(function(){function e(){}e.deserialize=function(e){var t;e&&0===e.Type&&(t=S.deserialize(e));return void 0===t?null:t};e.prototype.getActiveSurveyTimeIntervalSeconds=function(){var e=this.nominationPeriod.asTimeIntervalSeconds();return f.isNumber(e)?e:this.fallbackSurveyDurationSeconds};e.prototype.calculateSurveyStartTimeFromDate=function(e){return e||new Date};e.prototype.calculateSurveyExpirationTimeFromSurveyStartTime=function(e){e=e||new Date;return f.addSecondsWithoutOverflow(e,this.getActiveSurveyTimeIntervalSeconds())};e.prototype.getCampaignCooldown=function(e){return e?this.cooldownPeriod:this.nominationPeriod};e.prototype.validate=function(){if(f.isNullOrUndefined(this.nominationPeriod))return!1;f.isNullOrUndefined(this.cooldownPeriod)&&(this.cooldownPeriod=this.nominationPeriod);return!(!f.isNumber(this.nominationPeriod.asTimeIntervalSeconds())&&(!f.isNumber(this.fallbackSurveyDurationSeconds)||this.fallbackSurveyDurationSeconds<=0))};return e})();n.CampaignNominationScheme=E;var S=(function(e){i(t,e);function t(){return e.call(this)||this}t.deserialize=function(e){var n=new t;if(f.isNullOrUndefined(e))return null;e.DistributionModel&&(n.distributionModel=b.deserialize(e.DistributionModel));e.CooldownPeriod&&(n.cooldownPeriod=v.deserialize(e.CooldownPeriod));e.NominationPeriod&&(n.nominationPeriod=v.deserialize(e.NominationPeriod));n.fallbackSurveyDurationSeconds=e.FallbackSurveyDurationSeconds;n.percentageDenominator=e.PercentageDenominator;n.percentageNumerator=e.PercentageNumerator;return n.validate()?n:null};t.prototype.evaluateNominationRules=function(){var e=Math.random();return Math.floor(e*this.percentageDenominator)<this.percentageNumerator};t.prototype.validate=function(){return!!e.prototype.validate.call(this)&&(!(!f.isNumber(this.percentageDenominator)||!f.isNumber(this.percentageNumerator))&&(!(this.percentageDenominator<=0||this.percentageNumerator<0)&&!(this.percentageNumerator>this.percentageDenominator)))};return t})(E);n.CampaignNominationSchemeRatioPercentage=S;var x=(function(){function e(){}e.deserialize=function(e){var t;if(f.isNullOrUndefined(e))return null;switch(e.Type){case 0:t=T.deserialize(e);break;case 1:t=N.deserialize(e)}return void 0===t?null:t};e.prototype.validate=function(){return!0};return e})();n.CampaignSurveyEvent=x;var T=(function(e){i(t,e);function t(){return e.call(this)||this}t.deserialize=function(e){var n=new t;if(f.isNullOrUndefined(e))return null;n.activity=e.Activity;n.count=e.Count;n.isAggregate=e.IsAggregate;return n.validate()?n:null};t.prototype.validate=function(){return!!e.prototype.validate.call(this)&&(!(f.isNullOrUndefined(this.activity)||!f.isString(this.activity))&&(!(!f.isNumber(this.count)||this.count<=0)&&!!f.isBoolean(this.isAggregate)))};return t})(x);n.CampaignSurveyEventCountedActivity=T;var N=(function(e){i(t,e);function t(){return e.call(this)||this}t.deserialize=function(e){var n=new t,r=[];if(f.isNullOrUndefined(e))return null;for(var i in e.Sequence)if(e.Sequence.hasOwnProperty(i)){var s=e.Sequence[i];s&&r.push(T.deserialize(s))}0===r.length&&(r=null);n.sequence=r;return n.validate()?n:null};t.prototype.validate=function(){if(!e.prototype.validate.call(this))return!1;if(f.isNullOrUndefined(this.sequence))return!1;for(var t in this.sequence)if(this.sequence.hasOwnProperty(t)&&!this.sequence[t])return!1;return!0};return t})(x);n.CampaignSurveyEventCountedActivitySequence=N;var C=(function(){function e(){}e.deserialize=function(t,n){var r=new e;if(f.isNullOrUndefined(t))return null;r.prompt=L.deserialize(t.Prompt);r.rating=A.deserialize(t.Rating);r.comment=O.deserialize(t.Question);r.multipleChoice=k.deserialize(t.MultipleChoice);return r.validate(n)?r:null};e.prototype.validate=function(e){return!f.isNullOrUndefined(this.prompt)&&(e?!f.isNullOrUndefined(this.rating)||!f.isNullOrUndefined(this.multipleChoice)||!f.isNullOrUndefined(this.comment):!f.isNullOrUndefined(this.rating)&&!f.isNullOrUndefined(this.comment))};return e})();n.CampaignSurveyContent=C;var k=(function(){function e(){}e.deserialize=function(t){var n=new e;if(f.isNullOrUndefined(t))return null;n.question=t.Question;n.availableOptions=t.AvailableOptions;n.minNumberOfSelectedOptions=t.MinNumberOfSelectedOptions;n.maxNumberOfSelectedOptions=t.MaxNumberOfSelectedOptions;return n.validate()?n:null};e.prototype.validate=function(){if(f.isNullOrUndefined(this.question)||!f.isString(this.question)||f.isNullOrUndefined(this.availableOptions)||!Array.isArray(this.availableOptions)||this.availableOptions.length<2||f.isNullOrUndefined(this.minNumberOfSelectedOptions)||!f.isNumber(this.minNumberOfSelectedOptions)||f.isNullOrUndefined(this.maxNumberOfSelectedOptions)||!f.isNumber(this.maxNumberOfSelectedOptions))return!1;for(var e in this.availableOptions)if(this.availableOptions.hasOwnProperty(e)&&!f.isString(this.availableOptions[e]))return!1;return!0};return e})();n.CampaignSurveyContentMultipleChoice=k;var L=(function(){function e(){}e.deserialize=function(t){var n=new e;if(f.isNullOrUndefined(t))return null;n.title=t.Title;n.question=t.Question;n.yesLabel=t.YesLabel;n.noLabel=t.NoLabel;return n.validate()?n:null};e.prototype.validate=function(){return!(f.isNullOrUndefined(this.title)||!f.isString(this.title)||f.isNullOrUndefined(this.question)||!f.isString(this.question)||f.isNullOrUndefined(this.yesLabel)||!f.isString(this.yesLabel)||f.isNullOrUndefined(this.noLabel)||!f.isString(this.noLabel))};return e})();n.CampaignSurveyContentPrompt=L;var A=(function(){function e(){}e.deserialize=function(t){var n=new e;if(f.isNullOrUndefined(t))return null;n.isZeroBased=t.IsZeroBased;n.question=t.Question;n.ratingValuesAscending=t.RatingValuesAscending;return n.validate()?n:null};e.prototype.validate=function(){if(f.isNullOrUndefined(this.question)||!f.isString(this.question)||f.isNullOrUndefined(this.ratingValuesAscending)||!Array.isArray(this.ratingValuesAscending)||this.ratingValuesAscending.length<2||this.ratingValuesAscending.length>11)return!1;if(f.isNullOrUndefined(this.isZeroBased))this.isZeroBased=!1;else if(!f.isBoolean(this.isZeroBased))return!1;for(var e in this.ratingValuesAscending)if(this.ratingValuesAscending.hasOwnProperty(e)&&!f.isString(this.ratingValuesAscending[e]))return!1;return!0};return e})();n.CampaignSurveyContentRating=A;var O=(function(){function e(){}e.deserialize=function(t){var n=new e;if(f.isNullOrUndefined(t))return null;n.question=t.Question;return n.validate()?n:null};e.prototype.validate=function(){return!(f.isNullOrUndefined(this.question)||!f.isString(this.question))};return e})();n.CampaignSurveyContentComment=O;var M=(function(){function e(){}e.deserialize=function(e){var t;if(f.isNullOrUndefined(e))return null;switch(e.Type){case 0:t=H.deserialize(e);break;case 1:t=B.deserialize(e);break;case 2:t=_.deserialize(e);break;case 3:t=D.deserialize(e);break;case 4:t=P.deserialize(e)}return void 0===t?null:t};e.prototype.validate=function(){return!f.isNullOrUndefined(this.activationEvent)};return e})();n.CampaignSurveyTemplate=M;var _=(function(e){i(t,e);function t(){return e.call(this)||this}t.deserialize=function(e){var n=new t;if(f.isNullOrUndefined(e))return null;n.activationEvent=x.deserialize(e.ActivationEvent);n.content=C.deserialize(e.Content,!0);return n.validate()?n:null};t.prototype.validate=function(){return!(!e.prototype.validate.call(this)||f.isNullOrUndefined(this.content))};return t})(M);n.CampaignSurveyTemplateFps=_;var D=(function(e){i(t,e);function t(){return e.call(this)||this}t.deserialize=function(e){var n=new t;if(f.isNullOrUndefined(e))return null;n.activationEvent=x.deserialize(e.ActivationEvent);n.content=C.deserialize(e.Content);return n.validate()?n:null};t.prototype.validate=function(){return!(!e.prototype.validate.call(this)||f.isNullOrUndefined(this.content))};return t})(M);n.CampaignSurveyTemplateNlqs=D;var P=(function(e){i(t,e);function t(){return e.call(this)||this}t.deserialize=function(e){var n=new t;if(f.isNullOrUndefined(e))return null;n.activationEvent=x.deserialize(e.ActivationEvent);n.content=C.deserialize(e.Content);return n.validate()?n:null};t.prototype.validate=function(){return!(!e.prototype.validate.call(this)||f.isNullOrUndefined(this.content))};return t})(M);n.CampaignSurveyTemplateNps=P;var H=(function(e){i(t,e);function t(){return e.call(this)||this}t.deserialize=function(e){var n=new t;if(f.isNullOrUndefined(e))return null;n.activationEvent=x.deserialize(e.ActivationEvent);return n.validate()?n:null};t.prototype.validate=function(){return!!e.prototype.validate.call(this)};return t})(M);n.CampaignSurveyTemplateNps5PointStatic=H;var B=(function(e){i(t,e);function t(){return e.call(this)||this}t.deserialize=function(e){var n=new t;if(f.isNullOrUndefined(e))return null;n.activationEvent=x.deserialize(e.ActivationEvent);return n.validate()?n:null};t.prototype.validate=function(){return!!e.prototype.validate.call(this)};return t})(M);n.CampaignSurveyTemplateNps11PointStatic=B;var j=(function(){function e(){}e.deserialize=function(t){var n=new e;if(f.isNullOrUndefined(t))return null;n.campaignId=t.CampaignId;n.governedChannelType=t.GovernedChannelType;n.startTime=t.StartTimeUtc;n.endTime=t.EndTimeUtc;n.launcherType=t.LauncherType;var r=y.deserialize(t.AdditionalDataRequested);n.additionalDataRequested=r?r.additionalData:[];t.SurveyTemplate&&(n.surveyTemplate=M.deserialize(t.SurveyTemplate));t.NominationScheme&&(n.nominationScheme=E.deserialize(t.NominationScheme));t.Scope&&(n.scope=h.deserialize(t.Scope));return n.validate()?n:null};e.prototype.validate=function(){f.isNullOrUndefined(this.scope)&&(this.scope=new p);if(f.isNullOrUndefined(this.campaignId)||!f.isString(this.campaignId))return!1;if(!f.isNumber(this.governedChannelType)||!f.isEnumValue(this.governedChannelType,u.GovernedChannelType))return!1;if(f.isNullOrUndefined(this.nominationScheme))return!1;if(f.isNullOrUndefined(this.surveyTemplate))return!1;if(!f.isNullOrUndefined(this.launcherType)&&!f.isString(this.launcherType))return!1;if(f.isNullOrUndefined(this.startTime))this.startTime=f.getDistantFuture();else{if(!f.isUtcDatetimeString(this.startTime))return!1;this.startTime=f.stringToDate(this.startTime)}if(f.isNullOrUndefined(this.endTime))this.endTime=f.getDistantFuture();else{if(!f.isUtcDatetimeString(this.endTime))return!1;this.endTime=f.stringToDate(this.endTime)}return!0};return e})();n.CampaignDefinition=j;function F(e){var t=[];if(f.isNullOrUndefined(e))return{result:t,error:"Empty"};if(!Array.isArray(e))return{result:t,error:"Not an array"};for(var n=[],r=0;r<e.length;r++){var i=e[r];if(i){var s=j.deserialize(i);s?t.push(s):n.push(r)}else n.push(r)}return{result:t,error:n.length>0?"Invalid campaign definitions at indexes: "+n.toString():void 0}}n.FilterValidCampaignDefinitions=F;var I=(function(){function e(e){if(f.isNullOrUndefined(e))throw new Error("storage must not be null");this.storage=e}e.prototype.load=function(){var e,t=this.storage.read(s.FileType.CampaignDefinitions);if(f.isNullOrUndefined(t))return[];try{e=JSON.parse(t)}catch(e){o.FloodgateEngine.getTelemetryLogger().log_CampaignLoad_Failed(e.toString());return[]}return F(e).result};return e})();n.FileSystemCampaignDefinitionProvider=I},{"../Api/IFloodgateStorageProvider":8,"../FloodgateEngine":18,"../GovernedChannel":20,"../ISurveyInfo":24,"../Utils":41}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../Utils"),i=e("./CampaignDefinitionProvider"),s=e("./CampaignStateProvider"),o=e("./CampaignSurveyFactory"),u=(function(){function e(e,t,n,i,s,o){if(!e)throw new Error("stateProvider must not be null");if(!t)throw new Error("definitionProvider must not be null");if(!n)throw new Error("stringProvider must not be null");if(r.isNullOrUndefined(s))throw new Error("currentBuildNumber must not be null");this.campaignStates={};this.campaignDefinitions={};this.stateProvider=e;this.definitionProvider=t;this.stringProvider=n;this.environmentProvider=i;this.currentBuildNumber=s;o=o||new Date;this.refreshSurveyDefinitionsPrivate(null,o)}e.isStateUpForNomination=function(t,n,r,i){if(!t||!n)return!1;r=r||new Date;if(t.ForceCandidacy)return!0;var s=n.nominationScheme.getCampaignCooldown(t.IsCandidate&&t.DidCandidateTriggerSurvey);return!!s&&(!!e.hasBuildChangeDurationElapsed(s,t.LastNominationBuildNumber,i)||e.hasTimeIntervalDurationElapsed(s,t.getCooldownStartDate(),r))};e.isDateInRange=function(e,t,n){e=e||new Date;t=t||r.getDistantPast();n=n||r.getDistantFuture();return t.getTime()<=e.getTime()&&n.getTime()>=e.getTime()};e.hasTimeIntervalDurationElapsed=function(e,t,n){if(r.isNullOrUndefined(e)||!(e instanceof i.CampaignDurationTimeInterval))return!1;if(!t||!n)return!1;var s=r.addSecondsWithoutOverflow(t,e.intervalSeconds);return n.getTime()>=s.getTime()};e.hasBuildChangeDurationElapsed=function(e,t,n){return!r.isNullOrUndefined(e)&&e instanceof i.CampaignDurationSingleBuildChange&&(r.isNullOrUndefined(t)||r.isNullOrUndefined(n)?null===t!=(null===n):!(t===n))};e.isCampaignInScope=function(t,n,r){if(!t)return!1;n=n||new Date;return!!e.isDateInRangeWithDefinition(n,t)&&!(t.scope&&!t.scope.isInScope(r))};e.isDateInRangeWithDefinition=function(t,n){if(!n)return!1;t=t||new Date;return e.isDateInRange(t,n.startTime?n.startTime:r.getDistantFuture(),n.endTime)};e.prototype.getActiveSurveys=function(){var e={};for(var t in this.campaignStates)if(this.campaignStates.hasOwnProperty(t)){var n=this.campaignStates[t];if(!n.IsCandidate)continue;var r=this.campaignDefinitions[n.CampaignId];if(!r)continue;var i=o.CampaignSurveyFactory.makeSurvey(n,r.governedChannelType,r.surveyTemplate,this.stringProvider,r.additionalDataRequested,r.launcherType);if(!i)continue;e[i.getSurveyInfo().getId()]=i}return e};e.prototype.onCampaignSurveyActivated=function(e,t){var n=this.campaignStates[e];if(n){t=t||new Date;n.markCurrentSurveyTakenOnDate(t,this.campaignDefinitions[e].nominationScheme.cooldownPeriod.asTimeIntervalSeconds());this.saveCurrentState()}};e.prototype.getCampaignStates=function(){return this.campaignStates};e.prototype.getCampaignDefinitions=function(){return this.campaignDefinitions};e.prototype.onSurveyActivated=function(e){e&&this.onCampaignSurveyActivated(e.getBackEndId(),new Date)};e.prototype.refreshSurveyDefinitions=function(e){this.refreshSurveyDefinitionsPrivate(e,new Date)};e.prototype.getAppSurveys=function(){return this.getActiveSurveys()};e.prototype.saveCurrentState=function(){var e=r.makeArrayFromObjectValuesSortedByKeyString(this.campaignStates);this.stateProvider.save(e)};e.prototype.refreshSurveyDefinitionsPrivate=function(e,t){this.campaignStates={};this.campaignDefinitions={};this.loadAndFilterCampaignData(t,e);this.evaluateCampaigns(t)};e.prototype.loadAndFilterCampaignData=function(t,n){t=t||new Date;var i={},s=this.definitionProvider.load();for(var o in s)if(s.hasOwnProperty(o)){i[(l=s[o]).campaignId]=l;if(n&&n.indexOf(l.governedChannelType)<0)continue;if(!e.isCampaignInScope(l,t,this.environmentProvider))continue;this.campaignDefinitions[l.campaignId]=l}var u=this.stateProvider.load(),a=[];for(var o in u)if(u.hasOwnProperty(o)){var f=u[o];this.campaignDefinitions.hasOwnProperty(f.CampaignId)||a.push(f);this.campaignStates[f.CampaignId]=f}for(var o in a)if(a.hasOwnProperty(o)){if(!(f=a[o]))continue;var l,c=!1;(l=i[f.CampaignId])?e.isStateUpForNomination(f,l,t,this.currentBuildNumber)&&(c=!0):f.LastNominationTimeUtc.getTime()<=r.subtractSecondsWithoutOverflow(t,f.DeleteAfterSecondsWhenStale).getTime()&&(c=!0);c&&delete this.campaignStates[f.CampaignId]}};e.prototype.evaluateCampaigns=function(t){t=t||new Date;for(var n in this.campaignDefinitions)if(this.campaignDefinitions.hasOwnProperty(n)){var i=this.campaignDefinitions[n],o=this.campaignStates[i.campaignId];if(!o||e.isStateUpForNomination(o,i,t,this.currentBuildNumber)){var u=o?o.LastSurveyId:"",a=o?o.LastSurveyStartTimeUtc:r.getDistantPast(),f=o?o.LastSurveyExpirationTimeUtc:r.getDistantPast(),l=o?o.LastSurveyActivatedTimeUtc:r.getDistantPast(),c=o?o.LastCooldownEndTimeUtc:r.getDistantPast(),h=o&&o.ForceCandidacy||i.nominationScheme.evaluateNominationRules();if(h){u=r.guid();a=i.nominationScheme.calculateSurveyStartTimeFromDate(t);f=i.nominationScheme.calculateSurveyExpirationTimeFromSurveyStartTime(a)}var p=new s.CampaignState(i.campaignId,t,this.currentBuildNumber,i.nominationScheme.getActiveSurveyTimeIntervalSeconds(),!1,h,!1,l,u,a,f,c);this.campaignStates[p.CampaignId]=p}}};return e})();n.CampaignManager=u},{"../Utils":41,"./CampaignDefinitionProvider":13,"./CampaignStateProvider":15,"./CampaignSurveyFactory":16}],15:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../Api/IFloodgateStorageProvider"),i=e("../Constants"),s=e("../FloodgateEngine"),o=e("../StateProviderHelpers"),u=e("../Utils"),a=r.FileType,f=o.StateListType,l=(function(){function e(e,t,n,r,i,s,o,u,a,f,l,c){this.CampaignId=e;this.LastNominationTimeUtc=t;this.LastNominationBuildNumber=n;this.DeleteAfterSecondsWhenStale=r;this.ForceCandidacy=i;this.IsCandidate=s;this.DidCandidateTriggerSurvey=o;this.LastSurveyActivatedTimeUtc=u;this.LastSurveyId=a;this.LastSurveyStartTimeUtc=f;this.LastSurveyExpirationTimeUtc=l;this.LastCooldownEndTimeUtc=c;if(!this.validate())throw new Error("Constructor arguments are not valid")}e.deserialize=function(t){var n;if(!t)return null;try{n=new e(t.CampaignId,t.LastNominationTimeUtc,t.LastNominationBuildNumber,t.DeleteAfterSecondsWhenStale,!1,t.IsCandidate,t.DidCandidateTriggerSurvey,t.LastSurveyActivatedTimeUtc,t.LastSurveyId,t.LastSurveyStartTimeUtc,t.LastSurveyExpirationTimeUtc,t.LastCooldownEndTimeUtc)}catch(e){s.FloodgateEngine.getTelemetryLogger().log_Event(i.TelemetryEvent.CampaignState.Deserialize.Failed,{ErrorMessage:e.toString()});return null}return n};e.prototype.validate=function(){if(!this.CampaignId||!u.isString(this.CampaignId))return!1;if(u.isNullOrUndefined(this.LastNominationBuildNumber)||!u.isString(this.LastNominationBuildNumber))return!1;if(!u.isNumber(this.DeleteAfterSecondsWhenStale)||this.DeleteAfterSecondsWhenStale<0)return!1;if(!u.isBoolean(this.IsCandidate)||!u.isBoolean(this.DidCandidateTriggerSurvey))return!1;if(this.IsCandidate){if(u.isNullOrUndefined(this.LastSurveyStartTimeUtc)||u.isNullOrUndefined(this.LastSurveyExpirationTimeUtc))return!1;if(!u.isString(this.LastSurveyId))return!1}if(this.DidCandidateTriggerSurvey&&u.isNullOrUndefined(this.LastSurveyActivatedTimeUtc))return!1;if(u.isNullOrUndefined(this.LastSurveyId))this.LastSurveyId="";else if(!u.isString(this.LastSurveyId))return!1;if(u.isUtcDatetimeString(this.LastNominationTimeUtc))this.LastNominationTimeUtc=u.stringToDate(this.LastNominationTimeUtc);else if(!u.isDate(this.LastNominationTimeUtc))return!1;if(u.isNullOrUndefined(this.LastSurveyActivatedTimeUtc))this.LastSurveyActivatedTimeUtc=u.getDistantPast();else if(u.isUtcDatetimeString(this.LastSurveyActivatedTimeUtc))this.LastSurveyActivatedTimeUtc=u.stringToDate(this.LastSurveyActivatedTimeUtc);else if(!u.isDate(this.LastSurveyActivatedTimeUtc))return!1;if(u.isNullOrUndefined(this.LastSurveyStartTimeUtc))this.LastSurveyStartTimeUtc=u.getDistantPast();else if(u.isUtcDatetimeString(this.LastSurveyStartTimeUtc))this.LastSurveyStartTimeUtc=u.stringToDate(this.LastSurveyStartTimeUtc);else if(!u.isDate(this.LastSurveyStartTimeUtc))return!1;if(u.isNullOrUndefined(this.LastSurveyExpirationTimeUtc))this.LastSurveyExpirationTimeUtc=u.getDistantPast();else if(u.isUtcDatetimeString(this.LastSurveyExpirationTimeUtc))this.LastSurveyExpirationTimeUtc=u.stringToDate(this.LastSurveyExpirationTimeUtc);else if(!u.isDate(this.LastSurveyExpirationTimeUtc))return!1;if(u.isNullOrUndefined(this.LastCooldownEndTimeUtc))this.LastCooldownEndTimeUtc=u.getDistantPast();else if(u.isUtcDatetimeString(this.LastCooldownEndTimeUtc))this.LastCooldownEndTimeUtc=u.stringToDate(this.LastCooldownEndTimeUtc);else if(!u.isDate(this.LastCooldownEndTimeUtc))return!1;return!0};e.prototype.markCurrentSurveyTakenOnDate=function(e,t){this.DidCandidateTriggerSurvey=!0;this.LastSurveyActivatedTimeUtc=null!=e?e:new Date;this.LastCooldownEndTimeUtc=u.addSecondsWithoutOverflow(this.LastSurveyActivatedTimeUtc,t)};e.prototype.getCooldownStartDate=function(){return this.IsCandidate?this.DidCandidateTriggerSurvey?this.LastSurveyActivatedTimeUtc:this.LastSurveyStartTimeUtc:this.LastNominationTimeUtc};return e})();n.CampaignState=l;var c=(function(){function e(){}e.make=function(e,t){return t?new p(e,t):new d(e)};return e})();n.CampaignStateProviderFactory=c;var h=function(){},p=(function(){function e(e,t){if(!t)throw new Error("host-based storage must not be null");this.hostBasedStorage=t;e&&(this.fileBasedStateProvider=new d(e))}e.prototype.load=function(){var e,t=this.getStatesFromHost();this.fileBasedStateProvider&&(e=this.fileBasedStateProvider.load());return o.MergeAndUpdateCampaignStates(e,t).find(f.Merged)};e.prototype.save=function(e){var t=this;if(e){var n=this.getStatesFromHost(),r=o.MergeAndUpdateCampaignStates(e,n),i=r.find(f.ToBeUpdated),s=r.find(f.Merged);i&&i.forEach(function(e){var n=o.makeSettingItemValue(JSON.stringify(e));t.hostBasedStorage.upsertSettingItem(a[a.CampaignStates],e.CampaignId,n)});this.fileBasedStateProvider&&this.fileBasedStateProvider.save(s)}};e.prototype.getStatesFromHost=function(){var e=[],t=this.hostBasedStorage.readSettingList(a[a.CampaignStates]);for(var n in t)if(t.hasOwnProperty(n)){var r=t[n],u=o.extractSettingItemValueSubString(r),f={};try{f=JSON.parse(u);var c=l.deserialize(f);c&&e.push(c)}catch(e){s.FloodgateEngine.getTelemetryLogger().log_Event(i.TelemetryEvent.HostBasedCampaignStateProvider.GetStatesFromHost.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+e.toString()+".  Input:"+u})}}return e};return e})();n.HostBasedCampaignStateProvider=p;var d=(function(){function e(e){if(!e)throw new Error("storage must not be null");this.storage=e}e.prototype.load=function(){var e,t=this.storage.read(r.FileType.CampaignStates);if(!t)return[];try{e=JSON.parse(t);var n=[];e&&e.CampaignStates&&e.CampaignStates.forEach(function(e){var t=l.deserialize(e);t&&n.push(t)});return n}catch(e){s.FloodgateEngine.getTelemetryLogger().log_Event(i.TelemetryEvent.FileBasedCampaignStateProvider.Load.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+e.toString()+".  Input:"+t});return[]}};e.prototype.save=function(e){if(e){var t=new h;t.CampaignStates=e;var n=JSON.stringify(t);this.storage.write(r.FileType.CampaignStates,n)}};return e})();n.FileBasedCampaignStateProvider=d},{"../Api/IFloodgateStorageProvider":8,"../Constants":17,"../FloodgateEngine":18,"../StateProviderHelpers":26,"../Utils":41}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../SurveyEvents"),i=e("../Surveys/FpsSurvey"),s=e("../Surveys/NlqsSurvey"),o=e("../Surveys/NpsSurvey"),u=e("../Surveys/SurveyDataSource"),a=e("../Utils"),f=e("./CampaignDefinitionProvider"),l=(function(){function e(){}e.makeSurvey=function(t,n,r,u,a,l){return t&&r&&u?r instanceof f.CampaignSurveyTemplateNps5PointStatic?o.make5Point(e.makeSurveyDataSourceData(t,n,r,a,l),u):r instanceof f.CampaignSurveyTemplateNps11PointStatic?o.make11Point(e.makeSurveyDataSourceData(t,n,r,a,l),u):r instanceof f.CampaignSurveyTemplateFps?i.makeFps(e.makeSurveyDataSourceData(t,n,r,a,l),u,r):r instanceof f.CampaignSurveyTemplateNlqs?s.makeNlqs(e.makeSurveyDataSourceData(t,n,r,a,l),u,r):r instanceof f.CampaignSurveyTemplateNps?o.makeCustom(e.makeSurveyDataSourceData(t,n,r,a,l),u,r):null:null};e.makeSurveyDataSourceData=function(t,n,r,i,s){if(!t||!r)return null;var o=new u.SurveyDataSourceData;o.activationEvent=e.makeEvent(t,r.activationEvent);o.id=t.LastSurveyId;o.backEndIdentifier=t.CampaignId;o.expirationTimeUtc=a.dateToShortUtcString(t.LastSurveyExpirationTimeUtc);o.governedChannelType=n;o.startTimeUtc=a.dateToShortUtcString(t.LastSurveyStartTimeUtc);o.additionalDataRequested=i||[];o.launcherType=s||"";return o};e.makeCountedActivityEventData=function(e){if(!e)return null;var t=new r.CountedActivityEventData;t.activity=e.activity;t.count=e.count;t.isAggregate=e.isAggregate;return t};e.makeCountedActivityEvent=function(t,n){if(!t||!n)return null;var i=e.makeCountedActivityEventData(n);return i?new r.CountedActivityEvent(i):null};e.makeCountedActivitySequenceEvent=function(t,n){if(!t||!n)return null;var i=new r.CountedActivitySequenceEventData;i.sequence=[];for(var s=0,o=n.sequence;s<o.length;s++){var u=o[s],a=e.makeCountedActivityEventData(u);if(!a)return null;i.sequence.push(a)}return new r.CountedActivitySequenceEvent(i)};e.makeEvent=function(t,n){return n instanceof f.CampaignSurveyEventCountedActivity?e.makeCountedActivityEvent(t,n):n instanceof f.CampaignSurveyEventCountedActivitySequence?e.makeCountedActivitySequenceEvent(t,n):null};return e})();n.CampaignSurveyFactory=l},{"../SurveyEvents":32,"../Surveys/FpsSurvey":36,"../Surveys/NlqsSurvey":37,"../Surveys/NpsSurvey":38,"../Surveys/SurveyDataSource":40,"../Utils":41,"./CampaignDefinitionProvider":13}],17:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=(function(){function e(){}var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T;e.CampaignState=((t=function(){}).Deserialize=((n=function(){}).Failed="FloodgateCore_CampaignState_Deserialize_Failed",n),t);e.FileBasedCampaignStateProvider=((r=function(){}).Load=((i=function(){}).Failed="FloodgateCore_FileBasedCampaignStateProvider_Load_Failed",i),r);e.HostBasedCampaignStateProvider=((s=function(){}).GetStatesFromHost=((o=function(){}).Failed="FloodgateCore_HostBasedCampaignStateProvider_GetStatesFromHost_Failed",o),s);e.FloodgateEngine=((u=function(){}).Make=((a=function(){}).Failed="FloodgateCore_FloodgateEngine_Make_Failed",a),u.Start=((f=function(){}).Failed="FloodgateCore_FloodgateEngine_Start_Failed",f),u.OnSurveyActivated=((l=function(){}).ActivationStatsSuppressedSurvey="FloodgateCore_FloodgateEngine_OnSurveyActivated_ActivationStatsSuppressedSurvey",l.ClosedChannelType="FloodgateCore_FloodgateEngine_OnSurveyActivated_ClosedChannelType",l),u);e.GovernedChannelState=((c=function(){}).Deserialize=((h=function(){}).Failed="FloodgateCore_GovernedChannelState_Deserialize_Failed",h),c);e.FileBasedGovernedChannelStateProvider=((p=function(){}).Load=((d=function(){}).Failed="FloodgateCore_FileBasedGovernedChannelStateProvider_Load_Failed",d),p);e.HostBasedGovernedChannelStateProvider=((v=function(){}).GetStatesFromHost=((m=function(){}).Failed="FloodgateCore_HostBasedGovernedChannelStateProvider_GetStatesFromHost_Failed",m),v);e.SurveyStatCollectionActivation=((g=function(){}).FromJson=((y=function(){}).Failed="FloodgateCore_SurveyStatCollectionActivation_FromJson_Failed",y),g.ToJson=((b=function(){}).Failed="FloodgateCore_SurveyStatCollectionActivation_ToJson_Failed",b),g);e.HostBasedSurveyActivationStatsProvider=((w=function(){}).GetSurveyStatsFromHost=((E=function(){}).Failed="FloodgateCore_HostBasedSurveyActivationStatsProvider_GetSurveyStatsFromHost_Failed",E),w);e.SurveyStatCollectionEventActivity=((S=function(){}).FromJson=((x=function(){}).Failed="FloodgateCore_SurveyStatCollectionEventActivity_FromJson_Failed",x),S.ToJson=((T=function(){}).Failed="FloodgateCore_SurveyStatCollectionEventActivity_ToJson_Failed",T),S);return e})();n.TelemetryEvent=r},{}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./Api/IFloodgateStorageProvider"),i=e("./Campaign/CampaignDefinitionProvider"),s=e("./Campaign/CampaignManager"),o=e("./Campaign/CampaignStateProvider"),u=e("./Constants"),a=e("./FloodgateSettings"),f=e("./GovernedChannel"),l=e("./GovernedChannelStateProvider"),c=e("./Governor"),h=e("./SurveyActivityListener"),p=e("./SurveyStatCollectionActivation"),d=e("./SurveyStatCollectionEventActivity"),v=(function(){function e(){}e.prototype.log_TriggerMet=function(e,t,n){};e.prototype.log_UserSelected=function(e,t,n){};e.prototype.log_CampaignLoad_Failed=function(e){};e.prototype.log_Event=function(e,t){};return e})(),m=(function(){function e(t,n,r,i,s,o,u,a){this.candidateSurveys={};this.launchedSurveys={};this.launchedLaunchers=[];if(!t)throw new Error("surveyClient must not be null");if(!n)throw new Error("activityListener must not be null");if(!r)throw new Error("launcherFactory must not be null");if(!i)throw new Error("onSurveyActivatedCallback must not be null");if(!s)throw new Error("storage must not be null");if(!o)throw new Error("governor must not be null");if(!a)throw new Error("transporterFactory must not be null");this.surveyClient=t;this.activityListener=n;this.launcherFactory=r;this.onSurveyActivatedCallback=i;this.storage=s;this.governor=o;this.surveyActivationStatsProvider=u;e.transporterFactory=a;this.started=!1;this.loggedFirstStart=!1;this.setPendingSurveys(null);this.activityListener.clearSurveys();var f=this;this.activityListener.setCallback({run:function(e){f.onSurveyActivated(e)}})}e.setTelemetryLogger=function(t){if(!t)throw new Error("telemetryLogger must not be null");e.telemetryLogger=t};e.getTelemetryLogger=function(){return e.telemetryLogger};e.getTransportFactory=function(){return e.transporterFactory};e.make=function(t,n,r,a,f,d,v,m){try{var g=l.GovernedChannelStateProviderFactory.make(a,f),y=p.SurveyActivationStatsProviderFactory.make(a,f),b=o.CampaignStateProviderFactory.make(a,f);return new e(new s.CampaignManager(b,new i.FileSystemCampaignDefinitionProvider(a),d,v,t,new Date),new h({run:function(e){}}),n,r,a,new c.Governor(g),y,m)}catch(e){this.telemetryLogger.log_Event(u.TelemetryEvent.FloodgateEngine.Make.Failed,{ErrorMessage:e.toString()})}};e.prototype.mergeAndSave=function(){this.saveSettings();this.saveSurveyActivationHistory();this.saveSurveyEventActivityHistory();this.surveyClient.saveCurrentState();this.governor.saveChannelStates()};e.prototype.start=function(){if(!this.started)try{this.floodgateSettings=a.FloodgateSettings.fromJson(this.readString(r.FileType.FloodgateSettings));this.previousSurveyActivationStats=this.surveyActivationStatsProvider.load();this.previousSurveyEventActivityStats=d.SurveyStatCollectionEventActivity.fromJson(this.readString(r.FileType.SurveyEventActivityStats));var t=this.governor.getAvailableChannelData(),n=[];t.forEach(function(e){e&&n.push(e.getType())});this.surveyClient.refreshSurveyDefinitions(n);this.setPendingSurveys(this.surveyClient.getAppSurveys());this.updateActivityListenerWithCurrentSurveyDefinitions();this.started=!0;if(!this.loggedFirstStart){this.loggedFirstStart=!0;this.getActivityListener().logActivity("FloodgateFirstStart")}}catch(t){e.getTelemetryLogger().log_Event(u.TelemetryEvent.FloodgateEngine.Start.Failed,{ErrorMessage:t.toString()})}};e.prototype.stop=function(){if(this.started){this.mergeAndSave();this.setPendingSurveys(null);this.updateActivityListenerWithCurrentSurveyDefinitions();this.started=!1}};e.prototype.getActivityListener=function(){return this.activityListener};e.prototype.saveSettings=function(){this.storage.fileLock(r.FileType.FloodgateSettings);try{this.writeString(r.FileType.FloodgateSettings,a.FloodgateSettings.toJson(this.floodgateSettings))}finally{this.storage.fileUnlock(r.FileType.FloodgateSettings)}};e.prototype.saveSurveyActivationHistory=function(){this.storage.fileLock(r.FileType.SurveyActivationStats);try{var e=this.surveyActivationStatsProvider.load(),t=new p.SurveyStatCollectionActivation;for(var n in this.launchedSurveys)if(this.launchedSurveys.hasOwnProperty(n)){var i=new p.SurveyActivationStats,s=this.launchedSurveys[n];i.Type=s.getType();i.ExpirationTimeUtc=s.getSurveyInfo().getExpirationTimeUtc();i.ActivationTimeUtc=new Date;t.addStats(s.getSurveyInfo().getId(),i)}e.accumulate(t);this.surveyActivationStatsProvider.save(e);this.previousSurveyActivationStats=e}finally{this.storage.fileUnlock(r.FileType.SurveyActivationStats)}};e.prototype.saveSurveyEventActivityHistory=function(){this.storage.fileLock(r.FileType.SurveyEventActivityStats);try{var e=d.SurveyStatCollectionEventActivity.fromJson(this.readString(r.FileType.SurveyEventActivityStats)),t=new Date,n=new d.SurveyStatCollectionEventActivity,i=function(e){if(s.candidateSurveys.hasOwnProperty(e)){var r=new d.SurveyEventActivityStats,i=s.candidateSurveys[e];if(!i.getSurveyInfo().isActiveForDate(t))return"continue";r.ExpirationTimeUtc=i.getSurveyInfo().getExpirationTimeUtc();var o=i.getSurveyInfo().getActivationEvent().getTrackingSet(),u=[];o.getList().forEach(function(e){e&&e.getIsAggregate()&&u.push(e.getActivity())});if(0===u.length)return"continue";r.Counts=new Array(u.length);for(var a=0;a<u.length;a++)r.Counts[a]=s.activityListener.moveSessionCountIntoBaseCount(u[a]);n.addStats(i.getSurveyInfo().getId(),r)}},s=this;for(var o in this.candidateSurveys)i(o);e.accumulate(n);this.writeString(r.FileType.SurveyEventActivityStats,d.SurveyStatCollectionEventActivity.toJson(e));this.previousSurveyEventActivityStats=e}finally{this.storage.fileUnlock(r.FileType.SurveyEventActivityStats)}};e.prototype.setPendingSurveys=function(e){this.candidateSurveys=e||{}};e.prototype.updateActivityListenerWithCurrentSurveyDefinitions=function(){var t=new Array;for(var n in this.candidateSurveys)if(this.candidateSurveys.hasOwnProperty(n)){var r=this.candidateSurveys[n];if(this.previousSurveyActivationStats.getBySurveyId(r.getSurveyInfo().getId()))continue;if(!r.getSurveyInfo().isActiveForDate(new Date))continue;e.telemetryLogger.log_UserSelected(r.getSurveyInfo().getBackEndId(),r.getSurveyInfo().getId(),r.getType());t.push(r)}this.activityListener.setSurveys(t,this.previousSurveyEventActivityStats)};e.prototype.onSurveyActivated=function(t){e.telemetryLogger.log_TriggerMet(t.getSurveyInfo().getBackEndId(),t.getSurveyInfo().getId(),t.getType());var n=!1,r=t.getSurveyInfo().getGovernedChannelType();if(this.candidateSurveys[t.getSurveyInfo().getId()])if(t.getSurveyInfo().isActiveForDate(new Date)){this.governor.refreshChannelData();if(this.governor.isChannelOpen(r)){if(this.surveyActivationStatsProvider.load().getBySurveyId(t.getSurveyInfo().getId()))e.getTelemetryLogger().log_Event(u.TelemetryEvent.FloodgateEngine.OnSurveyActivated.ActivationStatsSuppressedSurvey,{CampaignId:t.getSurveyInfo().getBackEndId(),SurveyId:t.getSurveyInfo().getId()});else if(0===Object.keys(this.launchedSurveys).length){this.launchedSurveys[t.getSurveyInfo().getId()]=t;n=!0}}else e.getTelemetryLogger().log_Event(u.TelemetryEvent.FloodgateEngine.OnSurveyActivated.ClosedChannelType,{ClosedChannelType:f.GovernedChannelType[r]})}else;else;this.mergeAndSave();this.activityListener.clearSurveys();if(n){this.governor.startChannelCooldown(r);this.surveyClient.onSurveyActivated(t.getSurveyInfo());this.launchLauncher(t)}};e.prototype.readString=function(e){return this.storage.read(e)};e.prototype.writeString=function(e,t){this.storage.write(e,t)};e.prototype.launchLauncher=function(e){var t=this.launcherFactory.makeSurveyLauncher(e);if(t){this.launchedLaunchers.push(t);this.onSurveyActivatedCallback.onSurveyActivated(t,e)}};e.telemetryLogger=new v;return e})();n.FloodgateEngine=m},{"./Api/IFloodgateStorageProvider":8,"./Campaign/CampaignDefinitionProvider":13,"./Campaign/CampaignManager":14,"./Campaign/CampaignStateProvider":15,"./Constants":17,"./FloodgateSettings":19,"./GovernedChannel":20,"./GovernedChannelStateProvider":21,"./Governor":22,"./SurveyActivityListener":27,"./SurveyStatCollectionActivation":34,"./SurveyStatCollectionEventActivity":35}],19:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=(function(){function e(){}e.toJson=function(e){return JSON.stringify(e)};e.fromJson=function(e){return JSON.parse(e)};return e})();n.FloodgateSettings=r},{}],20:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i=e("./Utils");(function(e){e[e.Standard=0]="Standard";e[e.Urgent=1]="Urgent"})(r=n.GovernedChannelType||(n.GovernedChannelType={}));(function(e){e.getDefault=function(){return e.Standard}})(r=n.GovernedChannelType||(n.GovernedChannelType={}));var s=(function(){function e(e,t,n,s){if(!i.isEnumValue(e,r))throw new Error("type is not a valid GovernedChannelType");if(!t)throw new Error("name must not be null or empty");if(n<0)throw new Error("cooldownSeconds must not be negative");this.type=e;this.name=t;this.cooldownSeconds=n;this.setCooldownStartTime(s)}e.prototype.setCooldownStartTime=function(e){this.cooldownStartTime=e;i.isNullOrUndefined(this.cooldownStartTime)?this.cooldownEndTime=i.getDistantPast():0!==this.cooldownSeconds&&(this.cooldownEndTime=i.addSecondsWithoutOverflow(this.cooldownStartTime,this.cooldownSeconds))};e.prototype.isOpen=function(){return this.isOpenAtDate(new Date)};e.prototype.isOpenAtDate=function(e){return!!e&&e>this.cooldownEndTime};e.prototype.getType=function(){return this.type};e.prototype.getName=function(){return this.name};e.prototype.getCooldownSeconds=function(){return this.cooldownSeconds};e.prototype.getCooldownStartTime=function(){return this.cooldownStartTime};e.prototype.getCooldownEndTime=function(){return this.cooldownEndTime};return e})();n.GovernedChannel=s},{"./Utils":41}],21:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./Api/IFloodgateStorageProvider"),i=e("./Constants"),s=e("./FloodgateEngine"),o=e("./GovernedChannel"),u=e("./StateProviderHelpers"),a=e("./Utils"),f=r.FileType,l=u.StateListType,c=(function(){function e(e,t){this.ChannelType=e;this.CooldownStartTimeUtc=t;if(!this.validate())throw new Error("Constructor arguments are not valid")}e.deserialize=function(t){var n;if(!t)return null;try{n=new e(t.ChannelType,t.CooldownStartTimeUtc)}catch(e){s.FloodgateEngine.getTelemetryLogger().log_Event(i.TelemetryEvent.GovernedChannelState.Deserialize.Failed,{ErrorMessage:e.toString()});return null}return n};e.prototype.validate=function(){if(!a.isEnumValue(this.ChannelType,o.GovernedChannelType))return!1;a.isUtcDatetimeString(this.CooldownStartTimeUtc)?this.CooldownStartTimeUtc=a.stringToDate(this.CooldownStartTimeUtc):!a.isNullOrUndefined(this.CooldownStartTimeUtc)&&a.isDate(this.CooldownStartTimeUtc)||(this.CooldownStartTimeUtc=a.getDistantPast());return!0};e.prototype.getType=function(){return this.ChannelType};e.prototype.getCooldownStartTime=function(){return this.CooldownStartTimeUtc};return e})();n.GovernedChannelState=c;var h=(function(){function e(){}e.make=function(e,t){return t?new d(e,t):new v(e)};return e})();n.GovernedChannelStateProviderFactory=h;var p=function(){},d=(function(){function e(e,t){if(!t)throw new Error("host-based storage must not be null");this.hostBasedStorage=t;e&&(this.fileBasedStateProvider=new v(e))}e.prototype.load=function(){var e,t=this.getStatesFromHost();this.fileBasedStateProvider&&(e=this.fileBasedStateProvider.load());return u.MergeAndUpdateGovernedChannelStates(e,t).find(l.Merged)};e.prototype.save=function(e){var t=this;if(e){var n=this.getStatesFromHost(),r=u.MergeAndUpdateGovernedChannelStates(e,n),i=r.find(l.ToBeUpdated),s=r.find(l.Merged);i&&i.forEach(function(e){var n=u.makeSettingItemValue(JSON.stringify(e));t.hostBasedStorage.upsertSettingItem(f[f.GovernedChannelStates],String(e.getType()),n)});this.fileBasedStateProvider&&this.fileBasedStateProvider.save(s)}};e.prototype.getStatesFromHost=function(){var e=[],t=this.hostBasedStorage.readSettingList(f[f.GovernedChannelStates]);for(var n in t)if(t.hasOwnProperty(n)){var r=t[n],o=u.extractSettingItemValueSubString(r),a={};try{a=JSON.parse(o);var l=c.deserialize(a);l&&e.push(l)}catch(e){s.FloodgateEngine.getTelemetryLogger().log_Event(i.TelemetryEvent.HostBasedGovernedChannelStateProvider.GetStatesFromHost.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+e.toString()+".  Input:"+o})}}return e};return e})();n.HostBasedGovernedChannelStateProvider=d;var v=(function(){function e(e){if(!e)throw new Error("storage must not be null");this.storage=e}e.prototype.load=function(){var e,t=this.storage.read(f.GovernedChannelStates);if(!t)return[];try{e=JSON.parse(t);var n=[];e&&e.ChannelStates&&e.ChannelStates.forEach(function(e){var t=c.deserialize(e);t&&n.push(t)});return n}catch(e){s.FloodgateEngine.getTelemetryLogger().log_Event(i.TelemetryEvent.FileBasedGovernedChannelStateProvider.Load.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+e.toString()+".  Input:"+t});return[]}};e.prototype.save=function(e){if(e){var t=new p;t.ChannelStates=e;var n=JSON.stringify(t);this.storage.write(f.GovernedChannelStates,n)}};return e})();n.FileBasedGovernedChannelStateProvider=v},{"./Api/IFloodgateStorageProvider":8,"./Constants":17,"./FloodgateEngine":18,"./GovernedChannel":20,"./StateProviderHelpers":26,"./Utils":41}],22:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./GovernedChannel"),i=e("./GovernedChannelStateProvider"),s=e("./Utils"),o=function(e,t){this.name=e;this.cooldownSeconds=t},u=(function(){function e(e){if(!e)throw new Error("channelStateProvider must not be null");this.channelStateProvider=e;this.loadChannels()}e.prototype.refreshChannelData=function(){this.loadChannels()};e.prototype.getAvailableChannelData=function(){var e=[];for(var t in this.channels)if(this.channels.hasOwnProperty(t)){var n=this.channels[t];n.isOpen()&&e.push(n)}return e};e.prototype.isChannelOpen=function(e){if(s.isNullOrUndefined(e))throw new Error("type must not be null");return this.channels[e].isOpen()};e.prototype.startChannelCooldown=function(e,t){if(s.isNullOrUndefined(e))throw new Error("type must not be null");t=t||new Date;this.channels[e].setCooldownStartTime(t);this.saveChannelStates()};e.prototype.saveChannelStates=function(){var e=[];for(var t in this.channels)if(this.channels.hasOwnProperty(t)){var n=this.channels[t],r=new i.GovernedChannelState(n.getType(),n.getCooldownStartTime());e.push(r)}this.channelStateProvider.save(e)};e.prototype.loadChannels=function(){this.loadChannelStatesFromProvider();for(var t in r.GovernedChannelType)if(r.GovernedChannelType.hasOwnProperty(t)){var n=Number(t);if(isNaN(n)||this.channels[n])continue;var i=e.defaultChannelData[n],s=new r.GovernedChannel(n,i.name,i.cooldownSeconds,null);this.channels[n]=s}};e.prototype.loadChannelStatesFromProvider=function(){this.channels=[];var t=this.channelStateProvider.load();for(var n in t)if(t.hasOwnProperty(n)){var i=t[n],s=i.getType(),o=e.defaultChannelData[s],u=new r.GovernedChannel(s,o.name,o.cooldownSeconds,i.getCooldownStartTime());this.channels[u.getType()]=u}};e.minute=60;e.hour=60*e.minute;e.day=24*e.hour;e.defaultChannelData=[new o(r.GovernedChannelType[r.GovernedChannelType.Standard],14*e.day),new o(r.GovernedChannelType[r.GovernedChannelType.Urgent],0)];return e})();n.Governor=u},{"./GovernedChannel":20,"./GovernedChannelStateProvider":21,"./Utils":41}],23:[function(e,t,n){"use strict";var r;(function(e){(function(e){e[e.CountedActivity="CountedActivity"]="CountedActivity";e[e.CountedActivitySequence="CountedActivitySequence"]="CountedActivitySequence"})(e.Type||(e.Type={}))})(r||(r={}));t.exports=r},{}],24:[function(e,t,n){"use strict";var r;(function(e){(function(e){e[e.Default="Default"]="Default";e[e.Notification="Notification"]="Notification";e[e.Modal="Modal"]="Modal"})(e.LaunchType||(e.LaunchType={}));(function(e){e[e.EmailAddress=0]="EmailAddress"})(e.AdditionalDataType||(e.AdditionalDataType={}));e.DOM_TYPE_TAGNAME="Type";e.DOM_TYPE_VALUE="Survey";e.DOM_ID_TAGNAME="SurveyID";e.JSON_SURVEY_KEYNAME="survey";e.JSON_ID_KEYNAME="surveyId"})(r||(r={}));t.exports=r},{}],25:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){};n.IndexedTracker=r},{}],26:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i=e("../src/SurveyStatCollectionActivation");(function(e){e[e.Merged=0]="Merged";e[e.ToBeUpdated=1]="ToBeUpdated"})(r=n.StateListType||(n.StateListType={}));var s=(function(){function e(){this.items={};this.itemCount=0}e.prototype.add=function(e,t){this.items[e]||this.itemCount++;this.items[e]=t};e.prototype.find=function(e){return this.items[e]};e.prototype.remove=function(e){var t=this.items[e];if(t){delete this.items[e];this.itemCount--}return t};e.prototype.count=function(){return this.itemCount};return e})();n.ItemCollection=s;n.extractSettingItemValueSubString=function(e){if(!e)return e;var t=e.indexOf(o)+o.length,n=e.indexOf(u);return t<0||n<0?e:e.substring(t,n)};n.makeSettingItemValue=function(e){return e?o+e+u:o+u};n.MergeAndUpdateGovernedChannelStates=function(e,t){var n=new s;if(!e&&!t)return n;if(!e){n.add(r.Merged,t);return n}if(!t){n.add(r.Merged,e);n.add(r.ToBeUpdated,e);return n}var i=[],o=[];e&&e.forEach(function(e){for(var n,r=-1,s=0;s<t.length;s++)if((n=t[s]).getType()===e.getType()){r=s;break}if(-1!==r){if(e.getCooldownStartTime()>n.getCooldownStartTime()){i.push(e);o.push(e)}else i.push(n);t.splice(r,1)}else{i.push(e);o.push(e)}});t&&t.forEach(function(e){i.push(e)});n.add(r.Merged,i);o.length>0&&n.add(r.ToBeUpdated,o);return n};n.MergeAndUpdateCampaignStates=function(e,t){var n=new s;if(!e&&!t)return n;if(!e){n.add(r.Merged,t);return n}if(!t){n.add(r.Merged,e);n.add(r.ToBeUpdated,e);return n}var i=[],o=[];e&&e.forEach(function(e){for(var n,r=new Date,s=-1,u=0;u<t.length;u++)if((n=t[u]).CampaignId===e.CampaignId){s=u;break}if(-1!==s)if(n.LastCooldownEndTimeUtc>r){i.push(n);t.splice(s,1)}else if(e.LastCooldownEndTimeUtc>r){i.push(e);o.push(e);t.splice(s,1)}else{if(e.getCooldownStartDate()>n.getCooldownStartDate()||e.getCooldownStartDate()===n.getCooldownStartDate()&&e.LastNominationTimeUtc>n.LastNominationTimeUtc){i.push(e);o.push(e)}else i.push(n);t.splice(s,1)}else{i.push(e);o.push(e)}});t&&t.forEach(function(e){i.push(e)});n.add(r.Merged,i);o.length>0&&n.add(r.ToBeUpdated,o);return n};n.MergeAndUpdateSurveyActivationStats=function(e,t){var n=new s;if(!e&&!t)return n;if(!e){n.add(r.Merged,t);return n}if(!t){n.add(r.Merged,e);n.add(r.ToBeUpdated,e);return n}var o=new i.SurveyStatCollectionActivation,u=new i.SurveyStatCollectionActivation,a=e.getStats(),f=t.getStats();for(var l in a)if(a.hasOwnProperty(l)){var c=f[l];if(!c){o.addStats(l,a[l]);u.addStats(l,a[l]);continue}if(a[l].ActivationTimeUtc>c.ActivationTimeUtc){o.addStats(l,a[l]);u.addStats(l,a[l])}else o.addStats(l,f[l]);delete f[l]}for(var l in f)f.hasOwnProperty(l)&&o.addStats(l,f[l]);n.add(r.Merged,o);var h=u.getStats();for(var p in h)if(h.hasOwnProperty(p)){n.add(r.ToBeUpdated,u);break}return n};var o="<data>",u="</data>"},{"../src/SurveyStatCollectionActivation":34}],27:[function(e,t,n){"use strict";var r=e("./ActivityTracker"),i=e("./IndexedTracker"),s=e("./SurveyStatCollectionEventActivity"),o=(function(){function e(e){if(!e)throw new Error("callback must not be null");this.trackedActivityMap={};this.callback=e}e.prototype.logActivity=function(t,n){void 0===n&&(n=1);this.logActivity_private(t,e.LogActionType.Increment,n,null)};e.prototype.logActivityStartTime=function(t,n){this.logActivity_private(t,e.LogActionType.StartTime,0,n)};e.prototype.logActivityStopTime=function(t,n){this.logActivity_private(t,e.LogActionType.StopTime,0,n)};e.prototype.setSurveys=function(e,t){void 0===t&&(t=new s.SurveyStatCollectionEventActivity);if(e&&0!==e.length&&t){for(var n=new Object,o=0,u=e;o<u.length;o++){for(var a=u[o],f=a.getSurveyInfo().getActivationEvent().getTrackingSet(),l=!1,c=0,h=f.getList();c<h.length;c++){var p=h[c];if(n.hasOwnProperty(p.getActivity())){l=!0;break}}if(!l){for(var d=t.getBySurveyId(a.getSurveyInfo().getId()),v=[f.getList().length],m=new Array(f.getList().length),g=0,y=0,b=0,w=f.getList();b<w.length;b++){p=w[b];v[y]=0;p.getIsAggregate()&&d&&g<d.Counts.length&&(v[y]=d.Counts[g++]);m[y]=this.trackedActivityMap[p.getActivity()];y++}var E=new r(f);E.initCounts(v,m,!1);for(var S=0,x=E.generateActivityIndexList();S<x.length;S++){var T=x[S],N=new i.IndexedTracker;N.index=T.index;N.survey=a;N.tracker=E;n[T.activity]=N}}}this.copyObject(this.trackedActivityMap,n)}};e.prototype.clearSurveys=function(){var e=this;Object.getOwnPropertyNames(this.trackedActivityMap).forEach(function(t){delete e.trackedActivityMap[t]})};e.prototype.getCount=function(e){var t;return(t=this.trackedActivityMap[e])?t.tracker.getCount(t.index):0};e.prototype.getSessionCount=function(e){var t;return(t=this.trackedActivityMap[e])?t.tracker.getSessionCount(t.index):0};e.prototype.moveSessionCountIntoBaseCount=function(e){var t;return(t=this.trackedActivityMap[e])?t.tracker.moveSessionCountIntoBaseCount(t.index):0};e.prototype.getSurvey=function(e){var t;return(t=this.trackedActivityMap[e])?t.survey:null};e.prototype.setCallback=function(e){this.callback=e};e.prototype.logActivity_private=function(t,n,i,s){var o;if(o=this.trackedActivityMap[t]){switch(n){case e.LogActionType.StartTime:o.tracker.startTime(o.index,s);return;case e.LogActionType.StopTime:i=o.tracker.stopTime(o.index,s);case e.LogActionType.Increment:break;default:return}o.tracker.incrementActivity(o.index,i)===r.IncrementResult.AllActivitiesActivated&&this.executeCallback(o.survey)}};e.prototype.executeCallback=function(e){this.callback.run(e)};e.prototype.copyObject=function(e,t){Object.keys(t).forEach(function(n){e[n]=t[n]})};return e})();(function(e){(function(e){e[e.Increment=0]="Increment";e[e.StartTime=1]="StartTime";e[e.StopTime=2]="StopTime"})(e.LogActionType||(e.LogActionType={}))})(o||(o={}));t.exports=o},{"./ActivityTracker":2,"./IndexedTracker":25,"./SurveyStatCollectionEventActivity":35}],28:[function(e,t,n){"use strict";var r=e("./../Api/ISurveyComponent"),i=(function(){function e(e){if(!e)throw new Error("data must not be null");if(!e.question)throw new Error("data.question must not be null or empty");this.data=e;this.userComment=""}e.make=function(t){try{return new e(t)}catch(e){return null}};e.prototype.getType=function(){return r.Type.Comment};e.prototype.getQuestion=function(){return this.data.question};e.prototype.setSubmittedText=function(e){this.userComment=e};e.prototype.getSubmittedText=function(){return this.userComment};e.prototype.getDomElements=function(e){if(!e)throw new Error("Document must not be null");var t=e.createElement(r.DOM_COMMENT_TAGNAME);t.appendChild(e.createTextNode(this.getSubmittedText()));return[t]};e.prototype.getJsonElements=function(){var e={};e[r.JSON_COMMENT_KEYNAME]=this.getSubmittedText();return e};return e})();(function(e){var t=function(){};e.CommentComponentData=t})(i||(i={}));t.exports=i},{"./../Api/ISurveyComponent":12}],29:[function(e,t,n){"use strict";var r=e("./../Api/ISurveyComponent"),i=(function(){function e(e){if(!e)throw new Error("data must not be null");if(!e.question)throw new Error("data.question must not be null or empty");if(!e.availableOptions||e.availableOptions.length<2)throw new Error("data.availableOptions must not be null or have less than two choices");e.availableOptions.forEach(function(e){if(!e)throw new Error("Option values must not contain null or empty")});this.data=e;this.optionStates=new Array(e.availableOptions.length);for(var t=0;t<this.optionStates.length;t++)this.optionStates[t]=!1}e.make=function(t){try{return new e(t)}catch(e){return null}};e.prototype.getType=function(){return r.Type.MultipleChoice};e.prototype.getQuestion=function(){return this.data.question};e.prototype.getAvailableOptions=function(){return this.data.availableOptions};e.prototype.getOptionSelectedStates=function(){return this.optionStates};e.prototype.getMinNumberofSelectedOptions=function(){return this.data.minNumberOfSelectedOptions};e.prototype.getMaxNumberofSelectedOptions=function(){return this.data.maxNumberOfSelectedOptions};e.prototype.setOptionSelectedStates=function(e){for(var t=0;t<e.length;t++)this.optionStates[t]=e[t]};e.prototype.ValidateMinNumberofSelectedOptions=function(){var e=0;this.optionStates.forEach(function(t){t&&e++});return e>=this.getMinNumberofSelectedOptions()};e.prototype.ValidateMaxNumberofSelectedOptions=function(){var e=0;this.optionStates.forEach(function(t){t&&e++});return e<=this.getMaxNumberofSelectedOptions()};e.prototype.getDomElements=function(e){if(!e)throw new Error("Document must not be null");var t=e.createElement(r.DOM_MULTIPLECHOICE_TAGNAME);t.appendChild(e.createTextNode(this.getOptionSelectedStates().toString()));return[t]};e.prototype.getJsonElements=function(){var e={};e[r.JSON_MULTIPLECHOICE_KEYNAME]=this.getOptionSelectedStates().toString();return e};return e})();(function(e){var t=function(){};e.MultipleChoiceComponentData=t})(i||(i={}));t.exports=i},{"./../Api/ISurveyComponent":12}],30:[function(e,t,n){"use strict";var r=e("./../Api/IPrompt"),i=e("./../Api/ISurveyComponent"),s=(function(){function e(e){if(!e)throw new Error("data must not be null");if(!e.question)throw new Error("data.question must not be null or empty");if(!e.title)throw new Error("data.title must not be null or empty");if(!e.yesButtonLabel)throw new Error("data.yesButtonLabel must not be null or empty");if(!e.noButtonLabel)throw new Error("data.noButtonLabel must not be null or empty");this.data=e;this.selectedButton=r.PromptButton.Unselected}e.make=function(t){try{return new e(t)}catch(e){return null}};e.prototype.getType=function(){return i.Type.Prompt};e.prototype.getTitle=function(){return this.data.title};e.prototype.getQuestion=function(){return this.data.question};e.prototype.getYesButtonText=function(){return this.data.yesButtonLabel};e.prototype.getNoButtonText=function(){return this.data.noButtonLabel};e.prototype.setButtonSelected=function(e){e&&(this.selectedButton=e)};e.prototype.getButtonSelected=function(){return this.selectedButton};e.prototype.getDomElements=function(e){if(!e)throw new Error("Document must not be null");var t=e.createElement(i.DOM_PROMPT_TAGNAME);t.appendChild(e.createTextNode(this.promptButtonToString(this.getButtonSelected())));return[t]};e.prototype.getJsonElements=function(){var e={};e[i.JSON_PROMPT_KEYNAME]=this.promptButtonToString(this.getButtonSelected());return e};e.prototype.promptButtonToString=function(e){switch(e){case r.PromptButton.Unselected:return"Unselected";case r.PromptButton.Yes:return"Yes";case r.PromptButton.No:return"No";default:return"Unknown"}};return e})();(function(e){var t=function(){};e.PromptComponentData=t})(s||(s={}));t.exports=s},{"./../Api/IPrompt":10,"./../Api/ISurveyComponent":12}],31:[function(e,t,n){"use strict";var r=e("./../Api/ISurveyComponent"),i=(function(){function e(e){if(!e)throw new Error("data must not be null");if(!e.question)throw new Error("data.question must not be null or empty");if(!e.ratingValuesAscending||e.ratingValuesAscending.length<2)throw new Error("data.ratingValuesAscending must not be null or have less than two choices");e.ratingValuesAscending.forEach(function(e){if(!e)throw new Error("rating values must not contain null or empty")});this.data=e;this.selectedIndex=-1}e.make=function(t){try{return new e(t)}catch(e){return null}};e.prototype.getType=function(){return r.Type.Rating};e.prototype.getQuestion=function(){return this.data.question};e.prototype.getRatingValuesAscending=function(){return this.data.ratingValuesAscending};e.prototype.getSelectedRating=function(){return this.isRatingIndexValid(this.selectedIndex)?this.data.ratingValuesAscending[this.selectedIndex]:""};e.prototype.setSelectedRatingIndex=function(e){this.isRatingIndexValid(e)?this.selectedIndex=e:this.selectedIndex=-1};e.prototype.getSelectedRatingIndex=function(){return this.selectedIndex};e.prototype.getDomElements=function(e){if(!e)throw new Error("Document must not be null");var t=e.createElement(r.DOM_RATING_TAGNAME);this.isRatingIndexValid(this.getSelectedRatingIndex())?t.appendChild(e.createTextNode(this.getNormalizedRatingScore().toFixed(6))):t.appendChild(e.createTextNode("Not rated"));return[t]};e.prototype.getJsonElements=function(){var e={};this.isRatingIndexValid(this.getSelectedRatingIndex())?e[r.JSON_RATING_KEYNAME]=this.getNormalizedRatingScore():e[r.JSON_RATING_KEYNAME]="Not rated";return e};e.prototype.getNormalizedRatingScore=function(){return this.isRatingIndexValid(this.getSelectedRatingIndex())?this.data.isZeroBased?this.selectedIndex/(this.data.ratingValuesAscending.length-1):(this.selectedIndex+1)/this.data.ratingValuesAscending.length:-1};e.prototype.isRatingIndexValid=function(e){return e>=0&&e<this.data.ratingValuesAscending.length};return e})();(function(e){var t=function(){};e.RatingComponentData=t})(i||(i={}));t.exports=i},{"./../Api/ISurveyComponent":12}],32:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./ActivityTrackingData"),i=e("./ActivityTrackingSet"),s=e("./ISurveyEvent"),o=(function(){function e(e){if(!e)throw new Error("data must not be null");if(e.count<=0)throw new Error("count must be greater than 0");if(!e.activity||0===e.activity.length)throw new Error("activity must not be null or an empty string");this.data=e}e.make=function(t){try{return new e(t)}catch(e){return null}};e.prototype.getActivity=function(){return this.data.activity};e.prototype.getCount=function(){return this.data.count};e.prototype.isAggregate=function(){return this.data.isAggregate};e.prototype.getType=function(){return s.Type.CountedActivity};e.prototype.getTrackingSet=function(){var e=new Array;e.push(new r.ActivityTrackingData(this.data.activity,this.data.count,this.data.isAggregate));return new i.ActivityTrackingSet(!1,e)};return e})();n.CountedActivityEvent=o;var u=function(){};n.CountedActivityEventData=u;var a=(function(){function e(e){if(!e)throw new Error("data must not be null");if(!e.sequence)throw new Error("data.sequence must not be null");if(0===e.sequence.length)throw new Error("data.sequence size must be greater than 0");this.data=[];for(var t=0,n=e.sequence;t<n.length;t++){var r=n[t];this.data.push(new o(r))}}e.make=function(t){try{return new e(t)}catch(e){return null}};e.prototype.getSequence=function(){return this.data};e.prototype.getType=function(){return s.Type.CountedActivitySequence};e.prototype.getTrackingSet=function(){for(var e=new Array,t=0,n=this.data;t<n.length;t++){var s=n[t];e.push(new r.ActivityTrackingData(s.getActivity(),s.getCount(),s.isAggregate()))}return new i.ActivityTrackingSet(!0,e)};return e})();n.CountedActivitySequenceEvent=a;var f=(function(){function e(){}e.prototype.CountedActivitySequenceEventData=function(){};return e})();n.CountedActivitySequenceEventData=f},{"./ActivityTrackingData":3,"./ActivityTrackingSet":4,"./ISurveyEvent":23}],33:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=(function(){function e(){this.Surveys={};this.Surveys={}}e.prototype.addStats=function(e,t){this.Surveys[e]=t};e.prototype.getBySurveyId=function(e){return this.Surveys[e]};e.prototype.getStats=function(){return this.Surveys};return e})();n.SurveyStatCollection=r},{}],34:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var s=e("./Api/IFloodgateStorageProvider"),o=s.FileType,u=e("./Api/ISurvey"),a=e("./Constants"),f=e("./FloodgateEngine"),l=e("./StateProviderHelpers"),c=e("./SurveyStatCollection"),h=e("./Utils"),p=(function(e){i(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.fromJson=function(e){var n,r=new t;if(!e){f.FloodgateEngine.getTelemetryLogger().log_Event(a.TelemetryEvent.SurveyStatCollectionActivation.FromJson.Failed,{ErrorMessage:"Input json is null or empty."});return r}try{n=JSON.parse(e)}catch(e){f.FloodgateEngine.getTelemetryLogger().log_Event(a.TelemetryEvent.SurveyStatCollectionActivation.FromJson.Failed,{ErrorMessage:"Json parsing failed. "+e.toString()});return r}return r.deserialize(n)?r:new t};t.toJson=function(e){if(!e){f.FloodgateEngine.getTelemetryLogger().log_Event(a.TelemetryEvent.SurveyStatCollectionActivation.ToJson.Failed,{ErrorMessage:"Input json is null or empty."});e=new t}return JSON.stringify(e)};t.prototype.accumulate=function(e){if(e){var t=e.getStats();for(var n in t)t.hasOwnProperty(n)&&this.addStats(n,t[n])}};t.prototype.deserialize=function(e){var t=e.Surveys,n=new Date;for(var r in t)if(t.hasOwnProperty(r)){var i=new g;i.deserialize(t[r])&&i.ExpirationTimeUtc>n&&this.addStats(r,i)}return this.validate()};t.prototype.validate=function(){return h.isObject(this.getStats())};return t})(c.SurveyStatCollection);n.SurveyStatCollectionActivation=p;var d=(function(){function e(){}e.make=function(e,t){return t?new v(e,t):new m(e)};return e})();n.SurveyActivationStatsProviderFactory=d;var v=(function(){function e(e,t){if(!t)throw new Error("host-based storage must not be null");this.hostBasedStorage=t;e&&(this.fileBasedStorageProvider=new m(e))}e.prototype.load=function(){var e=this.getSurveyStatsFromHost(),t=new p;this.fileBasedStorageProvider&&(t=this.fileBasedStorageProvider.load());return l.MergeAndUpdateSurveyActivationStats(t,e).find(l.StateListType.Merged)};e.prototype.save=function(e){if(e){var t=this.getSurveyStatsFromHost(),n=l.MergeAndUpdateSurveyActivationStats(e,t),r=n.find(l.StateListType.ToBeUpdated),i=n.find(l.StateListType.Merged);if(r){var s=r.getStats();for(var u in s)if(s.hasOwnProperty(u)){var a=l.makeSettingItemValue(JSON.stringify(s[u]));this.hostBasedStorage.upsertSettingItem(o[o.SurveyActivationStats],u,a)}}this.fileBasedStorageProvider&&this.fileBasedStorageProvider.save(i)}};e.prototype.getSurveyStatsFromHost=function(){var e=new p,t=this.hostBasedStorage.readSettingList(o[o.SurveyActivationStats]);for(var n in t)if(t.hasOwnProperty(n)){var r=l.extractSettingItemValueSubString(t[n]),i=new g,s=void 0;try{s=JSON.parse(r);i.deserialize(s)}catch(e){f.FloodgateEngine.getTelemetryLogger().log_Event(a.TelemetryEvent.HostBasedSurveyActivationStatsProvider.GetSurveyStatsFromHost.Failed,{ErrorMessage:"Json parsing/deserializing failed. "+e.toString()+".  Input:"+r})}var u=new Date;i.ExpirationTimeUtc<=u?this.hostBasedStorage.deleteSettingItem(o[o.SurveyActivationStats],n):e.addStats(n,i)}return e};return e})();n.HostBasedSurveyActivationStatsProvider=v;var m=(function(){function e(e){if(!e)throw new Error("storage must not be null");this.storage=e}e.prototype.load=function(){var e=this.storage.read(s.FileType.SurveyActivationStats);return e?p.fromJson(e):new p};e.prototype.save=function(e){if(e){var t=p.toJson(e);this.storage.write(s.FileType.SurveyActivationStats,t)}};return e})();n.FileBasedSurveyActivationStatsProvider=m;var g=(function(){function e(){}e.prototype.deserialize=function(e){this.ActivationTimeUtc=e.ActivationTimeUtc;this.ExpirationTimeUtc=e.ExpirationTimeUtc;this.Type=e.Type;return this.validate()};e.prototype.validate=function(){if(!h.isUtcDatetimeString(this.ActivationTimeUtc))return!1;this.ActivationTimeUtc=h.stringToDate(this.ActivationTimeUtc);if(!h.isUtcDatetimeString(this.ExpirationTimeUtc))return!1;this.ExpirationTimeUtc=h.stringToDate(this.ExpirationTimeUtc);return h.isEnumValue(this.Type,u.Type)};return e})();n.SurveyActivationStats=g},{"./Api/IFloodgateStorageProvider":8,"./Api/ISurvey":11,"./Constants":17,"./FloodgateEngine":18,"./StateProviderHelpers":26,"./SurveyStatCollection":33,"./Utils":41}],35:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var s=e("./Constants"),o=e("./FloodgateEngine"),u=e("./SurveyStatCollection"),a=e("./Utils"),f=(function(e){i(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.fromJson=function(e){var n,r=new t;if(!e){o.FloodgateEngine.getTelemetryLogger().log_Event(s.TelemetryEvent.SurveyStatCollectionEventActivity.FromJson.Failed,{ErrorMessage:"Input json is null or empty."});return r}try{n=JSON.parse(e)}catch(e){o.FloodgateEngine.getTelemetryLogger().log_Event(s.TelemetryEvent.SurveyStatCollectionEventActivity.FromJson.Failed,{ErrorMessage:"Json parsing failed. "+e.toString()});return r}return r.deserialize(n)?r:new t};t.toJson=function(e){if(!e){o.FloodgateEngine.getTelemetryLogger().log_Event(s.TelemetryEvent.SurveyStatCollectionEventActivity.ToJson.Failed,{ErrorMessage:"Input json is null or empty."});e=new t}return JSON.stringify(e)};t.prototype.accumulate=function(e){if(e){var t=e.getStats();for(var n in t)if(t.hasOwnProperty(n)){var r=this.getBySurveyId(n);if(!r){(r=new l).Counts=[];this.addStats(n,r)}r.ExpirationTimeUtc=t[n].ExpirationTimeUtc;if(r.Counts.length<t[n].Counts.length){var i=r.Counts.slice();r.Counts=i}for(var s=0;s<t[n].Counts.length;s++){r.Counts[s]||(r.Counts[s]=0);r.Counts[s]+=t[n].Counts[s]}}}};t.prototype.deserialize=function(e){var t=e.Surveys,n=new Date;for(var r in t)if(t.hasOwnProperty(r)){var i=new l;i.deserialize(t[r])&&i.ExpirationTimeUtc>n&&this.addStats(r,i)}return this.validate()};t.prototype.validate=function(){return a.isObject(this.getStats())};return t})(u.SurveyStatCollection);n.SurveyStatCollectionEventActivity=f;var l=(function(){function e(){}e.prototype.deserialize=function(e){this.ExpirationTimeUtc=e.ExpirationTimeUtc;this.Counts=e.Counts;return this.validate()};e.prototype.validate=function(){if(!this.Counts)return!1;for(var e=0;e<this.Counts.length;e++){var t=this.Counts[e];if(!a.isNumber(t))return!1;t<0&&(this.Counts[e]=0)}if(!a.isUtcDatetimeString(this.ExpirationTimeUtc))return!1;this.ExpirationTimeUtc=a.stringToDate(this.ExpirationTimeUtc);return!0};return e})();n.SurveyEventActivityStats=l},{"./Constants":17,"./FloodgateEngine":18,"./SurveyStatCollection":33,"./Utils":41}],36:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=e("../Api/ISurvey"),o=e("../Api/ISurveyComponent"),u=e("../SurveyComponents/CommentComponent"),a=e("../SurveyComponents/MultipleChoiceComponent"),f=e("../SurveyComponents/PromptComponent"),l=e("../SurveyComponents/RatingComponent"),c=e("../Utils"),h=e("./Survey"),p=e("./SurveyDataSource"),d=(function(e){i(t,e);function t(t){var n=e.call(this)||this;if(c.isNullOrUndefined(t))throw new Error("data must not be null");n.surveyInfo=new p(t.baseData);n.prompt=new f(t.promptData);n.question=t.commentData?new u(t.commentData):null;n.rating=t.ratingData?new l(t.ratingData):null;n.multipleChoice=t.multipleChoiceData?new a(t.multipleChoiceData):null;return n}t.make=function(e){try{return new t(e)}catch(e){return null}};t.makeFps=function(e,n,r){if(c.isNullOrUndefined(e)||c.isNullOrUndefined(n)||c.isNullOrUndefined(r))return null;var i=[],s=[],o=r.content;if(c.isNullOrUndefined(o)||c.isNullOrUndefined(o.prompt)||c.isNullOrUndefined(o.rating)&&c.isNullOrUndefined(o.multipleChoice)&&c.isNullOrUndefined(o.comment))return null;var h=new t.FpsSurveyData;h.baseData=e;h.promptData=new f.PromptComponentData;h.promptData.title=n.getCustomString(o.prompt.title);h.promptData.question=n.getCustomString(o.prompt.question);h.promptData.yesButtonLabel=n.getCustomString(o.prompt.yesLabel);h.promptData.noButtonLabel=n.getCustomString(o.prompt.noLabel);if(c.isNullOrUndefined(h.promptData.title)||c.isNullOrUndefined(h.promptData.question)||c.isNullOrUndefined(h.promptData.yesButtonLabel)||c.isNullOrUndefined(h.promptData.noButtonLabel))return null;if(o.rating){h.ratingData=new l.RatingComponentData;h.ratingData.question=n.getCustomString(o.rating.question);h.ratingData.isZeroBased=o.rating.isZeroBased;for(var p=0,d=o.rating.ratingValuesAscending;p<d.length;p++){var v=d[p],m=n.getCustomString(v);if(c.isNullOrUndefined(m))return null;i.push(m)}h.ratingData.ratingValuesAscending=i;if(c.isNullOrUndefined(h.ratingData.question)||c.isNullOrUndefined(h.ratingData.ratingValuesAscending))return null}if(o.multipleChoice){h.multipleChoiceData=new a.MultipleChoiceComponentData;h.multipleChoiceData.question=n.getCustomString(o.multipleChoice.question);h.multipleChoiceData.minNumberOfSelectedOptions=o.multipleChoice.minNumberOfSelectedOptions;h.multipleChoiceData.maxNumberOfSelectedOptions=o.multipleChoice.maxNumberOfSelectedOptions;for(var g=0,y=o.multipleChoice.availableOptions;g<y.length;g++){v=y[g],m=n.getCustomString(v);if(c.isNullOrUndefined(m))return null;s.push(m)}h.multipleChoiceData.availableOptions=s;if(c.isNullOrUndefined(h.multipleChoiceData.question)||c.isNullOrUndefined(h.multipleChoiceData.availableOptions))return null}if(o.comment){h.commentData=new u.CommentComponentData;h.commentData.question=n.getCustomString(o.comment.question);if(c.isNullOrUndefined(h.commentData.question))return null}return this.make(h)};t.prototype.getType=function(){return s.Type.Fps};t.prototype.getSurveyInfo=function(){return this.surveyInfo};t.prototype.getCommentComponent=function(){return this.question};t.prototype.getPromptComponent=function(){return this.prompt};t.prototype.getRatingComponent=function(){return this.rating};t.prototype.getMultipleChoiceComponent=function(){return this.multipleChoice};t.prototype.getComponent=function(e){switch(e){case o.Type.Comment:return this.getCommentComponent();case o.Type.Prompt:return this.getPromptComponent();case o.Type.Rating:return this.getRatingComponent();case o.Type.MultipleChoice:return this.getMultipleChoiceComponent();default:return null}};t.prototype.getDomElements=function(e){if(c.isNullOrUndefined(e))throw new Error("Document must not be null");var t=e.createElement(s.DOM_FPS_TAGNAME);this.getSurveyInfo().getDomElements(e).forEach(function(e){c.isNullOrUndefined(e)||t.appendChild(e)});this.getCommentComponent().getDomElements(e).forEach(function(e){c.isNullOrUndefined(e)||t.appendChild(e)});this.getRatingComponent()&&this.getRatingComponent().getDomElements(e).forEach(function(e){c.isNullOrUndefined(e)||t.appendChild(e)});this.getMultipleChoiceComponent()&&this.getMultipleChoiceComponent().getDomElements(e).forEach(function(e){c.isNullOrUndefined(e)||t.appendChild(e)});return[t]};t.prototype.getJsonElements=function(){var e={};(e=c.overrideValues(this.getSurveyInfo().getJsonElements(),e))[o.JSON_APPLICATION_KEYNAME]={};e[o.JSON_APPLICATION_KEYNAME][o.JSON_EXTENDEDMANIFESTDATA_KEYNAME]=JSON.stringify({surveySpecificData:this.makeResponseString()});return e};t.prototype.makeResponseString=function(){var e={};this.question&&(e[o.JSON_COMMENT_KEYNAME]=[this.getCommentComponent().getSubmittedText()]);this.multipleChoice&&(e[o.JSON_MULTIPLECHOICE_KEYNAME]=[this.getMultipleChoiceComponent().getOptionSelectedStates()]);this.rating&&(e[o.JSON_RATING_KEYNAME]=[{numberOfOptions:this.getRatingComponent().getRatingValuesAscending().length,selectedRating:this.getRatingComponent().getSelectedRatingIndex()}]);return JSON.stringify(e)};return t})(h.Survey);(function(e){var t=function(){};e.FpsSurveyData=t})(d||(d={}));t.exports=d},{"../Api/ISurvey":11,"../Api/ISurveyComponent":12,"../SurveyComponents/CommentComponent":28,"../SurveyComponents/MultipleChoiceComponent":29,"../SurveyComponents/PromptComponent":30,"../SurveyComponents/RatingComponent":31,"../Utils":41,"./Survey":39,"./SurveyDataSource":40}],37:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=e("../Api/ISurvey"),o=e("../Api/ISurveyComponent"),u=e("../SurveyComponents/CommentComponent"),a=e("../SurveyComponents/PromptComponent"),f=e("../SurveyComponents/RatingComponent"),l=e("../Utils"),c=e("./Survey"),h=e("./SurveyDataSource"),p=(function(e){i(t,e);function t(t){var n=e.call(this)||this;if(l.isNullOrUndefined(t))throw new Error("data must not be null");n.surveyInfo=new h(t.baseData);n.prompt=new a(t.promptData);n.question=new u(t.commentData);n.rating=new f(t.ratingData);return n}t.make=function(e){try{return new t(e)}catch(e){return null}};t.makeNlqs=function(e,n,r){if(l.isNullOrUndefined(e)||l.isNullOrUndefined(n)||l.isNullOrUndefined(r))return null;var i=[],s=r.content;if(l.isNullOrUndefined(s)||l.isNullOrUndefined(s.comment)||l.isNullOrUndefined(s.prompt)||l.isNullOrUndefined(s.rating))return null;var o=new t.NlqsSurveyData;o.baseData=e;o.promptData=new a.PromptComponentData;o.ratingData=new f.RatingComponentData;o.commentData=new u.CommentComponentData;o.promptData.title=n.getCustomString(s.prompt.title);o.promptData.question=n.getCustomString(s.prompt.question);o.promptData.yesButtonLabel=n.getCustomString(s.prompt.yesLabel);o.promptData.noButtonLabel=n.getCustomString(s.prompt.noLabel);o.ratingData.question=n.getCustomString(s.rating.question);o.ratingData.isZeroBased=s.rating.isZeroBased;o.commentData.question=n.getCustomString(s.comment.question);for(var c=0,h=s.rating.ratingValuesAscending;c<h.length;c++){var p=h[c],d=n.getCustomString(p);if(l.isNullOrUndefined(d))return null;i.push(d)}o.ratingData.ratingValuesAscending=i;return l.isNullOrUndefined(o.ratingData.question)||l.isNullOrUndefined(o.commentData.question)||l.isNullOrUndefined(o.promptData.title)||l.isNullOrUndefined(o.promptData.question)||l.isNullOrUndefined(o.promptData.yesButtonLabel)||l.isNullOrUndefined(o.promptData.noButtonLabel)||l.isNullOrUndefined(o.ratingData.ratingValuesAscending)?null:this.make(o)};t.prototype.getType=function(){return s.Type.Nlqs};t.prototype.getSurveyInfo=function(){return this.surveyInfo};t.prototype.getCommentComponent=function(){return this.question};t.prototype.getPromptComponent=function(){return this.prompt};t.prototype.getRatingComponent=function(){return this.rating};t.prototype.getComponent=function(e){switch(e){case o.Type.Comment:return this.getCommentComponent();case o.Type.Prompt:return this.getPromptComponent();case o.Type.Rating:return this.getRatingComponent();default:return null}};t.prototype.getDomElements=function(e){if(l.isNullOrUndefined(e))throw new Error("Document must not be null");var t=e.createElement(s.DOM_NLQS_TAGNAME);this.getSurveyInfo().getDomElements(e).forEach(function(e){l.isNullOrUndefined(e)||t.appendChild(e)});this.getCommentComponent().getDomElements(e).forEach(function(e){l.isNullOrUndefined(e)||t.appendChild(e)});this.getRatingComponent().getDomElements(e).forEach(function(e){l.isNullOrUndefined(e)||t.appendChild(e)});return[t]};t.prototype.getJsonElements=function(){var e={};e=l.overrideValues(this.getSurveyInfo().getJsonElements(),e);e=l.overrideValues(this.getCommentComponent().getJsonElements(),e);return e=l.overrideValues(this.getRatingComponent().getJsonElements(),e)};return t})(c.Survey);(function(e){var t=function(){};e.NlqsSurveyData=t})(p||(p={}));t.exports=p},{"../Api/ISurvey":11,"../Api/ISurveyComponent":12,"../SurveyComponents/CommentComponent":28,"../SurveyComponents/PromptComponent":30,"../SurveyComponents/RatingComponent":31,"../Utils":41,"./Survey":39,"./SurveyDataSource":40}],38:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=e("../Api/IFloodgateStringProvider"),o=e("../Api/ISurvey"),u=e("../Api/ISurveyComponent"),a=e("../SurveyComponents/CommentComponent"),f=e("../SurveyComponents/PromptComponent"),l=e("../SurveyComponents/RatingComponent"),c=e("../Utils"),h=e("./Survey"),p=e("./SurveyDataSource"),d=(function(e){i(t,e);function t(t){var n=e.call(this)||this;if(!t)throw new Error("data must not be null");n.surveyInfo=new p(t.baseData);n.prompt=new f(t.promptData);n.question=new a(t.commentData);n.rating=new l(t.ratingData);return n}t.make=function(e){try{return new t(e)}catch(e){return null}};t.makeCustom=function(e,n,r){if(c.isNullOrUndefined(e)||c.isNullOrUndefined(n)||c.isNullOrUndefined(r))return null;var i=[],s=r.content;if(c.isNullOrUndefined(s)||c.isNullOrUndefined(s.comment)||c.isNullOrUndefined(s.prompt)||c.isNullOrUndefined(s.rating))return null;var o=new t.NpsSurveyData;o.baseData=e;o.promptData=new f.PromptComponentData;o.ratingData=new l.RatingComponentData;o.commentData=new a.CommentComponentData;o.promptData.title=n.getCustomString(s.prompt.title);o.promptData.question=n.getCustomString(s.prompt.question);o.promptData.yesButtonLabel=n.getCustomString(s.prompt.yesLabel);o.promptData.noButtonLabel=n.getCustomString(s.prompt.noLabel);o.ratingData.question=n.getCustomString(s.rating.question);o.ratingData.isZeroBased=s.rating.isZeroBased;o.commentData.question=n.getCustomString(s.comment.question);for(var u=0,h=s.rating.ratingValuesAscending;u<h.length;u++){var p=h[u],d=n.getCustomString(p);if(c.isNullOrUndefined(d))return null;i.push(d)}o.ratingData.ratingValuesAscending=i;return c.isNullOrUndefined(o.ratingData.question)||c.isNullOrUndefined(o.commentData.question)||c.isNullOrUndefined(o.promptData.title)||c.isNullOrUndefined(o.promptData.question)||c.isNullOrUndefined(o.promptData.yesButtonLabel)||c.isNullOrUndefined(o.promptData.noButtonLabel)||c.isNullOrUndefined(o.ratingData.ratingValuesAscending)?null:this.make(o)};t.make5Point=function(e,n){if(!e||!n)return null;var r=new t.NpsSurveyData;r.baseData=e;r.ratingData=new l.RatingComponentData;r.ratingData.isZeroBased=!1;r.commentData=new a.CommentComponentData;r.promptData=new f.PromptComponentData;r.ratingData.question=n.loadStringResource(s.StringType.NpsRatingQuestion);r.commentData.question=n.loadStringResource(s.StringType.NpsCommentQuestion);r.promptData.title=n.loadStringResource(s.StringType.NpsPromptTitle);r.promptData.question=n.loadStringResource(s.StringType.NpsPromptQuestion);r.promptData.yesButtonLabel=n.loadStringResource(s.StringType.NpsPromptYesLabel);r.promptData.noButtonLabel=n.loadStringResource(s.StringType.NpsPromptNotNowLabel);var i=new Array(5);i[0]=n.loadStringResource(s.StringType.Nps5RatingValue1);i[1]=n.loadStringResource(s.StringType.Nps5RatingValue2);i[2]=n.loadStringResource(s.StringType.Nps5RatingValue3);i[3]=n.loadStringResource(s.StringType.Nps5RatingValue4);i[4]=n.loadStringResource(s.StringType.Nps5RatingValue5);if(!(r.ratingData.question&&r.commentData.question&&r.promptData.title&&r.promptData.question&&r.promptData.yesButtonLabel&&r.promptData.noButtonLabel&&i[0]&&i[1]&&i[2]&&i[3]&&i[4]))return null;r.ratingData.ratingValuesAscending=i;return this.make(r)};t.make11Point=function(e,n){if(!e||!n)return null;var r=new t.NpsSurveyData;r.baseData=e;r.ratingData=new l.RatingComponentData;r.ratingData.isZeroBased=!0;r.commentData=new a.CommentComponentData;r.promptData=new f.PromptComponentData;r.ratingData.question=n.loadStringResource(s.StringType.NpsRatingQuestion);r.commentData.question=n.loadStringResource(s.StringType.NpsCommentQuestion);r.promptData.title=n.loadStringResource(s.StringType.NpsPromptTitle);r.promptData.question=n.loadStringResource(s.StringType.NpsPromptQuestion);r.promptData.yesButtonLabel=n.loadStringResource(s.StringType.NpsPromptYesLabel);r.promptData.noButtonLabel=n.loadStringResource(s.StringType.NpsPromptNotNowLabel);var i=new Array(11);i[0]=n.loadStringResource(s.StringType.Nps11RatingValue0);i[1]=n.loadStringResource(s.StringType.Nps11RatingValue1);i[2]=n.loadStringResource(s.StringType.Nps11RatingValue2);i[3]=n.loadStringResource(s.StringType.Nps11RatingValue3);i[4]=n.loadStringResource(s.StringType.Nps11RatingValue4);i[5]=n.loadStringResource(s.StringType.Nps11RatingValue5);i[6]=n.loadStringResource(s.StringType.Nps11RatingValue6);i[7]=n.loadStringResource(s.StringType.Nps11RatingValue7);i[8]=n.loadStringResource(s.StringType.Nps11RatingValue8);i[9]=n.loadStringResource(s.StringType.Nps11RatingValue9);i[10]=n.loadStringResource(s.StringType.Nps11RatingValue10);if(!(r.ratingData.question&&r.commentData.question&&r.promptData.title&&r.promptData.question&&r.promptData.yesButtonLabel&&r.promptData.noButtonLabel&&i[0]&&i[1]&&i[2]&&i[3]&&i[4]&&i[5]&&i[6]&&i[7]&&i[8]&&i[9]&&i[10]))return null;r.ratingData.ratingValuesAscending=i;return this.make(r)};t.prototype.getType=function(){return o.Type.Nps};t.prototype.getSurveyInfo=function(){return this.surveyInfo};t.prototype.getCommentComponent=function(){return this.question};t.prototype.getPromptComponent=function(){return this.prompt};t.prototype.getRatingComponent=function(){return this.rating};t.prototype.getComponent=function(e){switch(e){case u.Type.Comment:return this.getCommentComponent();case u.Type.Prompt:return this.getPromptComponent();case u.Type.Rating:return this.getRatingComponent();default:return null}};t.prototype.getDomElements=function(e){if(!e)throw new Error("Document must not be null");var t=e.createElement(o.DOM_NPS_TAGNAME);this.getSurveyInfo().getDomElements(e).forEach(function(e){e&&t.appendChild(e)});this.getCommentComponent().getDomElements(e).forEach(function(e){e&&t.appendChild(e)});this.getRatingComponent().getDomElements(e).forEach(function(e){e&&t.appendChild(e)});return[t]};t.prototype.getJsonElements=function(){var e={};e=c.overrideValues(this.getSurveyInfo().getJsonElements(),e);e=c.overrideValues(this.getCommentComponent().getJsonElements(),e);return e=c.overrideValues(this.getRatingComponent().getJsonElements(),e)};return t})(h.Survey);(function(e){var t=function(){};e.NpsSurveyData=t})(d||(d={}));t.exports=d},{"../Api/IFloodgateStringProvider":9,"../Api/ISurvey":11,"../Api/ISurveyComponent":12,"../SurveyComponents/CommentComponent":28,"../SurveyComponents/PromptComponent":30,"../SurveyComponents/RatingComponent":31,"../Utils":41,"./Survey":39,"./SurveyDataSource":40}],39:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../Api/ISurvey"),i=e("../FloodgateEngine"),s=(function(){function e(){}e.prototype.getCampaignId=function(){return this.getSurveyInfo().getBackEndId()};e.prototype.getLauncherType=function(){return this.getSurveyInfo().getLauncherType()};e.prototype.submit=function(){var e=r.Type[this.getType()],t=i.FloodgateEngine.getTransportFactory().makeTransporter(e);t.setManifestValues(this.getJsonElements());t.submit()};return e})();n.Survey=s},{"../Api/ISurvey":11,"../FloodgateEngine":18}],40:[function(e,t,n){"use strict";var r=e("../GovernedChannel"),i=e("../ISurveyInfo"),s=e("../Utils"),o=(function(){function e(e){if(s.isNullOrUndefined(e))throw new Error("data must not be null");if(s.isNullOrUndefined(e.id)||""===e.id)throw new Error("data.id must not be null or empty");s.isNullOrUndefined(e.governedChannelType)&&(e.governedChannelType=r.GovernedChannelType.getDefault());if(s.isNullOrUndefined(e.expirationTimeUtc)||""===e.expirationTimeUtc)throw new Error("data.expirationTimeUtc must not be null or empty");if(s.isNullOrUndefined(e.activationEvent))throw new Error("data.activationEvent must not be null");(s.isNullOrUndefined(e.backEndIdentifier)||""===e.backEndIdentifier)&&(e.backEndIdentifier=e.id);this.data=e}e.prototype.getId=function(){return this.data.id};e.prototype.getBackEndId=function(){return this.data.backEndIdentifier};e.prototype.getGovernedChannelType=function(){return this.data.governedChannelType};e.prototype.getRawStartTimeUtc=function(){return this.data.startTimeUtc};e.prototype.getStartTimeUtc=function(){if(s.isNullOrUndefined(this.data.startTimeUtc))return s.getDistantPast();var e=new Date(this.data.startTimeUtc);return s.isDate(e)?e:s.getDistantFuture()};e.prototype.getExpirationTimeUtc=function(){if(s.isNullOrUndefined(this.data.expirationTimeUtc))return s.getDistantPast();var e=new Date(this.data.expirationTimeUtc);return s.isDate(e)?e:s.getDistantPast()};e.prototype.getRawExpirationTimeUtc=function(){return this.data.expirationTimeUtc};e.prototype.isActiveForDate=function(e){return!s.isNullOrUndefined(e)&&(e>=this.getStartTimeUtc()&&e<=this.getExpirationTimeUtc())};e.prototype.getActivationEvent=function(){return this.data.activationEvent};e.prototype.getPreferredLaunchType=function(){return this.data.preferredLaunchType};e.prototype.isAdditionalDataRequested=function(e){if(s.isNullOrUndefined(this.data.additionalDataRequested))return!1;for(var t=0,n=this.data.additionalDataRequested;t<n.length;t++){if(n[t]===e)return!0}return!1};e.prototype.getLauncherType=function(){return this.data.launcherType};e.prototype.getDomElements=function(e){if(!e)throw new Error("Document must not be null");var t=e.createElement(i.DOM_TYPE_TAGNAME);t.appendChild(e.createTextNode(i.DOM_TYPE_VALUE));var n=e.createElement(i.DOM_ID_TAGNAME);n.appendChild(e.createTextNode(this.getBackEndId()));return[t,n]};e.prototype.getJsonElements=function(){var e={};e[i.JSON_ID_KEYNAME]=this.getBackEndId();var t={};t[i.JSON_SURVEY_KEYNAME]=e;return t};return e})();(function(e){var t=function(){this.preferredLaunchType=i.LaunchType.Default};e.SurveyDataSourceData=t})(o||(o={}));t.exports=o},{"../GovernedChannel":20,"../ISurveyInfo":24,"../Utils":41}],41:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.timeAdd=function(e,t,n){switch(t.toLowerCase()){case"h":case"hour":return new Date(e.getTime()+36e5*n);case"m":case"minute":return new Date(e.getTime()+6e4*n);case"s":case"second":return new Date(e.getTime()+1e3*n);default:throw new Error("Invalid interval value of "+t)}};function r(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())}n.isDate=r;n.isEnumValue=function(e,t){return e in t};n.isNumber=function(e){return null!==e&&!isNaN(e)&&isFinite(e)};function i(e){return null==e}n.isNullOrUndefined=i;n.isObject=function(e){return null!=e&&"object"==typeof e};function s(e){return"string"==typeof e}n.isString=s;n.isBoolean=function(e){return"boolean"==typeof e};n.getDistantPast=function(){return new Date(-116444736e5)};n.getDistantFuture=function(){return new Date(640922112e5)};n.MAX_DATE_MILLISECONDS=864e13;n.MIN_DATE_MILLISECONDS=-864e13;n.addSecondsWithoutOverflow=function(e,t){if(!e)return null;if(t<0)return o(e,-1*t);var r=e.getTime()+1e3*t;return r<n.MAX_DATE_MILLISECONDS?new Date(r):new Date(n.MAX_DATE_MILLISECONDS)};function o(e,t){if(!e)return null;if(t<0){t=-t;return this.addSecondsWithoutOverflow(e,t)}var r=e.getTime()-1e3*t;return r>n.MIN_DATE_MILLISECONDS?new Date(r):new Date(n.MIN_DATE_MILLISECONDS)}n.subtractSecondsWithoutOverflow=o;var u="^((?:[a-zA-Z]{2,3}(?:-[a-zA-Z]{3}){0,3})|(?:[a-zA-Z]{4,8}))(?:-([a-zA-Z]{4}))?(?:-([a-zA-Z]{2}|[0-9]{3}))?(-.*)?$";n.isValidLanguageSubTag=function(e){if(!e)return!1;var t=a(e);return!!t&&t===e};function a(e){if(!e)return null;var t=e.match(u);return!t||t.length<1||!i(t[4])?null:t[0]}n.extractLanguageSubtag=a;n.guid=function(){return(f()+f()+"-"+f()+"-4"+f().substr(0,3)+"-"+f()+"-"+f()+f()+f()).toLowerCase()};function f(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}n.makeArrayFromObjectValuesSortedByKeyString=function(e){var t=Object.keys(e);t.sort();var n=[];for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];n.push(e[i])}return n};n.stringToDate=function(e){if(!s(e))return null;var t=e?new Date(e):null;return r(t)?t:null};n.overrideValues=function(e,t){if(!t)return t;var n=t;if(e)for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n};n.isUtcDatetimeString=function(e){return!!s(e)&&/^(\d{4}\-\d\d\-\d\dT\d\d:\d\d:\d\d(\.\d\d\d)?Z)$/.test(e)};n.dateToShortUtcString=function(e){if(!r(e))return null;function t(e){return e<10?"0"+e:e.toString()}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"Z"}},{}],42:[function(t,i,o){(function(e,u){a=function(){"use strict";function n(e){return"function"==typeof e}var r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=0,s=void 0,o=void 0,a=function(e,t){v[i]=e;v[i+1]=t;2===(i+=2)&&(o?o(m):g())},f="undefined"!=typeof window?window:void 0,l=f||{},c=l.MutationObserver||l.WebKitMutationObserver,h="undefined"==typeof self&&void 0!==e&&"[object process]"==={}.toString.call(e),p="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var e=setTimeout;return function(){return e(m,1)}}var v=new Array(1e3);function m(){for(var e=0;e<i;e+=2){(0,v[e])(v[e+1]);v[e]=void 0;v[e+1]=void 0}i=0}var g=void 0;g=h?function(){return e.nextTick(m)}:c?(function(){var e=0,t=new c(m),n=document.createTextNode("");t.observe(n,{characterData:!0});return function(){n.data=e=++e%2}})():p?(function(){var e=new MessageChannel;e.port1.onmessage=m;return function(){return e.port2.postMessage(0)}})():void 0===f&&"function"==typeof t?(function(){try{var e=Function("return this")().require("vertx");return void 0!==(s=e.runOnLoop||e.runOnContext)?function(){s(m)}:d()}catch(e){return d()}})():d();function y(e,t){var n=this,r=new this.constructor(E);void 0===r[w]&&B(r);var i=n._state;if(i){var s=arguments[i-1];a(function(){return P(i,r,s,n._result)})}else _(n,r,e,t);return r}function b(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(E);L(t,e);return t}var w=Math.random().toString(36).substring(2);function E(){}var S=void 0,x=1,T=2,N={error:null};function C(e){try{return e.then}catch(e){N.error=e;return N}}function k(e,t,r){if(t.constructor===e.constructor&&r===y&&t.constructor.resolve===b)(function(e,t){t._state===x?O(e,t._result):t._state===T?M(e,t._result):_(t,void 0,function(t){return L(e,t)},function(t){return M(e,t)})})(e,t);else if(r===N){M(e,N.error);N.error=null}else void 0===r?O(e,t):n(r)?(function(e,t,n){a(function(e){var r=!1,i=(function(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}})(n,t,function(n){if(!r){r=!0;t!==n?L(e,n):O(e,n)}},function(t){if(!r){r=!0;M(e,t)}},e._label);if(!r&&i){r=!0;M(e,i)}},e)})(e,t,r):O(e,t)}function L(e,t){e===t?M(e,new TypeError("You cannot resolve a promise with itself")):(r=typeof(n=t),null===n||"object"!==r&&"function"!==r?O(e,t):k(e,t,C(t)));var n,r}function A(e){e._onerror&&e._onerror(e._result);D(e)}function O(e,t){if(e._state===S){e._result=t;e._state=x;0!==e._subscribers.length&&a(D,e)}}function M(e,t){if(e._state===S){e._state=T;e._result=t;a(A,e)}}function _(e,t,n,r){var i=e._subscribers,s=i.length;e._onerror=null;i[s]=t;i[s+x]=n;i[s+T]=r;0===s&&e._state&&a(D,e)}function D(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,i=void 0,s=e._result,o=0;o<t.length;o+=3){r=t[o];i=t[o+n];r?P(n,r,i,s):i(s)}e._subscribers.length=0}}function P(e,t,r,i){var s=n(r),o=void 0,u=void 0,a=void 0,f=void 0;if(s){if((o=(function(e,t){try{return e(t)}catch(e){N.error=e;return N}})(r,i))===N){f=!0;u=o.error;o.error=null}else a=!0;if(t===o){M(t,new TypeError("A promises callback cannot return that same promise."));return}}else{o=i;a=!0}t._state!==S||(s&&a?L(t,o):f?M(t,u):e===x?O(t,o):e===T&&M(t,o))}var H=0;function B(e){e[w]=H++;e._state=void 0;e._result=void 0;e._subscribers=[]}var j=(function(){function e(e,t){this._instanceConstructor=e;this.promise=new e(E);this.promise[w]||B(this.promise);if(r(t)){this.length=t.length;this._remaining=t.length;this._result=new Array(this.length);if(0===this.length)O(this.promise,this._result);else{this.length=this.length||0;this._enumerate(t);0===this._remaining&&O(this.promise,this._result)}}else M(this.promise,new Error("Array Methods must be provided an Array"))}e.prototype._enumerate=function(e){for(var t=0;this._state===S&&t<e.length;t++)this._eachEntry(e[t],t)};e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===b){var i=C(e);if(i===y&&e._state!==S)this._settledAt(e._state,t,e._result);else if("function"!=typeof i){this._remaining--;this._result[t]=e}else if(n===F){var s=new n(E);k(s,e,i);this._willSettleAt(s,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)};e.prototype._settledAt=function(e,t,n){var r=this.promise;if(r._state===S){this._remaining--;e===T?M(r,n):this._result[t]=n}0===this._remaining&&O(r,this._result)};e.prototype._willSettleAt=function(e,t){var n=this;_(e,void 0,function(e){return n._settledAt(x,t,e)},function(e){return n._settledAt(T,t,e)})};return e})(),F=(function(){function e(t){this[w]=H++;this._result=this._state=void 0;this._subscribers=[];if(E!==t){"function"!=typeof t&&(function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")})();this instanceof e?(function(e,t){try{t(function(t){L(e,t)},function(t){M(e,t)})}catch(t){M(e,t)}})(this,t):(function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")})()}}e.prototype.catch=function(e){return this.then(null,e)};e.prototype.finally=function(e){var t=this.constructor;return n(e)?this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})}):this.then(e,e)};return e})();F.prototype.then=y;F.all=function(e){return new j(this,e).promise};F.race=function(e){var t=this;return r(e)?new t(function(n,r){for(var i=e.length,s=0;s<i;s++)t.resolve(e[s]).then(n,r)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})};F.resolve=b;F.reject=function(e){var t=new this(E);M(t,e);return t};F._setScheduler=function(e){o=e};F._setAsap=function(e){a=e};F._asap=a;F.polyfill=function(){var e=void 0;if(void 0!==u)e=u;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=F};F.Promise=F;return F},"object"==typeof o&&void 0!==i?i.exports=a():void 0!==(s="function"==typeof(r=a)?r.call(o,n,o,i):r)&&(i.exports=s);var a}).call(this,t("_process"),void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:43}],43:[function(e,t,n){var r,i,s=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}(function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{i="function"==typeof clearTimeout?clearTimeout:u}catch(e){i=u}})();function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout){r=setTimeout;return setTimeout(e,0)}try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}var f,l=[],c=!1,h=-1;function p(){if(c&&f){c=!1;f.length?l=f.concat(l):h=-1;l.length&&d()}}function d(){if(!c){var e=a(p);c=!0;for(var t=l.length;t;){f=l;l=[];for(;++h<t;)f&&f[h].run();h=-1;t=l.length}f=null;c=!1;(function(e){if(i===clearTimeout)return clearTimeout(e);if((i===u||!i)&&clearTimeout){i=clearTimeout;return clearTimeout(e)}try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}})(e)}}s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new v(e,t));1!==l.length||c||a(d)};function v(e,t){this.fun=e;this.array=t}v.prototype.run=function(){this.fun.apply(null,this.array)};s.title="browser";s.browser=!0;s.env={};s.argv=[];s.version="";s.versions={};function m(){}s.on=m;s.addListener=m;s.once=m;s.off=m;s.removeListener=m;s.removeAllListeners=m;s.emit=m;s.prependListener=m;s.prependOnceListener=m;s.listeners=function(e){return[]};s.binding=function(e){throw new Error("process.binding is not supported")};s.cwd=function(){return"/"};s.chdir=function(e){throw new Error("process.chdir is not supported")};s.umask=function(){return 0}},{}],44:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./UIStrings/UIStrings"),i=e("./Version"),s=e("./Configuration/Configuration"),o=e("./Window/Window"),u=e("./Logging/Logging"),a=e("./Theme"),f=e("es6-promise"),l="OfficeFeedbackSDK",c=!1;n.initialize=function(){return new f.Promise(function(e,t){if(c)e();else{if(!o.get().OfficeBrowserFeedback.initOptions){t("Window.OfficeBrowserFeedback.initOptions not set");return}o.get().OfficeBrowserFeedback.sdkVersion=i.default;s.get().setCommonInitOptions(o.get().OfficeBrowserFeedback.initOptions);var n=s.get().getCommonInitOptions();(function(e){var t=document.createElement("link");t.rel="stylesheet";t.type="text/css";t.href=e;var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)})(n.stylesUrl);var h=n.intlUrl+n.locale.toLowerCase()+"/"+n.intlFilename;(p=h,new f.Promise(function(e,t){var n=document.createElement("script");n.async=!0;n.readyState?n.onreadystatechange=function(){if("loaded"===n.readyState||"complete"===n.readyState){n.onreadystatechange=null;e()}}:n.onload=function(){e()};n.onerror=function(){t()};n.src=p;var r=window.origin;r&&"null"!==r&&(n.crossOrigin="anonymous");var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(n,i)})).then(function(){if(r.getUIStrings()){(function(e){u.initialize(e.environment,l,i.default,e.telemetryGroup?e.telemetryGroup.audienceGroup:void 0,e.appId.toString(),e.sessionId,e.build);a.initialize(e.primaryColour,e.secondaryColour)})(n);c=!0;e()}else t("UiStrings were not loaded from "+h)}).catch(function(e){t("Script load failed for "+h)})}var p})};n.reset=function(){c=!1};o.setSetUiStrings(function(e){r.setUIStrings(e)})},{"./Configuration/Configuration":47,"./Logging/Logging":60,"./Theme":66,"./UIStrings/UIStrings":71,"./Version":91,"./Window/Window":93,"es6-promise":42}],45:[function(e,t,n){"use strict";n.__esModule=!0;var r,i=e("./App_Common"),s=e("./UI/UI"),o=e("./Configuration/Configuration"),u=e("./Window/Window"),a=e("./FloodgateCore/AdaptiveSurveyLauncherFactory"),f=e("./FloodgateCore/TransporterFactory"),l=e("./FloodgateCore/UISurvey/CustomUISurvey"),c=e("./FloodgateCore/UISurvey/DummyUISurvey"),h=e("./FloodgateCore/FloodgateEnvironmentProvider"),p=e("./FloodgateCore/FloodgateStorageProvider"),d=e("./FloodgateCore/FloodgateStringProvider"),v=e("./FloodgateCore/FloodgateTelemetryLogger"),m=e("@ms-ofb/officefloodgatecore"),g=e("@ms-ofb/officefloodgatecore/dist/src/Campaign/CampaignDefinitionProvider"),y=e("@ms-ofb/officefloodgatecore/dist/src/Api/Api"),b=e("es6-promise"),w=!1,E=!1;function S(){return new b.Promise(function(e,t){p.default.isStorageAvailable()?w?e():i.initialize().then(function(){u.get().OfficeBrowserFeedback.floodgate=u.get().OfficeBrowserFeedback.floodgate||{};var n=u.get().OfficeBrowserFeedback.floodgate.initOptions;if(void 0!==(n=n||{}).campaignDefinitions){var r=g.FilterValidCampaignDefinitions(n.campaignDefinitions);if(r.error){t("floodgate.initOptions.campaignDefinitions error: "+r.error);return}(new p.default).write(y.IFloodgateStorageProvider.FileType.CampaignDefinitions,JSON.stringify(n.campaignDefinitions))}o.get().setFloodgateInitOptions(u.get().OfficeBrowserFeedback.floodgate.initOptions);m.FloodgateEngine.setTelemetryLogger(new v.default);w=!0;e()}).catch(function(e){t("Initialization failed: {"+e+"}")}):t("window.localStorage is not available.")})}n.initialize=S;function x(){return new b.Promise(function(e,t){try{(r=m.FloodgateEngine.make(o.get().getCommonInitOptions().build?o.get().getCommonInitOptions().build:"",new a.default,o.get().getFloodgateInitOptions().onSurveyActivatedCallback,new p.default,o.get().getFloodgateInitOptions().settingStorageCallback,new d.default,new h.default,new f.default)).start()}catch(e){t("Failed to start floodgate engine: "+e.toString());return}e()})}n.start=x;function T(){r&&r.stop()}n.stop=T;function N(){return r}n.getEngine=N;function C(e){return new b.Promise(function(t,n){if(E)n("Control already open");else{o.get().setFloodgateSurvey(e||new c.default);s.createSurvey(function(){E=!1});E=!0;t()}})}n.showSurvey=C;function k(e){return C(new l.default(e))}n.showCustomSurvey=k;n.reset=function(){i.reset();w=!1;E=!1};function L(){return y.IFloodgateSettingIdMap.RoamingSettingIdMap}n.getSettingIdMap=L;u.setFloodgateShowCustomSurvey(k);u.setFloodgateShowSurvey(C);u.setFloodgateGetEngine(N);u.setFloodgateInitialize(S);u.setFloodgateStart(x);u.setFloodgateStop(T);u.getSettingIdMap(L)},{"./App_Common":44,"./Configuration/Configuration":47,"./FloodgateCore/AdaptiveSurveyLauncherFactory":49,"./FloodgateCore/FloodgateEnvironmentProvider":50,"./FloodgateCore/FloodgateStorageProvider":51,"./FloodgateCore/FloodgateStringProvider":52,"./FloodgateCore/FloodgateTelemetryLogger":53,"./FloodgateCore/TransporterFactory":54,"./FloodgateCore/UISurvey/CustomUISurvey":55,"./FloodgateCore/UISurvey/DummyUISurvey":56,"./UI/UI":88,"./Window/Window":93,"@ms-ofb/officefloodgatecore":1,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5,"@ms-ofb/officefloodgatecore/dist/src/Campaign/CampaignDefinitionProvider":13,"es6-promise":42}],46:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./App_Common"),i=e("./Configuration/Configuration"),s=e("./Logging/Logging"),o=e("./UI/UI"),u=e("./Window/Window"),a=e("es6-promise"),f=!1;function l(){return new a.Promise(function(e,t){f?e():r.initialize().then(function(){if(u.get().OfficeBrowserFeedback.initOptions){i.get().setInAppFeedbackInitOptions(u.get().OfficeBrowserFeedback.initOptions);f=!0;e()}else t("Window.OfficeBrowserFeedback.initOptions not set")}).catch(function(e){t("Initialization failed: {"+e+"}")})})}n.initialize=l;var c=!1;function h(e){return new a.Promise(function(t,n){c?n("Control already open"):l().then(function(){i.get().setInAppFeedbackLaunchOptions(e);o.createBellyBandMulti(function(){c=!1});s.getLogger().logEvent(s.EventIds.InApp.UI.Picker.Shown.VALUE,{IsBugEnabled:i.get().getInAppFeedbackInitOptions().bugForm,IsIdeaEnabled:void 0!==i.get().getInAppFeedbackInitOptions().userVoice});c=!0;t()}).catch(function(e){n("Initialization failed: {"+e+"}")})})}n.multiFeedback=h;function p(e,t){return new a.Promise(function(n,r){if(c)r("Control already open");else{var u=i.validateFeedbackType(e);l().then(function(){i.get().setInAppFeedbackLaunchOptions(t);o.createBellyBandSingle(function(){c=!1},u);s.getLogger().logEvent(s.EventIds.InApp.UI.Form.Shown.VALUE,{FeedbackType:u});c=!0;n()}).catch(function(e){r("Initialization failed: {"+e+"}")})}})}n.singleFeedback=p;n.reset=function(){r.reset();f=!1;c=!1};u.setMultiFeedback(h);u.setSingleFeedback(p)},{"./App_Common":44,"./Configuration/Configuration":47,"./Logging/Logging":60,"./UI/UI":88,"./Window/Window":93,"es6-promise":42}],47:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../Utils"),i=e("./../Constants"),s=e("./../Localization"),o=(function(){function e(){}e.validateCategoryOptions=function(e){if(!e)return{show:!1};r.expectBoolean(e.show,"categories.show");if(e.customCategories){r.expectArray(e.customCategories,"categories.customCategories");for(var t=0,n=e.customCategories;t<n.length;t++){var i=n[t];r.expectString(i,"custom category '"+i+"'");if(i.length>20)throw"custom category '"+i+"' too long, max 20 characters."}}return e};e.prototype.getCommonInitOptions=function(){return this.commonInitOptions};e.prototype.getInAppFeedbackInitOptions=function(){return this.inAppFeedbackInitOptions};e.prototype.getInAppFeedbackLaunchOptions=function(){return this.inAppFeedbackLaunchOptions};e.prototype.getFloodgateInitOptions=function(){return this.floodgateInitOptions};e.prototype.getFloodgateSurvey=function(){return this.floodgateSurvey};e.prototype.setCommonInitOptions=function(e){r.expectObject(e,"passedInitOptions");var t={appId:e.appId,applicationGroup:e.applicationGroup||{},build:e.build,cid:e.cid,environment:e.environment,intlFilename:e.intlFilename,intlUrl:e.intlUrl,locale:e.locale,onError:e.onError,originalLocale:e.locale,primaryColour:e.primaryColour,secondaryColour:e.secondaryColour,sessionId:e.sessionId,stylesUrl:e.stylesUrl,telemetryGroup:e.telemetryGroup||{},userEmail:e.userEmail,userEmailConsentDefault:e.userEmailConsentDefault,webGroup:e.webGroup||{}};r.expectNumber(t.appId,"initOptions.appId");if(!(t.appId%1==0&&t.appId>0))throw"initOptions.appId is not a positive integer: "+t.appId;r.expectString(t.stylesUrl,"initOptions.stylesUrl");r.expectString(t.intlUrl,"initOptions.intlUrl");void 0!==t.intlFilename?r.expectString(t.intlFilename,"initOptions.intlFilename"):t.intlFilename="officebrowserfeedbackstrings.js";r.expectNumber(t.environment,"initOptions.environment");if(1!==t.environment&&0!==t.environment)throw"initOptions.environment has a bad value: "+t.environment;void 0!==t.userEmail&&r.expectString(t.userEmail,"initOptions.userEmail");void 0!==t.userEmailConsentDefault&&r.expectBoolean(t.userEmailConsentDefault,"initOptions.userEmailConsentDefault");void 0!==t.sessionId?r.expectString(t.sessionId,"initOptions.sessionId"):t.sessionId="00000000-0000-0000-0000-000000000000";t.telemetryGroup.processSessionId=t.sessionId;if(void 0!==t.cid){r.expectString(t.cid,"initOptions.cid");t.applicationGroup.extendedManifestData=JSON.stringify({cid:t.cid})}if(void 0!==t.build){r.expectString(t.build,"initOptions.build");new RegExp("^[0-9]{1,9}(\\.[0-9]{1,9})?(\\.[0-9]{1,9})?(\\.[0-9]{1,9})?$").test(t.build)||(t.build="0.0.0.0")}else t.build="0.0.0.0";t.telemetryGroup.officeBuild=t.build;var n=new RegExp("^#[0-9a-f]{3}([0-9a-f]{3})?$","i");void 0!==t.primaryColour&&(n.test(t.primaryColour)||(t.primaryColour=void 0));void 0!==t.secondaryColour&&(n.test(t.secondaryColour)||(t.secondaryColour=void 0));if(void 0!==t.locale){r.expectString(t.locale,"initOptions.locale");t.locale=s.validate(t.locale)}else t.locale="en";void 0===t.onError&&(t.onError=function(e){});this.commonInitOptions=t};e.prototype.setInAppFeedbackInitOptions=function(e){r.expectObject(e,"passedInitOptions");var t={bugForm:e.bugForm,onDismiss:e.onDismiss,screenshot:e.screenshot,userEmail:e.userEmail,userVoice:void 0!==e.userVoice?{url:e.userVoice.url}:void 0};void 0===t.onDismiss&&(t.onDismiss=function(e){});void 0!==t.bugForm?r.expectBoolean(t.bugForm,"initOptions.bugForm"):t.bugForm=!1;void 0!==t.userEmail&&r.expectString(t.userEmail,"initOptions.userEmail");void 0!==t.screenshot?r.expectBoolean(t.screenshot,"initOptions.screenshot"):t.screenshot=!0;if(void 0!==t.userVoice){r.expectObject(t.userVoice,"initOptions.userVoice");r.expectString(t.userVoice.url,"initOptions.userVoice.url")}this.inAppFeedbackInitOptions=t};e.prototype.setInAppFeedbackLaunchOptions=function(t){if(!this.commonInitOptions)throw"commonInitOptions not set";t||(t={});this.commonInitOptions.applicationGroup=r.overrideValues(t.applicationGroup,this.commonInitOptions.applicationGroup);this.commonInitOptions.telemetryGroup=r.overrideValues(t.telemetryGroup,this.commonInitOptions.telemetryGroup);this.commonInitOptions.webGroup=r.overrideValues(t.webGroup,this.commonInitOptions.webGroup);t.categories=e.validateCategoryOptions(t.categories);this.inAppFeedbackLaunchOptions=t};e.prototype.setFloodgateInitOptions=function(e){r.expectObject(e,"passedInitOptions");var t={autoDismiss:e.autoDismiss,campaignDefinitions:e.campaignDefinitions,onDismiss:e.onDismiss,onSurveyActivatedCallback:e.onSurveyActivatedCallback,settingStorageCallback:e.settingStorageCallback,uIStringGetter:e.uIStringGetter};void 0===t.autoDismiss&&(t.autoDismiss=i.AutoDismissValues.NoAutoDismiss);void 0===t.onDismiss&&(t.onDismiss=function(e,t){});if(void 0===t.onSurveyActivatedCallback){t.onSurveyActivatedCallback={onSurveyActivated:function(e){e.launch()}}}void 0===t.uIStringGetter&&(t.uIStringGetter=function(e){return e});this.floodgateInitOptions=t};e.prototype.setFloodgateSurvey=function(e){this.floodgateSurvey=e};return e})();n.Configuration=o;var u=new o;n.get=function(){return u};n.validateFeedbackType=function(e){r.expectString(e,"feedbackType");if(e===i.FeedbackType[i.FeedbackType.Smile])return i.FeedbackType.Smile;if(e===i.FeedbackType[i.FeedbackType.Frown])return i.FeedbackType.Frown;if(e===i.FeedbackType[i.FeedbackType.Bug])return i.FeedbackType.Bug;throw"feedbackType should be one of Smile, Frown or Bug"}},{"./../Constants":48,"./../Localization":58,"./../Utils":90}],48:[function(e,t,n){"use strict";n.__esModule=!0;var r=(function(){function e(){}e.AriaLabel="aria-label";e.Class="class";e.DataHtml2CanvasIgnore="data-html2canvas-ignore";e.Disabled="disabled";e.Fill="fill";e.For="for";e.Form="form";e.Height="height";e.HRef="href";e.Id="id";e.MaxLength="maxlength";e.Name="name";e.Placeholder="placeholder";e.Points="points";e.Rel="rel";e.Role="role";e.Source="src";e.Stroke="stroke";e.TabIndex="tabindex";e.Target="target";e.Transform="transform";e.Type="type";e.Value="value";e.ViewBox="viewBox";e.Width="width";e.xlinkHref="xlink:href";e.X="x";e.Y="y";return e})();n.AttributeName=r;var i=(function(){function e(){}e.BlankWindow="_blank";e.Button="button";e.Checkbox="checkbox";e.Checked="checked";e.False="false";e.Zero="0";e.Polite="polite";e.Radio="radio";e.Submit="submit";e.Text="text";e.TextAreaMaxLength="1000";e.True="true";e.Unchecked="unchecked";e.NoReferrer="noreferrer";return e})();n.AttributeValue=i;var s=(function(){function e(){}e.CLCID="CLCID";return e})();n.UrlParameters=s;var o=(function(){function e(){}e.CheckBox="obf-CheckBox";e.FontSubtitle="obf-FontSubtitle";e.FontText="obf-FontText";e.FontSubText="obf-FontSubText";e.FontSubSubText="obf-FontSubSubText";e.Hidden="obf-Hidden";e.Link="obf-Link";e.MarginLeft60px="obf-MarginLeft60px";e.NarrowLayout="obf-NarrowLayout";e.PrivacyStatementLinkDiv="obf-PrivacyStatementLinkDiv";e.Rtl="obf-Rtl";e.Spinner="obf-Spinner";e.SpinnerCircle="obf-SpinnerCircle";e.SubmitButton="obf-SubmitButton";e.TextInput="obf-TextInput";e.Visible="obf-Visible";e.Rating="obf-Rating";e.RatingGraphic="obf-RatingGraphic";e.RatingGraphicFilled="obf-RatingGraphic-Filled";e.ChoiceGroup="obf-ChoiceGroup";e.ChoiceGroupIcon="obf-ChoiceGroupIcon";e.OverallAnchor="obf-OverallAnchor";e.OverallAnchorActive="obf-OverallAnchorActive";e.OverallImage="obf-OverallImage";e.OverallText="obf-OverallText";e.SingleLayout="obf-SingleLayout";e.ShowRightBorder="obf-ShowRightBorder";e.SlideLeft="obf-slideLeft";e.TextAlignLeft="obf-TextAlignLeft";e.FormContainer="obf-FormContainer";e.FormQuestionMiddleText="obf-FormQuestionMiddleText";e.FormMiddleText="obf-FormMiddleText";e.FormCategoriesDropdown="obf-FormCategoriesDropdown";e.FormComment="obf-FormComment";e.FormRatingContainer="obf-FormRatingContainer";e.FormRatingLabel="obf-FormRatingLabel";e.FormRating="obf-FormRating";e.FormEmailInput="obf-FormEmailInput";e.FormBottomContainer="obf-FormBottomContainer";e.FormSubmitButtonContainer="obf-FormSubmitButtonContainer";e.FormScreenshotContainer="obf-FormScreenshotContainer";e.FormScreenshotLabel="obf-FormScreenshotLabel";e.FormScreenshotCheckbox="obf-FormScreenshotCheckbox";e.TFormEmailCheckbox="obf-TFormEmailCheckbox";e.TFormEmailLabel="obf-TFormEmailLabel ";e.EmailCheckBoxLabel="obf-EmailCheckBoxLabel";e.Toast="obf-Toast";return e})();n.Classes=o;var u=(function(){function e(){}e.ColumnSeparatorDiv="obf-ColumnSeparatorDiv";e.OverallAnchorsContainer="obf-OverallAnchorsContainer";e.OverallFrownAnchor="obf-OverallFrownAnchor";e.OverallFrownDiv="obf-OverallFrownDiv";e.OverallFrownImage="obf-OverallFrownImage";e.OverallFrownText="obf-OverallFrownText";e.OverallSmileAnchor="obf-OverallSmileAnchor";e.OverallSmileDiv="obf-OverallSmileDiv";e.OverallSmileImage="obf-OverallSmileImage";e.OverallSmileText="obf-OverallSmileText";e.OverallIdeaAnchor="obf-OverallIdeaAnchor";e.OverallIdeaDiv="obf-OverallIdeaDiv";e.OverallIdeaImage="obf-OverallIdeaImage";e.OverallIdeaText="obf-OverallIdeaText";e.OverallBugAnchor="obf-OverallBugAnchor";e.OverallBugDiv="obf-OverallBugDiv";e.OverallBugImage="obf-OverallBugImage";e.OverallBugText="obf-OverallBugText";e.QuestionLeftText="obf-QuestionLeftText";e.LeftFormContainer="obf-LeftFormContainer";e.MainContainer="obf-MainContainer";e.MainContentHolder="obf-MainContentHolder";e.MiddleFormContainer="obf-MiddleFormContainer";e.OverlayBackground="obf-OverlayBackground";e.PrivacyStatementLink="obf-PrivacyStatementLink";e.FirstTabbable="obf-FirstTabbable";e.LastTabbable="obf-LastTabbable";e.SingleFormContainer="obf-SingleFormContainer";e.SingleFormQuestionMiddleText="obf-SingleFormQuestionMiddleText";e.SingleFormCategoriesDropdown="obf-SingleFormCategoriesDropdown";e.SingleFormComment="obf-SingleFormComment";e.SingleFormEmailInput="obf-SingleFormEmailInput";e.SingleFormRating="obf-SingleFormRating";e.SingleFormScreenshotCheckbox="obf-SingleFormScreenshotCheckbox";e.SingleFormSubmitButton="obf-SingleFormSubmitButton";e.SingleFormSubmitButtonSpinner="obf-SingleFormSubmitButtonSpinner";e.BasicFormContainer="obf-BasicFormContainer";e.BasicFormQuestionMiddleText="obf-BasicFormQuestionMiddleText";e.BasicFormCategoriesDropdown="obf-BasicFormCategoriesDropdown";e.BasicFormComment="obf-BasicFormComment";e.BasicFormEmailInput="obf-BasicFormEmailInput";e.BasicFormRating="obf-BasicFormRating";e.BasicFormScreenshotCheckbox="obf-BasicFormScreenshotCheckbox";e.BasicFormSubmitButton="obf-BasicFormSubmitButton";e.BasicFormSubmitButtonSpinner="obf-BasicFormSubmitButtonSpinner";e.UserVoiceFormContainer="obf-UserVoiceFormContainer";e.UserVoiceFormGoButton="obf-UserVoiceFormGoButton";e.ToastContainer="obf-ToastContainer";e.ToastCancel="obf-ToastCancel";e.TPromptContainer="obf-TPromptContainer";e.TPromptTitle="obf-TPromptTitle";e.TPromptText="obf-TPromptText";e.TFormContainer="obf-TFormContainer";e.TFormTitle="obf-TFormTitle";e.TFormRating="obf-TFormRating";e.TFormComment="obf-TFormComment";e.TFormEmailTextBox="obf-TFormEmailTextBox";e.TFormEmailCheckBox="obf-TFormEmailCheckBox";e.TFormEmailLabel="obf-TFormEmailLabel";e.TFormSubmitButton="obf-TFormSubmitButton";e.TFormSubmitButtonSpinner="obf-TFormSubmitButtonSpinner";e.TFormSubmitButtonContainer="obf-TFormSubmitButtonContainer";return e})();n.IDs=u;var a=(function(){function e(){}e.Esc=27;e.Tab=9;return e})();n.Keys=a;(function(e){e[e.Smile=0]="Smile";e[e.Frown=1]="Frown";e[e.Idea=2]="Idea";e[e.Bug=3]="Bug"})(n.FeedbackType||(n.FeedbackType={}));(function(e){e[e.Production=0]="Production";e[e.Int=1]="Int"})(n.Environment||(n.Environment={}));(function(e){e[e.NoAutoDismiss=0]="NoAutoDismiss";e[e.SevenSeconds=1]="SevenSeconds";e[e.FourteenSeconds=2]="FourteenSeconds";e[e.TwentyOneSeconds=3]="TwentyOneSeconds";e[e.TwentyEightSeconds=4]="TwentyEightSeconds"})(n.AutoDismissValues||(n.AutoDismissValues={}));var f=(function(){function e(){}e.Anchor="A";e.Button="button";e.Defs="defs";e.Div="div";e.FieldSet="fieldset";e.Form="form";e.Img="img";e.Input="input";e.Label="label";e.Legend="legend";e.Option="option";e.Polygon="polygon";e.Select="select";e.Span="span";e.Svg="svg";e.TextArea="textarea";e.Use="use";return e})();n.Tags=f;var l=(function(){function e(){}e.PrivacyStatementLink="http://go.microsoft.com/fwlink/?LinkID=390004";return e})();n.Urls=l},{}],49:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../FloodgateCore/UISurvey/UISurvey"),i=e("./../Window/Window"),s=(function(){function e(){}e.prototype.makeSurveyLauncher=function(e){return new o(e)};return e})();n.default=s;var o=(function(){function e(e){this.survey=e}e.prototype.launch=function(){i.get().OfficeBrowserFeedback.floodgate.showSurvey(new r.default(this.survey))};return e})()},{"./../FloodgateCore/UISurvey/UISurvey":57,"./../Window/Window":93}],50:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../Configuration/Configuration"),i=(function(){function e(){}e.prototype.getLanguage=function(){return r.get().getCommonInitOptions().originalLocale};return e})();n.default=i},{"./../Configuration/Configuration":47}],51:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("@ms-ofb/officefloodgatecore/dist/src/Api/Api"),i=e("./../Window/Window"),s=e("./../Logging/Logging"),o=r.IFloodgateStorageProvider.FileType,u={};u[o.CampaignDefinitions.toString()]="obf-CampaignDefinitions";u[o.CampaignStates.toString()]="obf-CampaignStates";u[o.FloodgateSettings.toString()]="obf-FloodgateSettings";u[o.GovernedChannelStates.toString()]="obf-GovernedChannelStates";u[o.SurveyActivationStats.toString()]="obf-SurveyActivationStats";u[o.SurveyEventActivityStats.toString()]="obf-SurveyEventActivityStats";var a=(function(){function e(){}e.isStorageAvailable=function(){try{var e="__storage_test__";i.get().localStorage.setItem(e,e);i.get().localStorage.removeItem(e);return!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&0!==i.get().localStorage.length}};e.prototype.fileLock=function(e){};e.prototype.fileUnlock=function(e){};e.prototype.read=function(e){if(!(e in o&&u.hasOwnProperty(e.toString())))return"";var t,n=u[e];try{t=i.get().localStorage.getItem(n)}catch(e){s.getLogger().logEvent(s.EventIds.Survey.Floodgate.FileRead.Failed.VALUE,{ErrorMessage:e.toString(),FileName:n});return""}return t};e.prototype.write=function(e,t){if(e in o&&u.hasOwnProperty(e.toString())){var n=u[e];try{i.get().localStorage.setItem(n,t)}catch(e){s.getLogger().logEvent(s.EventIds.Survey.Floodgate.FileWrite.Failed.VALUE,{ErrorMessage:e.toString(),FileName:n});return}}};return e})();n.default=a},{"./../Logging/Logging":60,"./../Window/Window":93,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5}],52:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("@ms-ofb/officefloodgatecore/dist/src/Api/Api"),i=e("./../UIStrings/UIStrings"),s=e("./../Configuration/Configuration"),o=(function(){function e(){}e.prototype.loadStringResource=function(e){var t=i.getUIStrings();switch(e){case r.IFloodgateStringProvider.StringType.Nps11RatingValue0:return t.Floodgate.Nps.Rating.Points11Value0;case r.IFloodgateStringProvider.StringType.Nps11RatingValue1:return t.Floodgate.Nps.Rating.Points11Value1;case r.IFloodgateStringProvider.StringType.Nps11RatingValue2:return t.Floodgate.Nps.Rating.Points11Value2;case r.IFloodgateStringProvider.StringType.Nps11RatingValue3:return t.Floodgate.Nps.Rating.Points11Value3;case r.IFloodgateStringProvider.StringType.Nps11RatingValue4:return t.Floodgate.Nps.Rating.Points11Value4;case r.IFloodgateStringProvider.StringType.Nps11RatingValue5:return t.Floodgate.Nps.Rating.Points11Value5;case r.IFloodgateStringProvider.StringType.Nps11RatingValue6:return t.Floodgate.Nps.Rating.Points11Value6;case r.IFloodgateStringProvider.StringType.Nps11RatingValue7:return t.Floodgate.Nps.Rating.Points11Value7;case r.IFloodgateStringProvider.StringType.Nps11RatingValue8:return t.Floodgate.Nps.Rating.Points11Value8;case r.IFloodgateStringProvider.StringType.Nps11RatingValue9:return t.Floodgate.Nps.Rating.Points11Value9;case r.IFloodgateStringProvider.StringType.Nps11RatingValue10:return t.Floodgate.Nps.Rating.Points11Value10;case r.IFloodgateStringProvider.StringType.Nps5RatingValue1:return t.Floodgate.Nps.Rating.Points5Value1;case r.IFloodgateStringProvider.StringType.Nps5RatingValue2:return t.Floodgate.Nps.Rating.Points5Value2;case r.IFloodgateStringProvider.StringType.Nps5RatingValue3:return t.Floodgate.Nps.Rating.Points5Value3;case r.IFloodgateStringProvider.StringType.Nps5RatingValue4:return t.Floodgate.Nps.Rating.Points5Value4;case r.IFloodgateStringProvider.StringType.Nps5RatingValue5:return t.Floodgate.Nps.Rating.Points5Value5;case r.IFloodgateStringProvider.StringType.NpsRatingQuestion:return t.Floodgate.Nps.Rating.Question;case r.IFloodgateStringProvider.StringType.NpsCommentQuestion:return t.Floodgate.Nps.Comment.Question;case r.IFloodgateStringProvider.StringType.NpsPromptNotNowLabel:return t.Floodgate.Nps.Prompt.No;case r.IFloodgateStringProvider.StringType.NpsPromptQuestion:return t.Floodgate.Nps.Prompt.Question;case r.IFloodgateStringProvider.StringType.NpsPromptTitle:return t.Floodgate.Nps.Prompt.Title;case r.IFloodgateStringProvider.StringType.NpsPromptYesLabel:return t.Floodgate.Nps.Prompt.Yes;default:return""}};e.prototype.getCustomString=function(e){return s.get().getFloodgateInitOptions().uIStringGetter(e)};return e})();n.default=o},{"./../Configuration/Configuration":47,"./../UIStrings/UIStrings":71,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5}],53:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("../Logging/Logging"),i=(function(){function e(){}e.prototype.log_TriggerMet=function(e,t,n){r.getLogger().logEvent(r.EventIds.Survey.Floodgate.TriggerMet.VALUE,{CampaignId:e,SurveyId:t,SurveyType:n})};e.prototype.log_UserSelected=function(e,t,n){r.getLogger().logEvent(r.EventIds.Survey.Floodgate.UserSelected.VALUE,{CampaignId:e,SurveyId:t,SurveyType:n})};e.prototype.log_CampaignLoad_Failed=function(e){r.getLogger().logEvent(r.EventIds.Survey.Floodgate.CampaignLoad.Failed.VALUE,{ErrorMessage:e})};e.prototype.log_Event=function(e,t){var n={name:e};r.getLogger().logEvent(n,t)};return e})();n.default=i},{"../Logging/Logging":60}],54:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../Transport/Transport"),i=e("./../Configuration/Configuration"),s=(function(){function e(){}e.prototype.makeTransporter=function(e){return new r.Transporter(i.get().getCommonInitOptions().environment,e,i.get().getCommonInitOptions().appId,"Survey",i.get().getCommonInitOptions().applicationGroup,i.get().getCommonInitOptions().telemetryGroup,i.get().getCommonInitOptions().webGroup)};return e})();n.default=s},{"./../Configuration/Configuration":47,"./../Transport/Transport":70}],55:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("../../Utils"),i=(function(){function e(e){this.comment="";this.ratingIndex=-1;this.showPrompt=e.showPrompt;this.showEmailRequest=!!r.isBoolean(e.showEmailRequest)&&e.showEmailRequest;this.survey=e}e.prototype.getPromptQuestion=function(){return this.survey.promptQuestion};e.prototype.getTitle=function(){return this.survey.title};e.prototype.getPromptYesButtonText=function(){return this.survey.promptYesButtonText};e.prototype.getPromptNoButtonText=function(){return this.survey.promptNoButtonText};e.prototype.getRatingValuesAscending=function(){return this.survey.ratingValuesAscending};e.prototype.getRatingQuestion=function(){return this.survey.ratingQuestion};e.prototype.getCommentQuestion=function(){return this.survey.commentQuestion};e.prototype.setValues=function(e,t){this.comment=t;this.isRatingIndexValid(e)?this.ratingIndex=e:this.ratingIndex=-1};e.prototype.getJsonElements=function(){var e={};e.comment=this.comment;e.rating=this.getNormalizedRatingScore();e.survey={surveyId:this.getCampaignId()};return e};e.prototype.getSurveyType=function(){return this.survey.surveyType};e.prototype.getCampaignId=function(){return this.survey.campaignId};e.prototype.getId=function(){return this.getCampaignId()};e.prototype.isRatingIndexValid=function(e){return e>=0&&e<this.survey.ratingValuesAscending.length};e.prototype.getNormalizedRatingScore=function(){return this.isRatingIndexValid(this.ratingIndex)?this.survey.isZeroBased?this.ratingIndex/(this.survey.ratingValuesAscending.length-1):(this.ratingIndex+1)/this.survey.ratingValuesAscending.length:-1};return e})();n.default=i},{"../../Utils":90}],56:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("../../Utils"),i=e("@ms-ofb/officefloodgatecore/dist/src/Api/Api"),s=(function(){function e(){this.showPrompt=!0;this.showEmailRequest=!0;this.comment=""}e.prototype.getPromptQuestion=function(){return"Prompt question?"};e.prototype.getTitle=function(){return"Title"};e.prototype.getPromptYesButtonText=function(){return"Yes"};e.prototype.getPromptNoButtonText=function(){return"No"};e.prototype.getRatingValuesAscending=function(){return["worst","worse","ok","better","best"]};e.prototype.getRatingQuestion=function(){return"Rating question?"};e.prototype.getCommentQuestion=function(){return"Comment question?"};e.prototype.setValues=function(e,t){t&&(this.comment=t);r.isInteger(e)&&e>=0&&e<=4&&(this.rating=e/4)};e.prototype.getJsonElements=function(){var e={};this.comment&&(e.comment=this.comment);this.rating&&(e.rating=this.rating);return e};e.prototype.getSurveyType=function(){return i.ISurvey.Type.Nps};e.prototype.getCampaignId=function(){return"10000000-0000-0000-0000-000000000000"};e.prototype.getId=function(){return"00000000-0000-0000-0000-000000000000"};return e})();n.default=s},{"../../Utils":90,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5}],57:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("@ms-ofb/officefloodgatecore/dist/src/Api/Api"),i=(function(){function e(e){this.showPrompt=!0;this.showEmailRequest=!1;if(!e)throw Error("survey must not be null");this.survey=e;var t=e.getComponent(r.ISurveyComponent.Type.Prompt),n=e.getComponent(r.ISurveyComponent.Type.Comment),i=e.getComponent(r.ISurveyComponent.Type.Rating);if(!t)throw Error("prompt component must not be null");this.prompt=t;this.showEmailRequest=e.getSurveyInfo().isAdditionalDataRequested(r.ISurveyInfo.AdditionalDataType.EmailAddress);if(!n)throw Error("comment component must not be null");this.comment=n;if(!i)throw Error("rating component must not be null");this.rating=i}e.prototype.getPromptQuestion=function(){return this.prompt.getQuestion()};e.prototype.getTitle=function(){return this.prompt.getTitle()};e.prototype.getPromptYesButtonText=function(){return this.prompt.getYesButtonText()};e.prototype.getPromptNoButtonText=function(){return this.prompt.getNoButtonText()};e.prototype.getRatingValuesAscending=function(){return this.rating.getRatingValuesAscending()};e.prototype.getRatingQuestion=function(){return this.rating.getQuestion()};e.prototype.getCommentQuestion=function(){return this.comment.getQuestion()};e.prototype.setValues=function(e,t){this.rating.setSelectedRatingIndex(e);this.comment.setSubmittedText(t)};e.prototype.getJsonElements=function(){return this.survey.getJsonElements()};e.prototype.getSurveyType=function(){return this.survey.getType()};e.prototype.getCampaignId=function(){return this.survey.getSurveyInfo().getBackEndId()};e.prototype.getId=function(){return this.survey.getSurveyInfo().getId()};return e})();n.default=i},{"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5}],58:[function(e,t,n){"use strict";n.__esModule=!0;var r=["af","am","ar","as","az","be","bg","bn-BD","bn-IN","bs","ca","ca-Es-VALENCIA","chr-Cher","cs","cy","da","de","el","en-GB","es","es-MX","et","eu","fa","fi","fil","fr","fr-CA","ga","gd","gl","gu","ha-Latn-NG","he","hi","hr","hu","hy","id","is","it","ja","ka","kk","km-KH","kn","ko","kok","ky","lb","lo","lt","lv","mi","mk","ml","mn","mr","ms","mt","nb-NO","ne","nl","nn-NO","or","pa","pl","prs","pt-BR","pt-PT","quz","ro","ru","sd","si","sk","sl","sq","sr-Cyrl-BA","sr-Cyrl-RS","sr-Latn-RS","sv","sw","ta","te","th","tk","tr","tt","ug","uk","ur","uz-Latn-UZ","vi","zh-Hans","zh-Hant"],i={"ZH-CN":"zh-Hans","ZH-HK":"zh-Hant","ZH-MO":"zh-Hant","ZH-SG":"zh-Hans","ZH-TW":"zh-Hant"};n.validate=function(e){var t=e.toLocaleUpperCase();if(t in i)return i[t];for(var n=0,s=r;n<s.length;n++){if((f=s[n]).toUpperCase()===t)return f}for(var o=t.split("-")[0],u=0,a=r;u<a.length;u++){var f;if((f=a[u]).toUpperCase()===o)return f}return"en"}},{}],59:[function(e,t,n){"use strict";n.__esModule=!0;var r=(function(){function e(){}var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P;e.InApp=((t=function(){}).UI=((n=function(){}).Picker=((r=function(){}).Shown=((i=function(){}).VALUE={name:"InApp_UI_Picker_Shown"},i),r),n.Form=((s=function(){}).Shown=((o=function(){}).VALUE={name:"InApp_UI_Form_Shown"},o),s.Submit=((u=function(){}).VALUE={name:"InApp_UI_Form_Submit"},u),s),n),t);e.Survey=((a=function(){}).UI=((f=function(){}).Prompt=((l=function(){}).Shown=((c=function(){}).VALUE={name:"Survey_UI_Prompt_Shown"},c),l),f.Form=((h=function(){}).Shown=((p=function(){}).VALUE={name:"Survey_UI_Form_Shown"},p),h.Submit=((d=function(){}).VALUE={name:"Survey_UI_Form_Submit"},d),h),f),a.Floodgate=((v=function(){}).TriggerMet=((m=function(){}).VALUE={name:"Survey_Floodgate_TriggerMet"},m),v.UserSelected=((g=function(){}).VALUE={name:"Survey_Floodgate_UserSelected"},g),v.CampaignLoad=((y=function(){}).Failed=((b=function(){}).VALUE={name:"Survey_Floodgate_CampaignLoad_Failed"},b),y),v.FileWrite=((w=function(){}).Failed=((E=function(){}).VALUE={name:"Survey_Floodgate_FileWrite_Failed"},E),w),v.FileRead=((S=function(){}).Failed=((x=function(){}).VALUE={name:"Survey_Floodgate_FileRead_Failed"},x),S),v),a);e.Shared=((T=function(){}).Upload=((N=function(){}).Failed=((C=function(){}).VALUE={name:"Shared_Upload_Failed"},C),N),T.Screenshot=((k=function(){}).Render=((L=function(){}).Failed=((A=function(){}).VALUE={name:"Shared_Screenshot_Render_Failed"},A),L.Success=((O=function(){}).VALUE={name:"Shared_Screenshot_Render_Success"},O),L),k.GetContent=((M=function(){}).Failed=((_=function(){}).DefaultImage=((D=function(){}).Returned=((P=function(){}).VALUE={name:"Shared_Screenshot_GetContent_Failed_DefaultImage_Returned"},P),D),_),M),k),T);return e})();n.EventIds=r},{}],60:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../Constants"),i=e("./Telemetry/Contracts"),s=e("./../Utils"),o=e("./Telemetry/TelemetryLoggerFactory"),u=e("./Constants");n.EventIds=u.EventIds;var a,f="Office_Feedback";n.initialize=function(e,t,n,r,u,h,p){a=new l(o.default.create(c.getTenantToken(e),f,new i.App(t,n),new i.Session(s.guid()),new i.Host(u,h,p),new i.Release(r)))};n.getLogger=function(){return a};var l=(function(){function e(e){if(!e)throw new Error("telemetryLogger must not be null");this.telemetryLogger=e}e.prototype.logEvent=function(t,n){if(!t)throw new Error("eventId must not be null");(n=n||{})[e.EVENT_ID]=t.name;this.telemetryLogger.logEvent(e.EVENT_NAME,n)};e.EVENT_NAME="SDK";e.EVENT_ID="EventId";return e})();n.Logger=l;var c=(function(){function e(){}e.getTenantToken=function(t){return t===r.Environment.Production?e.TENANT_TOKEN_PRODUCTION:e.TENANT_TOKEN_PRE_PRODUCTION};e.TENANT_TOKEN_PRODUCTION="d79e824386c4441cb8c1d4ae15690526-bd443309-5494-444a-aba9-0af9eef99f84-7360";e.TENANT_TOKEN_PRE_PRODUCTION="2bf6a2ffddca4a80a892a0b182132961-625cb102-8b0c-480e-af53-92e48695d08d-7736";return e})()},{"./../Constants":48,"./../Utils":90,"./Constants":59,"./Telemetry/Contracts":63,"./Telemetry/TelemetryLoggerFactory":64}],61:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../../thirdparty/aria-webjs-compact-sdk-1.2.2");n.AWT=function(){return r.AWT}},{"./../../thirdparty/aria-webjs-compact-sdk-1.2.2":94}],62:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./Aria"),i=e("./Contracts"),s=(function(){function e(e,t,n,i,s,o){if(!e)throw new Error("tenantToken must not be null");if(!t)throw new Error("namespace must not be null");if(!n)throw new Error("app must not be null");if(!i)throw new Error("session must not be null");r.AWT().initialize(e);this.namespace=t;this.oesApp=n;this.oesSession=i;this.oesHost=s;this.oesRelease=o;this.sequence=1}e.setApp=function(e,t){e["App.Name"]=t.getName();e["App.Platform"]=t.getPlatform();e["App.Version"]=t.getVersion()};e.setSession=function(e,t){e["Session.Id"]=t.getId()};e.setHost=function(e,t){if(t){e["Host.Id"]=t.getId();e["Host.Version"]=t.getVersion()}};e.setEvent=function(e,t){e["Event.Name"]=t.getName();e["Event.Id"]=t.getId();e["Event.Source"]=t.getSource();e["Event.SchemaVersion"]=t.getSchemaVersion();e["Event.Sequence"]=t.getSequence()};e.setRelease=function(e,t){t&&(e["Release.AudienceGroup"]=t.getAudienceGroup())};e.prototype.logEvent=function(t,n){if(!t)throw new Error("eventName must not be null");var s=new i.Event(this.namespace+e.EVENT_NAME_DELIMITER+t,this.oesSession.getId(),this.sequence),o={};if(null!=n)for(var u in n)n.hasOwnProperty(u)&&(o[e.CUSTOM_PROPERTIES_FIELD_PREFIX+u]=n[u]);e.setApp(o,this.oesApp);e.setSession(o,this.oesSession);e.setHost(o,this.oesHost);e.setRelease(o,this.oesRelease);e.setEvent(o,s);r.AWT().logEvent({name:s.getName(),properties:o});this.sequence++};e.EVENT_NAME_DELIMITER="_";e.CUSTOM_PROPERTIES_FIELD_PREFIX="Data.";return e})();n.default=s},{"./Aria":61,"./Contracts":63}],63:[function(e,t,n){"use strict";n.__esModule=!0;var r=(function(){function e(e,t){if(!e)throw new Error("name must not be null");if(!t)throw new Error("version must not be null");this.name=e;this.version=t}e.prototype.getName=function(){return this.name};e.prototype.getPlatform=function(){return e.PLATFORM};e.prototype.getVersion=function(){return this.version};e.PLATFORM="Web";return e})();n.App=r;var i=(function(){function e(e){if(!e)throw new Error("id must not be null");this.id=e}e.prototype.getId=function(){return this.id};return e})();n.Session=i;var s=(function(){function e(e,t,n){this.id=e;this.sessionId=t;this.version=n}e.prototype.getId=function(){return this.id};e.prototype.getSessionId=function(){return this.sessionId};e.prototype.getVersion=function(){return this.version};return e})();n.Host=s;var o=(function(){function e(t,n,r){if(!t)throw new Error("name must not be null");if(!n)throw new Error("sessionId must not be null");if(!r&&0!==r||r<0)throw new Error("sequence must not be negative");this.name=t;this.id=n+e.ID_DELIMITER+r;this.sequence=r}e.prototype.getName=function(){return this.name};e.prototype.getId=function(){return this.id};e.prototype.getSource=function(){return e.SOURCE};e.prototype.getSchemaVersion=function(){return e.SCHEMA_VERSION};e.prototype.getSequence=function(){return this.sequence};e.ID_DELIMITER=".";e.SOURCE="MsoThin";e.SCHEMA_VERSION=1;return e})();n.Event=o;var u=(function(){function e(e){this.audienceGroup=e}e.prototype.getAudienceGroup=function(){return this.audienceGroup};return e})();n.Release=u},{}],64:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./AriaTelemetryLogger"),i=(function(){function e(){}e.create=function(e,t,n,i,s,o){return new r.default(e,t,n,i,s,o)};return e})();n.default=i},{"./AriaTelemetryLogger":62}],65:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./Window/Window");n.createScreenShot=function(){return r.get().OfficeBrowserFeedback.html2canvas()(document.body,{background:"#ffffff"})}},{"./Window/Window":93}],66:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./Constants"),i="#0167B0",s="#194789";n.initialize=function(e,t){void 0===e&&(e=void 0);void 0===t&&(t=void 0);e||(e=i);t||(t=s);var n=document.createElement("style");n.textContent="."+r.Classes.OverallAnchor+":hover { background-color: "+t+" } ."+r.Classes.OverallAnchorActive+" { background-color: "+e+" } ."+r.Classes.SpinnerCircle+" { background-color: "+e+" } ."+r.Classes.ChoiceGroup+" input[type=radio]:checked+label>."+r.Classes.ChoiceGroupIcon+" { border-color: "+e+" } ."+r.Classes.ChoiceGroup+" input[type=radio]:hover+label>."+r.Classes.ChoiceGroupIcon+" { border-color: "+t+" } ."+r.Classes.ChoiceGroup+" input[type=radio]:checked+label>."+r.Classes.ChoiceGroupIcon+">span { background-color: "+e+" } ."+r.Classes.SubmitButton+" { background-color: "+e+" } ."+r.Classes.SubmitButton+":hover { background-color: "+t+" } ."+r.Classes.Link+" { color: "+e+" } ."+r.Classes.Link+":hover { color: "+t+" } #"+r.IDs.TPromptTitle+" { color: "+e+" } #"+r.IDs.TFormTitle+" { color: "+e+" } ";document.body.appendChild(n)}},{"./Constants":48}],67:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../../Constants"),i=e("./../../Utils"),s=(function(){function e(e,t,n,r,i,s,u,a){this.manifestData={appId:t,application:s,clientFeedbackId:i,manifestType:e,source:"Client",submitTime:n,telemetry:u,type:o(r),web:a}}e.prototype.setComment=function(e){this.manifestData.comment=e};e.prototype.setEmail=function(e){this.manifestData.email=e};e.prototype.setCategory=function(e){this.manifestData.telemetry=this.manifestData.telemetry||{};this.manifestData.telemetry.featureArea=e};e.prototype.setValues=function(e){if(e)for(var t in e)e.hasOwnProperty(t)&&(this.manifestData.hasOwnProperty(t)?this.manifestData[t]=i.overrideValues(e[t],this.manifestData[t]):this.manifestData[t]=e[t])};e.prototype.getContent=function(){return new Blob([JSON.stringify(this.manifestData)],{type:"application/json"})};return e})();n.Manifest=s;function o(e){return"Survey"===e?e:r.FeedbackType[e]}},{"./../../Constants":48,"./../../Utils":90}],68:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../../Logging/Logging"),i=(function(){function e(e){this.screenshot=e}e.prototype.getContent=function(){var e;try{e=this.screenshot.toDataURL("image/jpeg").split(",")[1]}catch(t){r.getLogger().logEvent(r.EventIds.Shared.Screenshot.GetContent.Failed.DefaultImage.Returned.VALUE,{ErrorMessage:t.toString()});e="iVBORw0KGgoAAAANSUhEUgAAAN0AAAA+AQMAAACV2ox1AAAABGdBTUEAALGPC/xhBQAAAAZQTFRFAAAA////pdmf3QAAAAlwSFlzAAAOwgAADsIBFShKgAAAAjtJREFUSMfV1M1rE0EUAHDBa5r8A9vkL6giFiI0JH+Ih9KLx8TaukkJugShHgrJzYvkVPQkUqgwSePLEELaU+zBg8JKVvSQQNydlsadwCQzziRZ82ETxYMfc3gD8+MxjzcfV8T80f0vkQ8i68tAPSMSQ0PkI6QDpEPkZBHy1Wp1/zjni2lrZq2T2uikDG17A54Hr0vsvwXIl3WXt02zeIHQBSq3DxHk7VO55zIFgLLrcmaaQBGiqCwQArBVQTbNZODNBB5Ee2EEr5eGiDG4k5mcqcy+Ksh+N8K2+bRI1Z68fRMVoV+XmcFwpQJZGohpkds1WtjppGLaq51a2b8yp310UW9/H8VfRj68CIKRsWCFPCCEM419S4bSAOmPmdb3TBrQ4lmnt9n4/Hiv5fTunsOzXbJfLR2rU3Fd5ugOe9mw0lvNOCNxyDdIHkpHCv0S3a+MS0yT+4wkAKx1gBJeVxeMRhSeNZpXJfY+zqAVl+g0mCFRJMgs6oy9+MCMrWZaJJwiWFjuWcIShf+Wk2W9e59OHu21WPdsswZNLKs9wV77mJiaMVbBQ+/1jGZDofFLuOBU/jzG6OQKnkLOZ5EvwolMX2Q19TAX9MWyy/aNarewfZptechdLn8B3TatB/YXB2j4MKw3jTHKX4AO0CbqaSddMokHUbr0PpSXmFG4O4WIu86asCVihfoM6nUmse5gGkbJOyThVesX4UI0d00LBYMr55VuIZl8MkY1uOiTy9v3c+ShuXj5+NdQdL8B+5gmw8WZuREAAAAASUVORK5CYII="}for(var t=atob(e),n=[],i=0;i<t.length;i++)n.push(t.charCodeAt(i));return new Blob([new Uint8Array(n)],{type:"image/jpeg"})};return e})();n.Screenshot=i},{"./../../Logging/Logging":60}],69:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("es6-promise"),i=4e3;var s="https://petrol-int.office.microsoft.com/v1/feedback",o="https://petrol.office.microsoft.com/v1/feedback";n.send=function(e,t,n,u){if(void 0===t)return r.Promise.reject(new Error("Manifest cannot be undefined"));var a,f,l,c,h,p=new FormData;p.append("Manifest",t);n&&p.append("Screenshot",n);u&&p.append("Diagnostics",u);return a="POST",f=e?o:s,l=p,c=function(e,t,n){200!==e.status&&n(new Error("Non-200 response with status code: "+e.status+", response: "+e.responseText));t()},(h=function(e){return new r.Promise(function(t,n){var r=new XMLHttpRequest;r.open(a,f,!0);r.timeout=i;r.onload=function(){c(r,t,n)};r.ontimeout=function(){e>0?h(e-1).then(t,n):n(new Error("Request to '"+f+"' timed out. timeout: "+i))};r.onerror=function(){e>0?h(e-1).then(t,n):n(new Error("Request to '"+f+"' errored. "+r.status+": "+r.responseText))};r.send(l)})})(2)}},{"es6-promise":42}],70:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../Constants"),i=e("./../Utils"),s=e("./../Logging/Logging"),o=e("./Petrol"),u=e("./Files/Screenshot"),a=e("../Configuration/Configuration"),f=e("./Files/Manifest"),l=(function(){function e(e,t,n,r,s,o,u){this.manifest=new f.Manifest(t,n,(new Date).toISOString(),r,i.guid(),s,o,u);this.environment=e}e.prototype.setComment=function(e){this.manifest.setComment(e)};e.prototype.setEmail=function(e){this.manifest.setEmail(e)};e.prototype.setCategory=function(e){this.manifest.setCategory(e)};e.prototype.setScreenshot=function(e){this.screenshot=new u.Screenshot(e)};e.prototype.setManifestValues=function(e){this.manifest.setValues(e)};e.prototype.submit=function(){var e=this.manifest.getContent(),t=void 0;this.screenshot&&(t=this.screenshot.getContent());return o.send(this.environment===r.Environment.Production,e,t).catch(function(e){a.get().getCommonInitOptions().onError("Payload submission failed: "+e.message);s.getLogger().logEvent(s.EventIds.Shared.Upload.Failed.VALUE,{ErrorMessage:e.message})})};return e})();n.Transporter=l},{"../Configuration/Configuration":47,"./../Constants":48,"./../Logging/Logging":60,"./../Utils":90,"./Files/Manifest":67,"./Files/Screenshot":68,"./Petrol":69}],71:[function(e,t,n){"use strict";n.__esModule=!0;var r;n.setUIStrings=function(e){r=e};n.getUIStrings=function(){return r}},{}],72:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../../Constants"),i=e("./Events"),s=e("./Layout"),o=e("./../Renderer"),u=e("./../Utils"),a=e("./../../WindowProperties"),f=e("./FormTemplates/BasicFormTemplate"),l=e("./FormTemplates/UserVoiceFormTemplate"),c=e("./../../Configuration/Configuration");n.createMulti=function(e){var t={};t[r.FeedbackType.Smile]=f;t[r.FeedbackType.Frown]=f;c.get().getInAppFeedbackInitOptions().userVoice&&"en"===c.get().getCommonInitOptions().locale?t[r.FeedbackType.Idea]=l:t[r.FeedbackType.Idea]=f;c.get().getInAppFeedbackInitOptions().bugForm&&(t[r.FeedbackType.Bug]=f);h(o.elementFromJson(s.generateMulti(t)));var n=a.isNarrow();i.registerMulti(t,n,function(t){u.setElementVisibility(r.IDs.OverlayBackground,!1);u.deleteElementById(r.IDs.OverlayBackground);c.get().getInAppFeedbackInitOptions().onDismiss(t);e()});n&&u.addClassById(r.IDs.OverlayBackground,r.Classes.NarrowLayout)};n.createSingle=function(e,t){h(o.elementFromJson(s.generateSingle()));i.registerSingle(t,function(t){u.setElementVisibility(r.IDs.OverlayBackground,!1);u.deleteElementById(r.IDs.OverlayBackground);c.get().getInAppFeedbackInitOptions().onDismiss(t);e()});u.addClassById(r.IDs.OverlayBackground,r.Classes.SingleLayout)};function h(e){document.body.insertBefore(e,document.body.firstChild);u.setElementVisibility(r.IDs.OverlayBackground,!0);u.getInternetExplorerVersion()>9||-1===u.getInternetExplorerVersion()?setTimeout(p,900):p()}function p(){u.setElementVisibility(r.IDs.MainContentHolder,!0);document.getElementById(r.IDs.OverallSmileAnchor)?document.getElementById(r.IDs.OverallSmileAnchor).focus():document.getElementById(r.IDs.SingleFormComment)&&document.getElementById(r.IDs.SingleFormComment).focus()}n.dismiss=function(){}},{"./../../Configuration/Configuration":47,"./../../Constants":48,"./../../WindowProperties":92,"./../Renderer":83,"./../Utils":89,"./Events":73,"./FormTemplates/BasicFormTemplate":74,"./FormTemplates/UserVoiceFormTemplate":77,"./Layout":78}],73:[function(e,t,n){"use strict";n.__esModule=!0;var r,i,s=e("./../../Transport/Transport"),o=e("./../../Configuration/Configuration"),u=e("./../../Constants"),a=e("./../../Logging/Logging"),f=e("./../../Screenshot"),l=e("./../SpinnerControl"),c=e("./../Utils"),h=e("./TabFocus"),p=!1,d=void 0;function v(e){(function(){c.removeEventListenerHelper(window,"keyup",w);(function(){for(var e=0,t=m;e<t.length;e++){var n=t[e];c.unregisterListener(n.id,n.event,n.listener)}m=[]})()})();r(e)}var m=[];function g(e,t,n){c.registerListener(e,t,n);m.push({event:t,id:e,listener:n})}n.registerSingle=function(e,t){void 0===t&&(t=function(e){});d=e;g(u.IDs.SingleFormSubmitButton,"click",A(u.IDs.SingleFormSubmitButton,u.IDs.SingleFormSubmitButtonSpinner,u.IDs.SingleFormComment,u.IDs.SingleFormEmailInput,u.IDs.SingleFormScreenshotCheckbox,u.IDs.SingleFormCategoriesDropdown));y(t)};n.registerMulti=function(e,t,n){void 0===n&&(n=function(e){});p=t;i=e;g(u.IDs.OverallSmileAnchor,"click",N);g(u.IDs.OverallFrownAnchor,"click",C);g(u.IDs.OverallIdeaAnchor,"click",k);g(u.IDs.OverallBugAnchor,"click",L);g(u.IDs.BasicFormSubmitButton,"click",A(u.IDs.BasicFormSubmitButton,u.IDs.BasicFormSubmitButtonSpinner,u.IDs.BasicFormComment,u.IDs.BasicFormEmailInput,u.IDs.BasicFormScreenshotCheckbox,u.IDs.BasicFormCategoriesDropdown));g(u.IDs.UserVoiceFormGoButton,"click",O);y(n)};function y(e){r=e;c.addEventListenerHelper(window,"keyup",w);g(u.IDs.OverlayBackground,"click",E);g(u.IDs.MainContainer,"click",S);g(u.IDs.MainContainer,"keyup",b);g(u.IDs.PrivacyStatementLink,"click",x)}function b(e){if((e.keyCode||e.which)===u.Keys.Tab&&(document.activeElement.id===u.IDs.FirstTabbable&&e.shiftKey||document.activeElement.id===u.IDs.LastTabbable&&!e.shiftKey)){e.stopPropagation();h.cycleTabFocus(document.activeElement)}}function w(e){if(e.keyCode===u.Keys.Esc){e.preventDefault();e.stopPropagation();v(!1)}}function E(e){e.preventDefault();e.stopPropagation();v(!1)}function S(e){e.stopPropagation()}function x(e){e.stopPropagation()}function T(e,t){e.preventDefault();e.stopPropagation();c.replaceClassesById(u.IDs.OverallSmileAnchor,u.Classes.OverallAnchorActive);c.replaceClassesById(u.IDs.OverallFrownAnchor,u.Classes.OverallAnchorActive);c.replaceClassesById(u.IDs.OverallIdeaAnchor,u.Classes.OverallAnchorActive);c.replaceClassesById(u.IDs.OverallBugAnchor,u.Classes.OverallAnchorActive);c.addClassById(t,u.Classes.OverallAnchorActive);a.getLogger().logEvent(a.EventIds.InApp.UI.Form.Shown.VALUE,{FeedbackType:d});var n=i[d];(function(e){for(var t in i)i.hasOwnProperty(t)&&c.setElementVisibility(i[t].containerId,!1);if(p){c.setElementVisibility(u.IDs.LeftFormContainer,!1);c.setElementVisibility(u.IDs.MiddleFormContainer,!0);c.setElementVisibility(e,!0)}else{c.addClassById(u.IDs.ColumnSeparatorDiv,u.Classes.ShowRightBorder);c.setElementVisibility(u.IDs.MiddleFormContainer,!0);c.setElementVisibility(e,!0);c.addClassById(u.IDs.LeftFormContainer,u.Classes.SlideLeft);c.addClassById(u.IDs.MiddleFormContainer,u.Classes.SlideLeft)}})(n.containerId);n.onSelect(d)}function N(e){d=u.FeedbackType.Smile;T(e,u.IDs.OverallSmileAnchor)}function C(e){d=u.FeedbackType.Frown;T(e,u.IDs.OverallFrownAnchor)}function k(e){d=u.FeedbackType.Idea;T(e,u.IDs.OverallIdeaAnchor)}function L(e){d=u.FeedbackType.Bug;T(e,u.IDs.OverallBugAnchor)}function A(e,t,n,r,i,u){return function(h){h.preventDefault();h.stopPropagation();c.setElementVisibility(e,!1);var p=new l.Spinner(t),m=new s.Transporter(o.get().getCommonInitOptions().environment,"Sas",o.get().getCommonInitOptions().appId,d,o.get().getCommonInitOptions().applicationGroup,o.get().getCommonInitOptions().telemetryGroup,o.get().getCommonInitOptions().webGroup),g=document.getElementById(n);g&&!!g.value&&m.setComment(g.value);var y=document.getElementById(r),b=y&&!!y.value;b&&m.setEmail(y.value);var w=document.getElementById(i),E=w&&w.checked,S=document.getElementById(u);S&&S.selectedIndex>0&&m.setCategory(S.value);a.getLogger().logEvent(a.EventIds.InApp.UI.Form.Submit.VALUE,{FeedbackType:d,IsEmailIncluded:b,IsScreenshotIncluded:E});if(E){var x=performance.now();f.createScreenShot().then(function(e){var t=performance.now();a.getLogger().logEvent(a.EventIds.Shared.Screenshot.Render.Success.VALUE,{TimeMilliseconds:t-x});m.setScreenshot(e);m.submit()}).catch(function(e){var t=performance.now();a.getLogger().logEvent(a.EventIds.Shared.Screenshot.Render.Failed.VALUE,{ErrorMessage:e,TimeMilliseconds:t-x});m.submit()})}else m.submit();p.destroy();v(!0)}}function O(e){e.preventDefault();e.stopPropagation();window.open(document.getElementById(u.IDs.UserVoiceFormGoButton).getAttribute(u.AttributeName.Source));v(!1)}},{"./../../Configuration/Configuration":47,"./../../Constants":48,"./../../Logging/Logging":60,"./../../Screenshot":65,"./../../Transport/Transport":70,"./../SpinnerControl":84,"./../Utils":89,"./TabFocus":79}],74:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../../../UIStrings/UIStrings"),i=e("./FormTemplateType"),s=e("./../../CategoriesDropdown"),o=e("./../../RatingControl"),u=e("./../../../Constants"),a=e("./../../../Configuration/Configuration");n.generate=function(){var e=a.get().getInAppFeedbackLaunchOptions().categories;return{children:[{attributes:[{name:u.AttributeName.For,value:u.IDs.BasicFormComment}],classes:[u.Classes.FontSubtitle,u.Classes.TextAlignLeft,u.Classes.FormQuestionMiddleText],id:u.IDs.BasicFormQuestionMiddleText,tag:u.Tags.Label},{attributes:[{name:u.AttributeName.Id,value:u.IDs.BasicFormCategoriesDropdown}],brs:e.show,children:s.generate(e?e.customCategories:null),classes:[u.Classes.FontSubText,u.Classes.FormCategoriesDropdown,u.Classes.TextInput],tag:u.Tags.Select},{attributes:[{name:u.AttributeName.Placeholder,value:r.getUIStrings().Form.CommentPlaceholder},{name:u.AttributeName.MaxLength,value:u.AttributeValue.TextAreaMaxLength}],classes:[u.Classes.FontSubText,u.Classes.FormComment,u.Classes.TextInput],id:u.IDs.BasicFormComment,tag:u.Tags.TextArea},{brs:!1,children:[{attributes:[{name:u.AttributeName.For,value:u.IDs.BasicFormRating}],classes:[u.Classes.FontText,u.Classes.TextAlignLeft,u.Classes.FormRatingLabel],innerText:r.getUIStrings().Form.RatingLabel,tag:u.Tags.Label},o.generate(u.IDs.BasicFormRating)],classes:[u.Classes.FormRatingContainer]},{attributes:[{name:u.AttributeName.Type,value:u.AttributeValue.Text},{name:u.AttributeName.Placeholder,value:r.getUIStrings().Form.EmailPlaceholder},{name:u.AttributeName.AriaLabel,value:r.getUIStrings().Form.EmailPlaceholder},{name:u.AttributeName.Name,value:u.IDs.BasicFormEmailInput},{name:u.AttributeName.MaxLength,value:u.AttributeValue.TextAreaMaxLength},{name:u.AttributeName.Value,value:a.get().getInAppFeedbackInitOptions().userEmail?a.get().getInAppFeedbackInitOptions().userEmail:""}],classes:[u.Classes.FontSubText,u.Classes.FormEmailInput,u.Classes.TextInput],id:u.IDs.BasicFormEmailInput,tag:u.Tags.Input},{children:[{children:[{attributes:[{name:u.AttributeName.Type,value:u.AttributeValue.Checkbox},{name:u.AttributeName.Value,value:u.AttributeValue.Unchecked}],brs:a.get().getInAppFeedbackInitOptions().screenshot,classes:[u.Classes.FormScreenshotCheckbox,u.Classes.CheckBox],id:u.IDs.BasicFormScreenshotCheckbox,tag:u.Tags.Input},{attributes:[{name:u.AttributeName.For,value:u.IDs.BasicFormScreenshotCheckbox}],brs:a.get().getInAppFeedbackInitOptions().screenshot,classes:[u.Classes.FontText,u.Classes.TextAlignLeft,u.Classes.FormScreenshotLabel],innerText:r.getUIStrings().Form.ScreenshotLabel,tag:u.Tags.Label}],classes:[u.Classes.FormScreenshotContainer]},{children:[{classes:[u.Classes.FontSubText,u.Classes.SubmitButton],id:u.IDs.BasicFormSubmitButton,innerText:r.getUIStrings().Form.Submit,tag:u.Tags.Button},{classes:[u.Classes.Spinner,u.Classes.Hidden],id:u.IDs.BasicFormSubmitButtonSpinner,tag:u.Tags.Div}],classes:[u.Classes.FormSubmitButtonContainer]}],classes:[u.Classes.FormBottomContainer]}],classes:[u.Classes.Hidden,u.Classes.MarginLeft60px],id:n.containerId}};n.containerId=u.IDs.BasicFormContainer;n.onSelect=function(e){switch(e){case u.FeedbackType.Smile:document.getElementById(u.IDs.BasicFormQuestionMiddleText).textContent=r.getUIStrings().SmileForm.Title;break;case u.FeedbackType.Frown:document.getElementById(u.IDs.BasicFormQuestionMiddleText).textContent=r.getUIStrings().FrownForm.Title;break;case u.FeedbackType.Idea:document.getElementById(u.IDs.BasicFormQuestionMiddleText).textContent=r.getUIStrings().IdeaForm.Title;break;case u.FeedbackType.Bug:document.getElementById(u.IDs.BasicFormQuestionMiddleText).textContent=r.getUIStrings().BugForm.Title}document.getElementById(u.IDs.BasicFormComment).focus()};n.type=i.FormTemplateType.Basic},{"./../../../Configuration/Configuration":47,"./../../../Constants":48,"./../../../UIStrings/UIStrings":71,"./../../CategoriesDropdown":80,"./../../RatingControl":82,"./FormTemplateType":75}],75:[function(e,t,n){"use strict";n.__esModule=!0;(function(e){e[e.Single=0]="Single";e[e.Basic=1]="Basic";e[e.UserVoice=2]="UserVoice"})(n.FormTemplateType||(n.FormTemplateType={}))},{}],76:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../../../UIStrings/UIStrings"),i=e("./FormTemplateType"),s=e("./../../CategoriesDropdown"),o=e("./../../RatingControl"),u=e("./../../../Configuration/Configuration"),a=e("./../../../Constants");n.generate=function(){var e=u.get().getInAppFeedbackLaunchOptions().categories;return{children:[{attributes:[{name:a.AttributeName.For,value:a.IDs.SingleFormComment}],classes:[a.Classes.FontSubtitle,a.Classes.TextAlignLeft,a.Classes.FormQuestionMiddleText],id:a.IDs.SingleFormQuestionMiddleText,innerText:r.getUIStrings().SingleForm.Title,tag:a.Tags.Label},{attributes:[{name:a.AttributeName.Id,value:a.IDs.SingleFormCategoriesDropdown}],brs:e.show,children:s.generate(e?e.customCategories:null),classes:[a.Classes.FontSubText,a.Classes.FormCategoriesDropdown,a.Classes.TextInput],tag:a.Tags.Select},{attributes:[{name:a.AttributeName.Placeholder,value:r.getUIStrings().Form.CommentPlaceholder},{name:a.AttributeName.MaxLength,value:a.AttributeValue.TextAreaMaxLength}],classes:[a.Classes.FontSubText,a.Classes.FormComment,a.Classes.TextInput],id:a.IDs.SingleFormComment,tag:a.Tags.TextArea},{brs:!1,children:[{attributes:[{name:a.AttributeName.For,value:a.IDs.SingleFormRating}],classes:[a.Classes.FontSubText,a.Classes.TextAlignLeft,a.Classes.FormRatingLabel],innerText:r.getUIStrings().Form.RatingLabel,tag:a.Tags.Label},o.generate(a.IDs.SingleFormRating)],classes:[a.Classes.FormRatingContainer]},{attributes:[{name:a.AttributeName.Type,value:a.AttributeValue.Text},{name:a.AttributeName.Placeholder,value:r.getUIStrings().Form.EmailPlaceholder},{name:a.AttributeName.AriaLabel,value:r.getUIStrings().Form.EmailPlaceholder},{name:a.AttributeName.Name,value:a.IDs.SingleFormEmailInput},{name:a.AttributeName.MaxLength,value:a.AttributeValue.TextAreaMaxLength},{name:a.AttributeName.Value,value:u.get().getInAppFeedbackInitOptions().userEmail?u.get().getInAppFeedbackInitOptions().userEmail:""}],classes:[a.Classes.FontSubText,a.Classes.FormEmailInput,a.Classes.TextInput],id:a.IDs.SingleFormEmailInput,tag:a.Tags.Input},{children:[{attributes:[{name:a.AttributeName.HRef,value:a.Urls.PrivacyStatementLink},{name:a.AttributeName.Target,value:a.AttributeValue.BlankWindow},{name:a.AttributeName.Rel,value:a.AttributeValue.NoReferrer}],classes:[a.Classes.Link],id:a.IDs.PrivacyStatementLink,innerText:r.getUIStrings().PrivacyStatement,tag:a.Tags.Anchor}],classes:[a.Classes.FontSubSubText,a.Classes.TextAlignLeft,a.Classes.PrivacyStatementLinkDiv]},{children:[{children:[{attributes:[{name:a.AttributeName.Type,value:a.AttributeValue.Checkbox},{name:a.AttributeName.Value,value:a.AttributeValue.Unchecked}],brs:u.get().getInAppFeedbackInitOptions().screenshot,classes:[a.Classes.FormScreenshotCheckbox,a.Classes.CheckBox],id:a.IDs.SingleFormScreenshotCheckbox,tag:a.Tags.Input},{attributes:[{name:a.AttributeName.For,value:a.IDs.SingleFormScreenshotCheckbox}],brs:u.get().getInAppFeedbackInitOptions().screenshot,classes:[a.Classes.FontText,a.Classes.TextAlignLeft,a.Classes.FormScreenshotLabel],innerText:r.getUIStrings().Form.ScreenshotLabel,tag:a.Tags.Label}],classes:[a.Classes.FormScreenshotContainer]},{children:[{classes:[a.Classes.FontSubText,a.Classes.SubmitButton],id:a.IDs.SingleFormSubmitButton,innerText:r.getUIStrings().Form.Submit,tag:a.Tags.Button},{classes:[a.Classes.Spinner,a.Classes.Hidden],id:a.IDs.SingleFormSubmitButtonSpinner,tag:a.Tags.Div}],classes:[a.Classes.FormSubmitButtonContainer]}],classes:[a.Classes.FormBottomContainer]}],id:n.containerId}};n.containerId=a.IDs.SingleFormContainer;n.onSelect=function(e){document.getElementById(a.IDs.SingleFormComment).focus()};n.type=i.FormTemplateType.Single},{"./../../../Configuration/Configuration":47,"./../../../Constants":48,"./../../../UIStrings/UIStrings":71,"./../../CategoriesDropdown":80,"./../../RatingControl":82,"./FormTemplateType":75}],77:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../../../UIStrings/UIStrings"),i=e("./FormTemplateType"),s=e("./../../../Constants"),o=e("./../../../Configuration/Configuration");n.generate=function(){var e=o.get().getInAppFeedbackInitOptions().userVoice;return{children:[{classes:[s.Classes.FontSubtitle,s.Classes.TextAlignLeft,s.Classes.FormQuestionMiddleText],innerText:r.getUIStrings().UserVoiceForm.Title},{classes:[s.Classes.FontText,s.Classes.TextAlignLeft,s.Classes.FormMiddleText],innerText:r.getUIStrings().UserVoiceForm.Text},{children:[{children:[{attributes:[{name:s.AttributeName.Source,value:e.url}],classes:[s.Classes.SubmitButton,s.Classes.FontSubText],id:s.IDs.UserVoiceFormGoButton,innerText:r.getUIStrings().UserVoiceForm.Button,tag:s.Tags.Button}],classes:[s.Classes.FormSubmitButtonContainer]}],classes:[s.Classes.FormBottomContainer]}],classes:[s.Classes.Hidden,s.Classes.MarginLeft60px],id:n.containerId}};n.containerId=s.IDs.UserVoiceFormContainer;n.onSelect=function(e){document.getElementById(s.IDs.UserVoiceFormGoButton).focus()};n.type=i.FormTemplateType.UserVoice},{"./../../../Configuration/Configuration":47,"./../../../Constants":48,"./../../../UIStrings/UIStrings":71,"./FormTemplateType":75}],78:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../../Constants"),i=e("./../../UIStrings/UIStrings"),s=e("./../Utils"),o=e("./FormTemplates/SingleFormTemplate");n.generateMulti=function(e){return{attributes:[{name:r.AttributeName.DataHtml2CanvasIgnore,value:r.AttributeValue.True}],children:[{attributes:[{name:r.AttributeName.Role,value:"dialog"},{name:"aria-modal",value:"true"},{name:"aria-describedby",value:r.IDs.QuestionLeftText}],children:[{attributes:[{name:r.AttributeName.TabIndex,value:r.AttributeValue.Zero}],id:r.IDs.FirstTabbable},{children:[{children:[{classes:[r.Classes.FontSubtitle,r.Classes.TextAlignLeft],id:r.IDs.QuestionLeftText,innerText:i.getUIStrings().FeedbackSubtitle},{children:[{children:a(e),id:r.IDs.OverallAnchorsContainer}],id:r.IDs.ColumnSeparatorDiv},{children:[{attributes:[{name:r.AttributeName.HRef,value:r.Urls.PrivacyStatementLink},{name:r.AttributeName.Target,value:r.AttributeValue.BlankWindow},{name:r.AttributeName.Rel,value:r.AttributeValue.NoReferrer}],classes:[r.Classes.Link],id:r.IDs.PrivacyStatementLink,innerText:i.getUIStrings().PrivacyStatement,tag:r.Tags.Anchor}],classes:[r.Classes.FontSubSubText,r.Classes.TextAlignLeft,r.Classes.PrivacyStatementLinkDiv]}],classes:[r.Classes.FormContainer],id:r.IDs.LeftFormContainer},{children:u(e),classes:[r.Classes.FormContainer,r.Classes.Hidden],id:r.IDs.MiddleFormContainer}],classes:[r.Classes.Hidden],id:r.IDs.MainContentHolder,tag:r.Tags.Form},{attributes:[{name:r.AttributeName.TabIndex,value:r.AttributeValue.Zero}],id:r.IDs.LastTabbable}],id:r.IDs.MainContainer}],classes:[s.isRightToLeft()?r.Classes.Rtl:""],id:r.IDs.OverlayBackground}};n.generateSingle=function(){return{attributes:[{name:r.AttributeName.DataHtml2CanvasIgnore,value:r.AttributeValue.True}],children:[{children:[{attributes:[{name:r.AttributeName.TabIndex,value:r.AttributeValue.Zero}],id:r.IDs.FirstTabbable},{children:[{children:[o.generate()],classes:[r.Classes.FormContainer],id:r.IDs.MiddleFormContainer}],classes:[r.Classes.Hidden],id:r.IDs.MainContentHolder,tag:r.Tags.Form},{attributes:[{name:r.AttributeName.TabIndex,value:r.AttributeValue.Zero}],id:r.IDs.LastTabbable}],id:r.IDs.MainContainer}],classes:[r.Classes.SingleLayout,s.isRightToLeft()?r.Classes.Rtl:""],id:r.IDs.OverlayBackground}};function u(e){var t={children:[]},n={};for(var r in e)if(e.hasOwnProperty(r)){if(!(e[r].containerId in n)){t.children.push(e[r].generate());n[e[r].containerId]=!0}}return t.children}function a(e){var t={children:[]};r.FeedbackType.Smile in e&&t.children.push(f(r.IDs.OverallSmileAnchor,r.IDs.OverallSmileImage,'<svg viewBox="0 0 72 72" width="24px" height="24px" focusable="false"><path d="M36 1C16.7 1 1 16.7 1 36s15.7 35 35 35c19.3 0 35-15.7 35-35S55.3 1 36 1ZM49.3 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C45.1 21 47 18.3 49.3 18.3ZM22.9 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C18.7 21 20.6 18.3 22.9 18.3ZM36 58.6c-8.5 0-16-4.1-20.9-10.4l3.5-3.6c3.5 4.5 9.9 7.6 17.4 7.6 7.4 0 13.9-3.1 17.4-7.6l3.6 3.6C52.1 54.4 44.4 58.6 36 58.6Z"/></svg>',r.IDs.OverallSmileText,i.getUIStrings().SmileForm.Anchor));r.FeedbackType.Frown in e&&t.children.push(f(r.IDs.OverallFrownAnchor,r.IDs.OverallFrownImage,'<svg viewBox="0 0 72 72" width="24px" height="24px" focusable="false"><path d="M36 1C16.7 1 1 16.7 1 36s15.7 35 35 35c19.3 0 35-15.7 35-35S55.3 1 36 1ZM49.3 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C45.1 21 47 18.3 49.3 18.3ZM22.9 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C18.7 21 20.6 18.3 22.9 18.3ZM52.8 57.9c-3.3-4.4-9.6-7.3-16.7-7.3 -7.2 0-13.4 3-16.7 7.3l-3.4-3.4c4.7-6.1 11.9-10 20.1-10 8.2 0 15.5 4 20.2 10L52.8 57.9Z"/></svg>',r.IDs.OverallFrownText,i.getUIStrings().FrownForm.Anchor));r.FeedbackType.Idea in e&&t.children.push(f(r.IDs.OverallIdeaAnchor,r.IDs.OverallIdeaImage,'<svg viewBox="0 0 72 72" width="24px" height="24px" focusable="false"><path d="M42.3 62H29.2c-1.1 0-2 0.9-2 2s1.9 2 3 2h11.1c1.1 0 3-0.9 3-2S43.4 62 42.3 62ZM36 1.1C25 1.1 14.8 7 14.8 20.6c0 2.2 0.8 4.4 0.7 4.1 1.2 2.9 2.7 5.6 6.3 10.9 4.2 6.3 4.7 7.6 4.8 11.1v1.3c0 1.3 1 3 2.7 3h13.5c1.7 0 2.8-1.7 2.8-3v-1.5c0.1-3.5 0.1-4.7 4.2-10.9 3.6-5.4 5.7-8.4 6.8-11 0 0 0.6-1.6 0.6-4.1C57.2 6.9 47 1.1 36 1.1ZM31.9 11.9c-3.2 0-5.6 4.2-5.5 6.2 0.2 4-4.4 3.8-4.4 0.6 0-5.3 2.8-10.3 8.5-10.9C34.6 7.3 34.6 11.9 31.9 11.9ZM43.6 55h-15c-1.1 0-2 0.9-2 2v1c0 1.1 0.9 2 2 2h15c1.1 0 2-0.9 2-2v-1C45.6 55.9 44.7 55 43.6 55ZM39.1 68h-6c-0.8 0-1.5 0.7-1.5 1.5s1.2 1.5 2 1.5h5c0.8 0 2-0.7 2-1.5S39.9 68 39.1 68Z"/></svg>',r.IDs.OverallIdeaText,i.getUIStrings().IdeaForm.Anchor));r.FeedbackType.Bug in e&&t.children.push(f(r.IDs.OverallBugAnchor,r.IDs.OverallBugImage,'<svg viewBox="150 100 1748 1748" width="24px" height="24px" focusable="false"><path d="M1824 1088q0 26-19 45t-45 19h-224q0 171-67 290l208 209q19 19 19 45t-19 45q-18 19-45 19t-45-19l-198-197q-5 5-15 13t-42 28.5-65 36.5-82 29-97 13v-896h-128v896q-51 0-101.5-13.5t-87-33-66-39-43.5-32.5l-15-14-183 207q-20 21-48 21-24 0-43-16-19-18-20.5-44.5t15.5-46.5l202-227q-58-114-58-274h-224q-26 0-45-19t-19-45 19-45 45-19h224v-294l-173-173q-19-19-19-45t19-45 45-19 45 19l173 173h844l173-173q19-19 45-19t45 19 19 45-19 45l-173 173v294h224q26 0 45 19t19 45zm-480-576h-640q0-133 93.5-226.5t226.5-93.5 226.5 93.5 93.5 226.5z"/></svg>',r.IDs.OverallBugText,i.getUIStrings().BugForm.Anchor));return t.children}function f(e,t,n,i,s){return{attributes:[{name:r.AttributeName.Type,value:r.AttributeValue.Button}],children:[{classes:[r.Classes.OverallImage],id:t,innerHTML:n,tag:r.Tags.Div},{classes:[r.Classes.FontSubtitle,r.Classes.OverallText],id:i,innerText:s}],classes:[r.Classes.OverallAnchor,r.Classes.TextAlignLeft],id:e,tag:r.Tags.Button}}},{"./../../Constants":48,"./../../UIStrings/UIStrings":71,"./../Utils":89,"./FormTemplates/SingleFormTemplate":76}],79:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../../Constants");n.cycleTabFocus=function(e){var t=document.getElementById(r.IDs.MainContainer).querySelectorAll("a[href], area[href], input:not([disabled]):not([tabindex='-1']), button:not([disabled]):not([tabindex='-1']), select:not([disabled]):not([tabindex='-1']), textarea:not([disabled]):not([tabindex ='-1']), object, *[tabindex]:not([tabindex='-1']), *[contenteditable=true]");if(e.id===r.IDs.LastTabbable)for(var n=0;n<t.length;n++){if((s=t[n]).id!==r.IDs.FirstTabbable&&i(s)){s.focus();return}}else if(e.id===r.IDs.FirstTabbable)for(n=t.length-1;n>=0;n--){var s;if((s=t[n]).id!==r.IDs.LastTabbable&&i(s)){s.focus();return}}};function i(e){if(!e.parentElement)return!1;if(/\S/.test(e.parentElement.id)){if(e.parentElement.className.indexOf(r.Classes.Visible)>=0)return!0;if(e.parentElement.className.indexOf(r.Classes.Hidden)>=0)return!1}return i(e.parentElement)}},{"./../../Constants":48}],80:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../UIStrings/UIStrings"),i=e("./../Constants");n.generate=function(e){for(var t=e||[],n=[{attributes:[{name:"selected",value:"true"}],innerText:r.getUIStrings().Form.CategoryPlaceholder,tag:i.Tags.Option}],s=0,o=t;s<o.length;s++){var u=o[s];n.push({innerText:u,tag:i.Tags.Option})}return n}},{"./../Constants":48,"./../UIStrings/UIStrings":71}],81:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../Constants");n.generateRadioGroup=function(e,t,n){for(var s={children:[{classes:[r.Classes.FontSubText],innerText:t,tag:r.Tags.Legend}],tag:r.Tags.FieldSet},o=0,u=n;o<u.length;o++){var a=u[o];Array.prototype.push.apply(s.children,i(a[0].toString(),a[1],e))}return{children:[s],classes:[r.Classes.ChoiceGroup],id:e}};function i(e,t,n){return[{attributes:[{name:r.AttributeName.Type,value:r.AttributeValue.Radio},{name:r.AttributeName.Value,value:e},{name:r.AttributeName.Name,value:n}],id:e,tag:r.Tags.Input},{attributes:[{name:r.AttributeName.For,value:e}],children:[{children:[{tag:r.Tags.Span}],classes:[r.Classes.ChoiceGroupIcon],tag:r.Tags.Span},{classes:["obf-ChoiceGroupLabel"],innerHTML:t,tag:r.Tags.Span}],classes:[r.Classes.FontSubText],tag:r.Tags.Label}]}},{"./../Constants":48}],82:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../Constants"),i="obf-star",s={children:[{attributes:[{name:r.AttributeName.Id,value:i},{name:r.AttributeName.X,value:"0"},{name:r.AttributeName.Y,value:"0"},{name:r.AttributeName.Width,value:"105"},{name:r.AttributeName.Height,value:"100"},{name:r.AttributeName.Points,value:"52.5, 80.3 84, 100 76.3, 63 105, 38 67.2, 35 52.5, 0 37.8, 35 0, 38 28.7, 63 20, 100 52.5, 80.3"}],id:i,tag:r.Tags.Polygon}],tag:r.Tags.Defs},o={attributes:[{name:r.AttributeName.xlinkHref,value:"#"+i}],tag:r.Tags.Use},u={attributes:[{name:r.AttributeName.xlinkHref,value:"#"+i},{name:r.AttributeName.Transform,value:"translate(105 0)"}],tag:r.Tags.Use},a={attributes:[{name:r.AttributeName.xlinkHref,value:"#"+i},{name:r.AttributeName.Transform,value:"translate(210 0)"}],tag:r.Tags.Use},f={attributes:[{name:r.AttributeName.xlinkHref,value:"#"+i},{name:r.AttributeName.Transform,value:"translate(315 0)"}],tag:r.Tags.Use},l={attributes:[{name:r.AttributeName.xlinkHref,value:"#"+i},{name:r.AttributeName.Transform,value:"translate(420 0)"}],tag:r.Tags.Use},c={attributes:[{name:r.AttributeName.ViewBox,value:"0 0 525 100"}],children:[s,o,u,a,f,l],classes:[r.Classes.RatingGraphic],tag:r.Tags.Svg},h={attributes:[{name:r.AttributeName.ViewBox,value:"0 0 105 100"}],children:[s,o],classes:[r.Classes.RatingGraphic,r.Classes.RatingGraphicFilled],tag:r.Tags.Svg},p={attributes:[{name:r.AttributeName.ViewBox,value:"0 0 210 100"}],children:[s,o,u],classes:[r.Classes.RatingGraphic,r.Classes.RatingGraphicFilled],tag:r.Tags.Svg},d={attributes:[{name:r.AttributeName.ViewBox,value:"0 0 315 100"}],children:[s,o,u,a],classes:[r.Classes.RatingGraphic,r.Classes.RatingGraphicFilled],tag:r.Tags.Svg},v={attributes:[{name:r.AttributeName.ViewBox,value:"0 0 420 100"}],children:[s,o,u,a,f],classes:[r.Classes.RatingGraphic,r.Classes.RatingGraphicFilled],tag:r.Tags.Svg},m={attributes:[{name:r.AttributeName.ViewBox,value:"0 0 525 100"}],children:[s,o,u,a,f,l],classes:[r.Classes.RatingGraphic,r.Classes.RatingGraphicFilled],tag:r.Tags.Svg};n.generate=function(e){return{children:[c,{attributes:[{name:r.AttributeName.Type,value:"radio"},{name:r.AttributeName.Name,value:e},{name:r.AttributeName.Value,value:"1"}],tag:r.Tags.Input},h,{attributes:[{name:r.AttributeName.Type,value:"radio"},{name:r.AttributeName.Name,value:e},{name:r.AttributeName.Value,value:"2"}],tag:r.Tags.Input},p,{attributes:[{name:r.AttributeName.Type,value:"radio"},{name:r.AttributeName.Name,value:e},{name:r.AttributeName.Value,value:"3"}],tag:r.Tags.Input},d,{attributes:[{name:r.AttributeName.Type,value:"radio"},{name:r.AttributeName.Name,value:e},{name:r.AttributeName.Value,value:"4"}],tag:r.Tags.Input},v,{attributes:[{name:r.AttributeName.Type,value:"radio"},{name:r.AttributeName.Name,value:e},{name:r.AttributeName.Value,value:"5"}],tag:r.Tags.Input},m],classes:[r.Classes.Rating],id:e,tag:r.Tags.Span}}},{"./../Constants":48}],83:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../Constants");n.elementFromJson=function e(t,n){void 0===t.brs&&(t.brs=!0);if(!t.brs)return null;t.tag||(t.tag=r.Tags.Div);var i;t.tag===r.Tags.Svg&&(n=!0);i=n?document.createElementNS("http://www.w3.org/2000/svg",t.tag):document.createElement(t.tag);if(t.attributes)for(var s=void 0,o=0;o<t.attributes.length;o++)(s=t.attributes[o]).name===r.AttributeName.xlinkHref?i.setAttributeNS("http://www.w3.org/1999/xlink",r.AttributeName.HRef,s.value):i.setAttribute(s.name,s.value);t.id&&(i.id=t.id);if(t.classes){var u=t.classes.join(" ");n?i.setAttribute(r.AttributeName.Class,u):i.className=u}t.innerText&&!n&&(i.textContent=t.innerText);t.innerHTML&&!n&&(i.innerHTML=t.innerHTML);if(t.children)for(o=0;o<t.children.length;o++){var a=t.children[o];if(a){var f=e(a,n);f&&i.appendChild(f)}}return i}},{"./../Constants":48}],84:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../Constants"),i=e("./Utils"),s=.2,o=34,u=1/8,a=(function(){function e(e){this.circleObjects=[];this.spinnerId=e;this.spinner=document.getElementById(this.spinnerId);this.createCirclesAndArrange();this.initializeOpacities();this.start();i.setElementVisibility(e,!0)}e.prototype.destroy=function(){i.setElementVisibility(this.spinnerId,!1);this.stop()};e.prototype.start=function(){var e=this;this.stop();this.interval=setInterval(function(){for(var t=e.circleObjects.length;t--;)f(e.circleObjects[t])},90)};e.prototype.stop=function(){clearInterval(this.interval)};e.prototype.createCirclesAndArrange=function(){for(var e,t=0,n=o*s,r=2*Math.PI/8,i=8,u=.5*(o-n);i--;){var a=c(),f=Math.round(.5*o+u*Math.cos(t)-.5*a.clientWidth)-.5*n,l=Math.round(.5*o+u*Math.sin(t)-.5*a.clientHeight)-.5*n;this.spinner.appendChild(a);a.style.left=f+"px";a.style.top=l+"px";t+=r;e={element:a,j:i};this.circleObjects.push(e)}};e.prototype.initializeOpacities=function(){for(var e,t=0,n=1;t<8;t++){var r=this.circleObjects[t];e=u*n++;l(r.element,e)}};return e})();n.Spinner=a;function f(e){var t,n=(t=e.element,parseFloat(window.getComputedStyle(t).getPropertyValue("opacity")))-u;n<=0&&(n=1);l(e.element,n)}function l(e,t){e.style.opacity=t.toString()}function c(){var e=document.createElement("div");e.classList.add(r.Classes.SpinnerCircle);e.style.width=e.style.height=o*s+"px";return e}},{"./../Constants":48,"./Utils":89}],85:[function(e,t,n){"use strict";n.__esModule=!0;var r,i,s=e("./../../Transport/Transport"),o=e("./../../Constants"),u=e("./../Utils"),a=e("./../SpinnerControl"),f=e("./../../Logging/Logging"),l=e("./../../Configuration/Configuration"),c=e("@ms-ofb/officefloodgatecore/dist/src/Api/Api");function h(e){!(function(){for(var e=0,t=p;e<t.length;e++){var n=t[e];u.unregisterListener(n.id,n.event,n.listener)}p=[]})();r(e)}var p=[];function d(e,t,n){u.registerListener(e,t,n);p.push({event:t,id:e,listener:n})}n.register=function(e){void 0===e&&(e=function(e){});r=e;i=!0;d(o.IDs.ToastContainer,"keyup",m);d(o.IDs.ToastCancel,"click",g);d(o.IDs.TPromptContainer,"click",y);d(o.IDs.TFormSubmitButton,"click",E);d(o.IDs.TFormEmailCheckBox,"click",v);v(null);for(var t=document.querySelectorAll('input[name="'+o.IDs.TFormRating+'"]'),n=0;n<t.length;++n)u.registerListenerToElement(t[n],"click",w);l.get().getFloodgateSurvey().showPrompt?f.getLogger().logEvent(f.EventIds.Survey.UI.Prompt.Shown.VALUE,{CampaignId:l.get().getFloodgateSurvey().getCampaignId(),SurveyId:l.get().getFloodgateSurvey().getId(),SurveyType:l.get().getFloodgateSurvey().getSurveyType()}):b();var s=l.get().getFloodgateInitOptions().autoDismiss;if(s!==o.AutoDismissValues.NoAutoDismiss){var a=void 0;switch(s){case o.AutoDismissValues.SevenSeconds:a=7e3;break;case o.AutoDismissValues.FourteenSeconds:a=14e3;break;case o.AutoDismissValues.TwentyOneSeconds:a=21e3;break;case o.AutoDismissValues.TwentyEightSeconds:a=28e3}void 0!==a&&setTimeout(function(){i&&h(!1)},a)}};function v(e){var t=document.getElementById(o.IDs.TFormEmailCheckBox);if(t){var n=document.getElementById(o.IDs.TFormEmailTextBox);n.value=t.checked?l.get().getCommonInitOptions().userEmail:null;n.disabled=!t.checked}}function m(e){if(e.keyCode===o.Keys.Esc){e.preventDefault();e.stopPropagation();h(!1)}}function g(e){e.preventDefault();e.stopPropagation();h(!1)}function y(e){e.preventDefault();e.stopPropagation();b()}function b(){i=!1;u.setElementVisibility(o.IDs.TPromptContainer,!1);u.setElementVisibility(o.IDs.TFormContainer,!0);f.getLogger().logEvent(f.EventIds.Survey.UI.Form.Shown.VALUE,{CampaignId:l.get().getFloodgateSurvey().getCampaignId(),SurveyId:l.get().getFloodgateSurvey().getId(),SurveyType:l.get().getFloodgateSurvey().getSurveyType()})}function w(e){document.getElementById(o.IDs.TFormSubmitButton).disabled=!1}function E(e){e.preventDefault();e.stopPropagation();u.setElementVisibility(o.IDs.TFormSubmitButton,!1);var t=new a.Spinner(o.IDs.TFormSubmitButtonSpinner),n=new s.Transporter(l.get().getCommonInitOptions().environment,c.ISurvey.Type[l.get().getFloodgateSurvey().getSurveyType()],l.get().getCommonInitOptions().appId,"Survey",l.get().getCommonInitOptions().applicationGroup,l.get().getCommonInitOptions().telemetryGroup,l.get().getCommonInitOptions().webGroup),r=document.getElementById(o.IDs.TFormComment),i=r&&!!r.value,p=document.querySelector('input[name="'+o.IDs.TFormRating+'"]:checked');l.get().getFloodgateSurvey().setValues(Number(p.value),i?r.value:"");n.setManifestValues(l.get().getFloodgateSurvey().getJsonElements());var d=document.getElementById(o.IDs.TFormEmailCheckBox),v=document.getElementById(o.IDs.TFormEmailTextBox);d&&d.checked&&""!==v.value&&n.setEmail(v.value);n.submit();t.destroy();h(!0);f.getLogger().logEvent(f.EventIds.Survey.UI.Form.Submit.VALUE,{CampaignId:l.get().getFloodgateSurvey().getCampaignId(),SurveyId:l.get().getFloodgateSurvey().getId(),SurveyType:l.get().getFloodgateSurvey().getSurveyType()})}},{"./../../Configuration/Configuration":47,"./../../Constants":48,"./../../Logging/Logging":60,"./../../Transport/Transport":70,"./../SpinnerControl":84,"./../Utils":89,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5}],86:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../ChoiceGroupControl"),i=e("./../../Configuration/Configuration"),s=e("./../../Constants"),o=e("./../../UIStrings/UIStrings"),u=e("./../Utils"),a=e("./../../Constants");n.generate=function(){var e,t;return{attributes:[{name:s.AttributeName.DataHtml2CanvasIgnore,value:s.AttributeValue.True},{name:s.AttributeName.Role,value:"dialog"},{name:"aria-labelledby",value:s.IDs.TPromptTitle},{name:"aria-describedby",value:s.IDs.TPromptText}],children:[{attributes:[{name:s.AttributeName.Type,value:s.AttributeValue.Button},{name:s.AttributeName.AriaLabel,value:o.getUIStrings().CloseLabel}],id:s.IDs.ToastCancel,innerHTML:'<svg viewBox="4 4 16 16" width="16px" height="16px" focusable="false"><path d="M19,6.41L17.59,5 12,10.59 6.41,5 5,6.41 10.59,12 5,17.59 6.41,19 12,13.41 17.59,19 19,17.59 13.41,12z" fill="#000"/></svg>',tag:s.Tags.Button},(t={attributes:[{name:"aria-labelledby",value:s.IDs.TPromptTitle}],children:[{classes:[s.Classes.FontText,s.Classes.TextAlignLeft],id:s.IDs.TPromptTitle,innerText:i.get().getFloodgateSurvey().getTitle()},{classes:[s.Classes.FontSubText,s.Classes.TextAlignLeft],id:s.IDs.TPromptText,innerText:i.get().getFloodgateSurvey().getPromptQuestion()}],id:s.IDs.TPromptContainer,tag:s.Tags.Button},t),(e={children:[{classes:[s.Classes.FontText,s.Classes.TextAlignLeft],id:s.IDs.TFormTitle,innerText:i.get().getFloodgateSurvey().getTitle()},l(),{attributes:[{name:s.AttributeName.Placeholder,value:i.get().getFloodgateSurvey().getCommentQuestion()},{name:s.AttributeName.AriaLabel,value:i.get().getFloodgateSurvey().getCommentQuestion()},{name:s.AttributeName.MaxLength,value:s.AttributeValue.TextAreaMaxLength}],classes:[s.Classes.FontSubText,s.Classes.TextInput],id:s.IDs.TFormComment,tag:s.Tags.TextArea},{brs:i.get().getFloodgateSurvey().showEmailRequest,children:[{attributes:[{name:a.AttributeName.Type,value:a.AttributeValue.Checkbox},{name:f(),value:""}],classes:[a.Classes.TFormEmailCheckbox,a.Classes.CheckBox],id:a.IDs.TFormEmailCheckBox,tag:a.Tags.Input},{attributes:[{name:a.AttributeName.For,value:a.IDs.TFormEmailCheckBox}],classes:[a.Classes.FontSubText,a.Classes.TextAlignLeft,a.Classes.TFormEmailLabel],innerText:o.getUIStrings().Form.EmailCheckBoxLabel,tag:a.Tags.Label},{attributes:[{name:a.AttributeName.Type,value:a.AttributeValue.Text},{name:a.AttributeName.Placeholder,value:o.getUIStrings().Form.EmailPlaceholder},{name:a.AttributeName.AriaLabel,value:o.getUIStrings().Form.EmailPlaceholder},{name:a.AttributeName.Name,value:a.IDs.BasicFormEmailInput},{name:a.AttributeName.MaxLength,value:a.AttributeValue.TextAreaMaxLength},{name:a.AttributeName.Value,value:i.get().getCommonInitOptions().userEmailConsentDefault?i.get().getCommonInitOptions().userEmail:""}],classes:[a.Classes.FontSubText,a.Classes.FormEmailInput,a.Classes.TextInput],id:a.IDs.TFormEmailTextBox,tag:a.Tags.Input}]},{children:[{attributes:[{name:s.AttributeName.HRef,value:s.Urls.PrivacyStatementLink},{name:s.AttributeName.Target,value:s.AttributeValue.BlankWindow},{name:s.AttributeName.Rel,value:s.AttributeValue.NoReferrer}],classes:[s.Classes.Link],innerText:o.getUIStrings().PrivacyStatement,tag:s.Tags.Anchor}],classes:[s.Classes.FontSubSubText,s.Classes.TextAlignLeft,s.Classes.PrivacyStatementLinkDiv]},{children:[{attributes:[{name:s.AttributeName.Disabled,value:s.AttributeValue.True}],classes:[s.Classes.FontSubText,s.Classes.SubmitButton],id:s.IDs.TFormSubmitButton,innerText:o.getUIStrings().Form.Submit,tag:s.Tags.Button},{classes:[s.Classes.Spinner,s.Classes.Hidden],id:s.IDs.TFormSubmitButtonSpinner,tag:s.Tags.Div}],id:s.IDs.TFormSubmitButtonContainer}],classes:[s.Classes.Hidden],id:s.IDs.TFormContainer},e)],classes:[s.Classes.Toast,u.isRightToLeft()?s.Classes.Rtl:""],id:s.IDs.ToastContainer}};function f(){return i.get().getCommonInitOptions().userEmailConsentDefault?a.AttributeValue.Checked:a.AttributeValue.Unchecked}function l(){for(var e=[],t=0,n=0,o=i.get().getFloodgateSurvey().getRatingValuesAscending();n<o.length;n++){var u=o[n];e.push([t,u]);t++}return r.generateRadioGroup(s.IDs.TFormRating,i.get().getFloodgateSurvey().getRatingQuestion(),e.reverse())}},{"./../../Configuration/Configuration":47,"./../../Constants":48,"./../../UIStrings/UIStrings":71,"./../ChoiceGroupControl":81,"./../Utils":89}],87:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../../Constants"),i=e("./Events"),s=e("./Layout"),o=e("./../Renderer"),u=e("./../Utils"),a=e("./../../Configuration/Configuration");n.createSurvey=function(e){(function(e){document.body.insertBefore(e,document.body.firstChild);u.setElementVisibility(r.IDs.ToastContainer,!0)})(o.elementFromJson(s.generate()));i.register(function(t){u.setElementVisibility(r.IDs.ToastContainer,!1);u.deleteElementById(r.IDs.ToastContainer);a.get().getFloodgateInitOptions().onDismiss(a.get().getFloodgateSurvey().getCampaignId(),t);e()})}},{"./../../Configuration/Configuration":47,"./../../Constants":48,"./../Renderer":83,"./../Utils":89,"./Events":85,"./Layout":86}],88:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./BellyBand/BellyBand");n.createBellyBandMulti=r.createMulti;var i=e("./BellyBand/BellyBand");n.createBellyBandSingle=i.createSingle;var s=e("./Toast/Toast");n.createSurvey=s.createSurvey},{"./BellyBand/BellyBand":72,"./Toast/Toast":87}],89:[function(e,t,n){"use strict";n.__esModule=!0;var r=e("./../Constants");n.setElementVisibility=function(e,t){o(e,t?r.Classes.Hidden:r.Classes.Visible,t?r.Classes.Visible:r.Classes.Hidden)};n.deleteElementById=function(e){var t=document.getElementById(e);null!=t&&null!=t.parentNode&&t.parentNode.removeChild(t)};function i(e,t){var n=document.getElementById(e);n&&(n.className.match(new RegExp("\\b"+t+"\\b"))||(n.className=n.className+" "+t))}n.addClassById=i;function s(e,t){var n=document.getElementById(e);if(n){n.className=n.className.split(new RegExp("\\b"+t+"\\b","i")).join(" ");n.className=n.className.split(/\s+/).join(" ")}}n.deleteClassById=s;function o(e,t,n){s(e,t);i(e,n)}n.replaceClassesById=o;n.setAttributeOnHtmlElement=function(e,t,n){var r=document.getElementById(e);r&&r.setAttribute(t,n)};function u(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)}n.addEventListenerHelper=u;function a(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)}n.removeEventListenerHelper=a;n.registerListener=function(e,t,n){var r=document.getElementById(e);r&&u(r,t,n)};n.registerListenerToElement=function(e,t,n){e&&u(e,t,n)};n.unregisterListener=function(e,t,n){var r=document.getElementById(e);r&&a(r,t,n)};n.getInternetExplorerVersion=function(){var e=-1,t=window.navigator.userAgent;if(t.indexOf("Trident")>-1){if(null!=new RegExp("Trident/([0-9]{1,}[.0-9]{0,})").exec(t)){e=parseFloat(RegExp.$1);e+=4}}return e};n.isRightToLeft=function(){return"rtl"===getComputedStyle(document.documentElement).direction}},{"./../Constants":48}],90:[function(e,t,n){"use strict";n.__esModule=!0;n.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function r(e){return"string"==typeof e}function i(e){return"boolean"==typeof e}n.isBoolean=i;n.expectObject=function(e,t){if(!(function(e){return!(function(e){return null==e})(e)&&"object"==typeof e})(e))throw t+" is not an object: "+e};n.expectNumber=function(e,t){if(!(function(e){return"number"==typeof e})(e))throw t+" is not a number: "+e};n.expectString=function(e,t){if(!r(e))throw t+" is not a string: "+e};n.expectBoolean=function(e,t){if(!i(e))throw t+" is not a boolean: "+e};n.expectGuid=function(e,t){if(!(function(e){return r(e)&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(e)})(e))throw t+" is not a guid: "+e};n.expectArray=function(e,t){if(!Array.isArray(e))throw t+" is not an array: "+e};n.guid=function(){return(s()+s()+"-"+s()+"-4"+s().substr(0,3)+"-"+s()+"-"+s()+s()+s()).toLowerCase()};function s(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}n.overrideValues=function(e,t){if(!t)return t;var n=t;if(e)for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n}},{}],91:[function(e,t,n){"use strict";n.__esModule=!0;n.default="1.3.1"},{}],92:[function(e,t,n){"use strict";n.__esModule=!0;n.isNarrow=function(){return!window.innerWidth||window.innerWidth<800}},{}],93:[function(e,t,n){"use strict";n.__esModule=!0;n.get=function(){return window};n.setSetUiStrings=function(e){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{};window.OfficeBrowserFeedback.setUiStrings=e};n.setSingleFeedback=function(e){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{};window.OfficeBrowserFeedback.singleFeedback=e};n.setMultiFeedback=function(e){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{};window.OfficeBrowserFeedback.multiFeedback=e};n.setFloodgateShowSurvey=function(e){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{};window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{};window.OfficeBrowserFeedback.floodgate.showSurvey=e};n.setFloodgateShowCustomSurvey=function(e){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{};window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{};window.OfficeBrowserFeedback.floodgate.showCustomSurvey=e};n.setFloodgateInitialize=function(e){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{};window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{};window.OfficeBrowserFeedback.floodgate.initialize=e};n.setFloodgateStart=function(e){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{};window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{};window.OfficeBrowserFeedback.floodgate.start=e};n.setFloodgateStop=function(e){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{};window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{};window.OfficeBrowserFeedback.floodgate.stop=e};n.setFloodgateGetEngine=function(e){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{};window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{};window.OfficeBrowserFeedback.floodgate.getEngine=e};n.getSettingIdMap=function(e){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{};window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{};window.OfficeBrowserFeedback.floodgate.getSettingIdMap=e}},{}],94:[function(e,t,n){(function(e,o){if("object"==typeof n&&"object"==typeof t)t.exports=o();else{i=[],void 0!==(s="function"==typeof(r=o)?r.apply(n,i):r)&&(t.exports=s)}})(0,function(){return(function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};e[r].call(i.exports,i,i.exports,n);i.l=!0;return i.exports}n.m=e;n.c=t;n.i=function(e){return e};n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})};n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};n.d(t,"a",t);return t};n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};n.p="";return n(n.s=15)})([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(e){this.low=0;this.high=0;this.low=parseInt(e,10);this.low<0&&(this.high=-1)}e.prototype.Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high};return e})();t.Int64=r;var i=(function(){function e(e){this.low=0;this.high=0;this.low=parseInt(e,10)}e.prototype.Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high};return e})();t.UInt64=i;var s=(function(){function e(){}e.ToByte=function(e){return this.ToUInt8(e)};e.ToInt16=function(e){return 32767&e|(32768&e)<<16>>16};e.ToInt32=function(e){return 2147483647&e|2147483648&e};e.ToUInt8=function(e){return 255&e};e.ToUInt32=function(e){return 4294967295&e};return e})();t.Number=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.NotSet=0]="NotSet";e[e.DistinguishedName=1]="DistinguishedName";e[e.GenericData=2]="GenericData";e[e.IPV4Address=3]="IPV4Address";e[e.IPv6Address=4]="IPv6Address";e[e.MailSubject=5]="MailSubject";e[e.PhoneNumber=6]="PhoneNumber";e[e.QueryString=7]="QueryString";e[e.SipAddress=8]="SipAddress";e[e.SmtpAddress=9]="SmtpAddress";e[e.Identity=10]="Identity";e[e.Uri=11]="Uri";e[e.Fqdn=12]="Fqdn";e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"})(t.AWTPiiKind||(t.AWTPiiKind={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9),i=n(1),s=n(3),o=(function(){function e(){}e.getPayloadBlob=function(e,t){var n=new r.IO.MemoryStream,i=new r.CompactBinaryProtocolWriter(n);i.WriteFieldBegin(r.BondDataType.BT_MAP,3);i.WriteMapContainerBegin(t,r.BondDataType.BT_STRING,r.BondDataType.BT_LIST);Object.keys(e).forEach(function(t){i.WriteString(t);var n=e[t];i.WriteContainerBegin(1,r.BondDataType.BT_STRUCT);i.WriteFieldBegin(r.BondDataType.BT_STRING,2);i.WriteString("act_default_source");i.WriteFieldBegin(r.BondDataType.BT_STRING,5);i.WriteString(s.newGuid());i.WriteFieldBegin(r.BondDataType.BT_INT64,6);i.WriteInt64(s.numberToBondInt64(Date.now()));i.WriteFieldBegin(r.BondDataType.BT_LIST,8);i.WriteContainerBegin(n.length,r.BondDataType.BT_STRUCT);for(var o=0;o<n.length;++o)i.WriteBlob(n[o]);i.WriteStructEnd(!1)});i.WriteStructEnd(!1);return n.GetBuffer()};e.getEventBlob=function(e){var t=new r.IO.MemoryStream,n=new r.CompactBinaryProtocolWriter(t);n.WriteFieldBegin(r.BondDataType.BT_STRING,1);n.WriteString(e.id);n.WriteFieldBegin(r.BondDataType.BT_INT64,3);n.WriteInt64(s.numberToBondInt64(e.timestamp));n.WriteFieldBegin(r.BondDataType.BT_STRING,5);n.WriteString(e.type);n.WriteFieldBegin(r.BondDataType.BT_STRING,6);n.WriteString(e.name);var o=[],u=[];Object.keys(e.properties).forEach(function(t){e.properties[t].pii===i.AWTPiiKind.NotSet?o.push(t):u.push(t)});if(o.length){n.WriteFieldBegin(r.BondDataType.BT_MAP,13);n.WriteMapContainerBegin(o.length,r.BondDataType.BT_STRING,r.BondDataType.BT_STRING);o.forEach(function(t){n.WriteString(t);n.WriteString(e.properties[t].value)})}if(u.length){n.WriteFieldBegin(r.BondDataType.BT_MAP,30);n.WriteMapContainerBegin(u.length,r.BondDataType.BT_STRING,r.BondDataType.BT_STRUCT);u.forEach(function(t){n.WriteString(t);n.WriteFieldBegin(r.BondDataType.BT_INT32,1);n.WriteInt32(1);n.WriteFieldBegin(r.BondDataType.BT_INT32,2);n.WriteInt32(e.properties[t].pii);n.WriteFieldBegin(r.BondDataType.BT_STRING,3);n.WriteString(e.properties[t].value);n.WriteStructEnd(!1)})}n.WriteStructEnd(!1);return t.GetBuffer()};e.base64Encode=function(e){return r.Encoding.Base64.GetString(e)};return e})();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=/[xy]/g;t.numberToBondInt64=function(e){var t=new r.Int64("0");t.low=4294967295&e;t.high=Math.floor(e/4294967296);return t};t.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(i,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})};t.isPii=function(e){return!isNaN(e)&&null!==e&&e>=0&&e<=13}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Version="1.2.2";t.FullVersionString="AWT-Web-CJS-"+t.Version},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);t.AWTPiiKind=r.AWTPiiKind;var i=n(13);t.AWT=i.default;t.AWT_COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/";t.AWT_COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/";t.AWT_COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/";t.AWT_COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/";t.AWT_COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.BT_STOP=0]="BT_STOP";e[e.BT_STOP_BASE=1]="BT_STOP_BASE";e[e.BT_UINT8=3]="BT_UINT8";e[e.BT_UINT32=5]="BT_UINT32";e[e.BT_UINT64=6]="BT_UINT64";e[e.BT_STRING=9]="BT_STRING";e[e.BT_STRUCT=10]="BT_STRUCT";e[e.BT_LIST=11]="BT_LIST";e[e.BT_MAP=13]="BT_MAP";e[e.BT_INT32=16]="BT_INT32";e[e.BT_INT64=17]="BT_INT64";e[e.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"})(t.BondDataType||(t.BondDataType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=(function(){function e(){}e.GetBytes=function(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);if(r<128)t.push(r);else if(r<2048)t.push(192|r>>6,128|63&r);else if(r<55296||r>=57344)t.push(224|r>>12,128|r>>6&63,128|63&r);else{r=65536+((1023&r)<<10|1023&e.charCodeAt(++n));t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}}return t};return e})();t.Utf8=i;var s=(function(){function e(){}e.GetString=function(e){for(var t,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[],i=e.length%3,s=0,o=e.length-i;s<o;s+=3){var u=(e[s]<<16)+(e[s+1]<<8)+e[s+2];r.push([n.charAt((t=u)>>18&63),n.charAt(t>>12&63),n.charAt(t>>6&63),n.charAt(63&t)].join(""))}switch(i){case 1:u=e[e.length-1];r.push(n.charAt(u>>2));r.push(n.charAt(u<<4&63));r.push("==");break;case 2:var a=(e[e.length-2]<<8)+e[e.length-1];r.push(n.charAt(a>>10));r.push(n.charAt(a>>4&63));r.push(n.charAt(a<<2&63));r.push("=")}return r.join("")};return e})();t.Base64=s;var o=(function(){function e(){}e.GetBytes=function(e){for(var t=[];4294967168&e;){t.push(127&e|128);e>>>=7}t.push(127&e);return t};return e})();t.Varint=o;var u=(function(){function e(){}e.GetBytes=function(e){for(var t=e.low,n=e.high,r=[];n||4294967168&t;){r.push(127&t|128);t=(127&n)<<25|t>>>7;n>>>=7}r.push(127&t);return r};return e})();t.Varint64=u;var a=(function(){function e(){}e.EncodeZigzag32=function(e){return(e=r.Number.ToInt32(e))<<1^e>>31};e.EncodeZigzag64=function(e){var t=e.low,n=e.high,i=n<<1|t>>>31,s=t<<1;if(2147483648&n){i=~i;s=~s}var o=new r.UInt64("0");o.low=s;o.high=i;return o};return e})();t.Zigzag=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=(function(){function e(){this._buffer=[]}e.prototype.WriteByte=function(e){this._buffer.push(r.Number.ToByte(e))};e.prototype.Write=function(e,t,n){for(;n--;)this.WriteByte(e[t++])};e.prototype.GetBuffer=function(){return this._buffer};return e})();t.MemoryStream=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);t.BondDataType=r.BondDataType;var i=n(7);t.Encoding=i;var s=n(8);t.IO=s;var o=n(0);t.Int64=o.Int64;t.UInt64=o.UInt64;t.Number=o.Number;var u=(function(){function e(e){this._stream=e}e.prototype.WriteBlob=function(e){this._stream.Write(e,0,e.length)};e.prototype.WriteContainerBegin=function(e,t){this.WriteUInt8(t);this.WriteUInt32(e)};e.prototype.WriteMapContainerBegin=function(e,t,n){this.WriteUInt8(t);this.WriteUInt8(n);this.WriteUInt32(e)};e.prototype.WriteFieldBegin=function(e,t){if(t<=5)this._stream.WriteByte(e|t<<5);else if(t<=255){this._stream.WriteByte(192|e);this._stream.WriteByte(t)}else{this._stream.WriteByte(224|e);this._stream.WriteByte(t);this._stream.WriteByte(t>>8)}};e.prototype.WriteInt32=function(e){e=i.Zigzag.EncodeZigzag32(e);this.WriteUInt32(e)};e.prototype.WriteInt64=function(e){this.WriteUInt64(i.Zigzag.EncodeZigzag64(e))};e.prototype.WriteString=function(e){if(""===e)this.WriteUInt32(0);else{var t=i.Utf8.GetBytes(e);this.WriteUInt32(t.length);this._stream.Write(t,0,t.length)}};e.prototype.WriteStructEnd=function(e){this.WriteUInt8(e?r.BondDataType.BT_STOP_BASE:r.BondDataType.BT_STOP)};e.prototype.WriteUInt32=function(e){var t=i.Varint.GetBytes(o.Number.ToUInt32(e));this._stream.Write(t,0,t.length)};e.prototype.WriteUInt64=function(e){var t=i.Varint64.GetBytes(e);this._stream.Write(t,0,t.length)};e.prototype.WriteUInt8=function(e){this._stream.WriteByte(o.Number.ToUInt8(e))};return e})();t.CompactBinaryProtocolWriter=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){this._killedTokenDictionary={}}e.prototype.setKillSwitchTenants=function(e,t){var n=this;if(e&&t)try{var r=e.split(",");if("this-request-only"===t)return r;var i=1e3*parseInt(t,10);r.forEach(function(e){n._killedTokenDictionary[e]=Date.now()+i})}catch(e){return[]}return[]};e.prototype.isTenantKilled=function(e){if(void 0!==this._killedTokenDictionary[e]&&this._killedTokenDictionary[e]>Date.now())return!0;delete this._killedTokenDictionary[e];return!1};return e})();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=(function(){function e(e,t){this._maxRequestSize=e;this._outboundQueue=t;this._currentBatch={};this._currentBatchSize=0}e.prototype.addEventToBatch=function(e){var t=r.default.getEventBlob(e);if(!(t.length>this._maxRequestSize))if(this._currentBatchSize+t.length>this._maxRequestSize)this.flushBatch();else{void 0===this._currentBatch[e.tenantToken]&&(this._currentBatch[e.tenantToken]=[]);this._currentBatch[e.tenantToken].push(t);this._currentBatchSize+=t.length}};e.prototype.flushBatch=function(){if(this._currentBatchSize>0){this._outboundQueue.push(this._currentBatch);this._currentBatch={};this._currentBatchSize=0}};return e})();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){}e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e||501===e||505===e)};e.getMillisToBackoffForRetry=function(e){var t,n=Math.floor(1200*Math.random())+2400;t=Math.pow(4,e)*n;return Math.min(t,12e4)};return e})();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(14),s=n(3),o=n(4),u=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,a=/\./g,f=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,l=(function(){function e(){}e.initialize=function(e,t){void 0===t&&(t={});if(this._isInitialized)throw"Already Initialized";this._defaultTenantToken=e;this._overrideValuesFromConfig(t);i.default.initialize(this._config);this._isInitialized=!0};e.flush=function(e){this._isInitialized&&!this._isDestroyed&&i.default.flush(e)};e.flushAndTeardown=function(){if(this._isInitialized&&!this._isDestroyed){this._isDestroyed=!0;i.default.flushAndTeardown()}};e.setContext=function(e,t,n){void 0===n&&(n="allTkns");if(null!==(t=this._sanitizeProperty(e,t))){this._contextProperties[n]||(this._contextProperties[n]={});this._contextProperties[n][e]=t}};e.logEvent=function(e){var t=this;if(this._isInitialized){if(!e.name||!e.properties)return;e.name=e.name.toLowerCase();e.name.replace(a,"_");var n="";if(e.type){e.type.toLowerCase();n="custom."}else e.type="custom";if(!u.test(e.name)||!u.test(e.type))return;e.type=n+e.type;isNaN(e.timestamp)&&(e.timestamp=(new Date).getTime());e.tenantToken||(e.tenantToken=this._defaultTenantToken);e.id=s.newGuid();Object.keys(e.properties).forEach(function(n){e.properties[n]=t._sanitizeProperty(n,e.properties[n]);null===e.properties[n]&&delete e.properties[n]});this._addContextIfAbsent(e,e.tenantToken);this._addContextIfAbsent(e,"allTkns");if(0===Object.keys(e.properties).length)return;this._setDefaultProperty(e,"EventInfo.InitId",this._getInitId(e.tenantToken));this._setDefaultProperty(e,"EventInfo.Sequence",this._getSequenceId(e.tenantToken));this._setDefaultProperty(e,"EventInfo.SdkVersion",o.FullVersionString);this._setDefaultProperty(e,"EventInfo.Name",e.name);this._setDefaultProperty(e,"EventInfo.Time",new Date(e.timestamp).toISOString());i.default.sendEvent(e)}};e._overrideValuesFromConfig=function(e){e.collectorUrl&&(this._config.collectorUrl=e.collectorUrl);e.sendingTimer>1e3&&(this._config.sendingTimer=e.sendingTimer)};e._getInitId=function(e){void 0===this._initIdMap[e]&&(this._initIdMap[e]=s.newGuid());return this._initIdMap[e]};e._getSequenceId=function(e){void 0===this._sequenceIdMap[e]&&(this._sequenceIdMap[e]=0);return(++this._sequenceIdMap[e]).toString()};e._setDefaultProperty=function(e,t,n){e.properties[t]={value:n,pii:r.AWTPiiKind.NotSet}};e._addContextIfAbsent=function(e,t){if(this._contextProperties[t]){var n=this._contextProperties[t];Object.keys(n).forEach(function(t){e.properties[t]||(e.properties[t]=n[t])})}};e._sanitizeProperty=function(e,t){"string"!=typeof t&&"number"!=typeof t&&"boolean"!=typeof t||(t={value:t});if(!f.test(e)||null==t||null===t.value||void 0===t.value||""===t.value)return null;void 0===t.pii&&(t.pii=r.AWTPiiKind.NotSet);t.value=t.value.toString();return s.isPii(t.pii)?t:null};e._isInitialized=!1;e._isDestroyed=!1;e._contextProperties={};e._sequenceIdMap={};e._initIdMap={};e._config={collectorUrl:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",sendingTimer:1e3};return e})();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),i=n(2),s=n(12),o=n(10),u=n(4),a=(function(){function e(){}e.initialize=function(e){this._inboundQueues.push([]);this._recordBatcher=new r.default(2936012,this._outboundQueue);this._newEventsAllowed=!0;"undefined"==typeof Uint8Array&&(this._urlString+="&content-encoding=base64");this._sendingTimer=e.sendingTimer;this._urlString=e.collectorUrl+this._urlString+"&x-apikey="};e.sendEvent=function(e){var t=this;if(this._newEventsAllowed){this._inboundQueues[this._inboundQueues.length-1].push(e);!this._running&&this._timeout<0&&!this._isCurrentlyFlushing&&(this._timeout=setTimeout(function(){return t._batchAndSendEvents(!1)},this._sendingTimer))}};e.flushAndTeardown=function(){this._newEventsAllowed=!1;this._batchAndSendEvents(!0)};e.flush=function(e){this._inboundQueues.push([]);if(this._isCurrentlyFlushing)this._flushQueue.push(e);else{this._isCurrentlyFlushing=!0;this._flush(e)}};e._batchAndSendEvents=function(e){this._running=!0;for(;this._inboundQueues[0].length>0&&this._outboundQueue.length<1;)this._recordBatcher.addEventToBatch(this._inboundQueues[0].pop());0===this._outboundQueue.length&&this._recordBatcher.flushBatch();this._sendRequest(this._outboundQueue.pop(),0,e)};e._retryRequestIfNeeded=function(e,t,n,r,i){var o=this,u=!0;if(e&&void 0!==e.status){this._killSwitch.setKillSwitchTenants(e.getResponseHeader("kill-tokens"),e.getResponseHeader("kill-duration-seconds")).forEach(function(e){delete t[e];n--});(!s.default.shouldRetryForStatus(e.status)||n<=0)&&(u=!1)}u&&i<4?setTimeout(function(){return o._sendRequest(t,i+1,!1)},s.default.getMillisToBackoffForRetry(i)):this._handleRequestFinished(null)};e._sendRequest=function(e,t,n){var r=this;try{var s=new XMLHttpRequest,o=0,u="";Object.keys(e).forEach(function(t){if(r._killSwitch.isTenantKilled(t))delete e[t];else{u.length>0&&(u+=",");u+=t;o++}});s.open("POST",this._urlString+u,!n);if(!n){s.ontimeout=function(){r._retryRequestIfNeeded(s,e,o,u,t)};s.onerror=function(){r._retryRequestIfNeeded(s,e,o,u,t)};s.onload=function(){r._handleRequestFinished(s)}}if(o>0){var a=i.default.getPayloadBlob(e,o);"undefined"==typeof Uint8Array?s.send(i.default.base64Encode(a)):s.send(new Uint8Array(a))}else n&&this._handleRequestFinished(null)}catch(e){this._handleRequestFinished(null)}};e._handleRequestFinished=function(e){var t=this;e&&this._killSwitch.setKillSwitchTenants(e.getResponseHeader("kill-tokens"),e.getResponseHeader("kill-duration-seconds"));if(this._inboundQueues[0].length>0)this._timeout=setTimeout(function(){return t._batchAndSendEvents(!1)},this._sendingTimer);else{this._timeout=-1;this._running=!1}};e._flush=function(e){var t=this;if(!this._running){if(this._timeout>-1){clearTimeout(this._timeout);this._timeout=-1}this._inboundQueues[0].length>0&&this._batchAndSendEvents(!1)}this._checkPrimaryInboundQueueEmpty(function(){t._inboundQueues.shift();null!=e&&e();if(t._flushQueue.length>0)setTimeout(function(){return t._flush(t._flushQueue.shift())},t._sendingTimer);else{t._isCurrentlyFlushing=!1;t._inboundQueues[0].length>0&&(t._timeout=setTimeout(function(){return t._batchAndSendEvents(!1)},t._sendingTimer))}})};e._checkPrimaryInboundQueueEmpty=function(e){var t=this;0===this._inboundQueues[0].length?this._checkOutboundQueueEmptyAndSent(e):setTimeout(function(){return t._checkPrimaryInboundQueueEmpty(e)},250)};e._checkOutboundQueueEmptyAndSent=function(e){var t=this;this._running?setTimeout(function(){return t._checkOutboundQueueEmptyAndSent(e)},250):e()};e._outboundQueue=[];e._inboundQueues=[];e._newEventsAllowed=!1;e._killSwitch=new o.default;e._isCurrentlyFlushing=!1;e._flushQueue=[];e._running=!1;e._timeout=-1;e._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version="+u.FullVersionString;return e})();t.default=a},function(e,t,n){e.exports=n(5)}])})},{}],95:[function(t,n,r){(function(e){var n=t("es6-promise").Promise;window.OfficeBrowserFeedback.html2canvas=function(){return(function e(n,r,i){function s(u,a){if(!r[u]){if(!n[u]){var f="function"==typeof t&&t;if(!a&&f)return f(u,!0);if(o)return o(u,!0);var l=new Error("Cannot find module '"+u+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[u]={exports:{}};n[u][0].call(c.exports,function(e){var t=n[u][1][e];return s(t||e)},c,c.exports,e,n,r,i)}return r[u].exports}for(var o="function"==typeof t&&t,u=0;u<i.length;u++)s(i[u]);return s})({1:[function(t,n,r){(function(e){(function(t){var i="object"==typeof r&&r,s="object"==typeof n&&n&&n.exports==i&&n,o="object"==typeof e&&e;o.global!==o&&o.window!==o||(t=o);var u,a,f=2147483647,l=36,c=1,h=26,p=38,d=700,v=72,m=128,g="-",y=/^xn--/,b=/[^ -~]/,w=/\x2E|\u3002|\uFF0E|\uFF61/g,E={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},S=l-c,x=Math.floor,T=String.fromCharCode;function N(e){throw RangeError(E[e])}function C(e,t){for(var n=e.length;n--;)e[n]=t(e[n]);return e}function k(e,t){return C(e.split(w),t).join(".")}function L(e){for(var t,n,r=[],i=0,s=e.length;i<s;)if((t=e.charCodeAt(i++))>=55296&&t<=56319&&i<s)if(56320==(64512&(n=e.charCodeAt(i++))))r.push(((1023&t)<<10)+(1023&n)+65536);else{r.push(t);i--}else r.push(t);return r}function A(e){return C(e,function(e){var t="";if(e>65535){t+=T((e-=65536)>>>10&1023|55296);e=56320|1023&e}return t+=T(e)}).join("")}function O(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function M(e,t,n){var r=0;e=n?x(e/d):e>>1;e+=x(e/t);for(;e>S*h>>1;r+=l)e=x(e/S);return x(r+(S+1)*e/(e+p))}function _(e){var t,n,r,i,s,o,u,a,p,d,y,b=[],w=e.length,E=0,S=m,T=v;(n=e.lastIndexOf(g))<0&&(n=0);for(r=0;r<n;++r){e.charCodeAt(r)>=128&&N("not-basic");b.push(e.charCodeAt(r))}for(i=n>0?n+1:0;i<w;){for(s=E,o=1,u=l;;u+=l){i>=w&&N("invalid-input");((a=(y=e.charCodeAt(i++))-48<10?y-22:y-65<26?y-65:y-97<26?y-97:l)>=l||a>x((f-E)/o))&&N("overflow");E+=a*o;if(a<(p=u<=T?c:u>=T+h?h:u-T))break;o>x(f/(d=l-p))&&N("overflow");o*=d}T=M(E-s,t=b.length+1,0==s);x(E/t)>f-S&&N("overflow");S+=x(E/t);E%=t;b.splice(E++,0,S)}return A(b)}function D(e){var t,n,r,i,s,o,u,a,p,d,y,b,w,E,S,C=[];b=(e=L(e)).length;t=m;n=0;s=v;for(o=0;o<b;++o)(y=e[o])<128&&C.push(T(y));r=i=C.length;i&&C.push(g);for(;r<b;){for(u=f,o=0;o<b;++o)(y=e[o])>=t&&y<u&&(u=y);u-t>x((f-n)/(w=r+1))&&N("overflow");n+=(u-t)*w;t=u;for(o=0;o<b;++o){(y=e[o])<t&&++n>f&&N("overflow");if(y==t){for(a=n,p=l;!(a<(d=p<=s?c:p>=s+h?h:p-s));p+=l){S=a-d;E=l-d;C.push(T(O(d+S%E,0)));a=x(S/E)}C.push(T(O(a,0)));s=M(n,w,r==i);n=0;++r}}++n;++t}return C.join("")}u={version:"1.2.4",ucs2:{decode:L,encode:A},decode:_,encode:D,toASCII:function(e){return k(e,function(e){return b.test(e)?"xn--"+D(e):e})},toUnicode:function(e){return k(e,function(e){return y.test(e)?_(e.slice(4).toLowerCase()):e})}};if(i&&!i.nodeType)if(s)s.exports=u;else for(a in u)u.hasOwnProperty(a)&&(i[a]=u[a]);else t.punycode=u})(this)}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,r){var i=e("./log");function s(e,t){for(var n=3===e.nodeType?document.createTextNode(e.nodeValue):e.cloneNode(!1),r=e.firstChild;r;){!0!==t&&1===r.nodeType&&"SCRIPT"===r.nodeName||n.appendChild(s(r,t));r=r.nextSibling}if(1===e.nodeType){n._scrollTop=e.scrollTop;n._scrollLeft=e.scrollLeft;"CANVAS"===e.nodeName?(function(e,t){try{if(t){t.width=e.width;t.height=e.height;t.getContext("2d").putImageData(e.getContext("2d").getImageData(0,0,e.width,e.height),0,0)}}catch(t){i("Unable to copy canvas content from",e,t)}})(e,n):"TEXTAREA"!==e.nodeName&&"SELECT"!==e.nodeName||(n.value=e.value)}return n}t.exports=function(e,t,r,i,o,u,a){var f=s(e.documentElement,o.javascriptEnabled),l=t.createElement("iframe");l.className="html2canvas-container";l.style.visibility="hidden";l.style.position="fixed";l.style.left="-10000px";l.style.top="0px";l.style.border="0";l.width=r;l.height=i;l.scrolling="no";t.body.appendChild(l);return new n(function(t){var n=l.contentWindow.document;l.contentWindow.onload=l.onload=function(){var e=setInterval(function(){if(n.body.childNodes.length>0){(function e(t){if(1===t.nodeType){t.scrollTop=t._scrollTop;t.scrollLeft=t._scrollLeft;for(var n=t.firstChild;n;){e(n);n=n.nextSibling}}})(n.documentElement);clearInterval(e);if("view"===o.type){l.contentWindow.scrollTo(u,a);if(/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(l.contentWindow.scrollY!==a||l.contentWindow.scrollX!==u)){n.documentElement.style.top=-a+"px";n.documentElement.style.left=-u+"px";n.documentElement.style.position="absolute"}}t(l)}},50)};n.open();n.write("<!DOCTYPE html><html></html>");(function(e,t,n){!e.defaultView||t===e.defaultView.pageXOffset&&n===e.defaultView.pageYOffset||e.defaultView.scrollTo(t,n)})(e,u,a);n.replaceChild(n.adoptNode(f),n.documentElement);n.close()})}},{"./log":13}],3:[function(e,t,n){function r(e){this.r=0;this.g=0;this.b=0;this.a=null;this.fromArray(e)||this.namedColor(e)||this.rgb(e)||this.rgba(e)||this.hex6(e)||this.hex3(e)}r.prototype.darken=function(e){var t=1-e;return new r([Math.round(this.r*t),Math.round(this.g*t),Math.round(this.b*t),this.a])};r.prototype.isTransparent=function(){return 0===this.a};r.prototype.isBlack=function(){return 0===this.r&&0===this.g&&0===this.b};r.prototype.fromArray=function(e){if(Array.isArray(e)){this.r=Math.min(e[0],255);this.g=Math.min(e[1],255);this.b=Math.min(e[2],255);e.length>3&&(this.a=e[3])}return Array.isArray(e)};var i=/^#([a-f0-9]{3})$/i;r.prototype.hex3=function(e){var t;if(null!==(t=e.match(i))){this.r=parseInt(t[1][0]+t[1][0],16);this.g=parseInt(t[1][1]+t[1][1],16);this.b=parseInt(t[1][2]+t[1][2],16)}return null!==t};var s=/^#([a-f0-9]{6})$/i;r.prototype.hex6=function(e){var t=null;if(null!==(t=e.match(s))){this.r=parseInt(t[1].substring(0,2),16);this.g=parseInt(t[1].substring(2,4),16);this.b=parseInt(t[1].substring(4,6),16)}return null!==t};var o=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/;r.prototype.rgb=function(e){var t;if(null!==(t=e.match(o))){this.r=Number(t[1]);this.g=Number(t[2]);this.b=Number(t[3])}return null!==t};var u=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/;r.prototype.rgba=function(e){var t;if(null!==(t=e.match(u))){this.r=Number(t[1]);this.g=Number(t[2]);this.b=Number(t[3]);this.a=Number(t[4])}return null!==t};r.prototype.toString=function(){return null!==this.a&&1!==this.a?"rgba("+[this.r,this.g,this.b,this.a].join(",")+")":"rgb("+[this.r,this.g,this.b].join(",")+")"};r.prototype.namedColor=function(e){e=e.toLowerCase();var t=a[e];if(t){this.r=t[0];this.g=t[1];this.b=t[2]}else if("transparent"===e){this.r=this.g=this.b=this.a=0;return!0}return!!t};r.prototype.isColor=!0;var a={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};t.exports=r},{}],4:[function(e,t,r){var i=e("./support"),s=e("./renderers/canvas"),o=e("./imageloader"),u=e("./nodeparser"),a=e("./nodecontainer"),f=e("./log"),l=e("./utils"),c=e("./clone"),h=e("./proxy").loadUrlDocument,p=l.getBounds,d="data-html2canvas-node",v=0;function m(e,t){var r=v++;if((t=t||{}).logging){f.options.logging=!0;f.options.start=Date.now()}t.async=void 0===t.async||t.async;t.allowTaint=void 0!==t.allowTaint&&t.allowTaint;t.removeContainer=void 0===t.removeContainer||t.removeContainer;t.javascriptEnabled=void 0!==t.javascriptEnabled&&t.javascriptEnabled;t.imageTimeout=void 0===t.imageTimeout?1e4:t.imageTimeout;t.renderer="function"==typeof t.renderer?t.renderer:s;t.strict=!!t.strict;if("string"==typeof e){if("string"!=typeof t.proxy)return n.reject("Proxy must be used when rendering url");var i=null!=t.width?t.width:window.innerWidth,o=null!=t.height?t.height:window.innerHeight;return h((function(e){var t=document.createElement("a");t.href=e;t.href=t.href;return t})(e),t.proxy,document,i,o,t).then(function(e){return y(e.contentWindow.document.documentElement,e,t,i,o)})}var u=(void 0===e?[document.documentElement]:e.length?e:[e])[0];u.setAttribute(d+r,r);return(function(e,t,r,i,s){return c(e,e,r,i,t,e.defaultView.pageXOffset,e.defaultView.pageYOffset).then(function(o){f("Document cloned");var u=d+s,a="["+u+"='"+s+"']";e.querySelector(a).removeAttribute(u);var l=o.contentWindow,c=l.document.querySelector(a);return("function"==typeof t.onclone?n.resolve(t.onclone(l.document)):n.resolve(!0)).then(function(){return y(c,o,t,r,i)})})})(u.ownerDocument,t,u.ownerDocument.defaultView.innerWidth,u.ownerDocument.defaultView.innerHeight,r).then(function(e){if("function"==typeof t.onrendered){f("options.onrendered is deprecated, html2canvas returns a Promise containing the canvas");t.onrendered(e)}return e})}m.CanvasRenderer=s;m.NodeContainer=a;m.log=f;m.utils=l;var g="undefined"==typeof document||"function"!=typeof Object.create||"function"!=typeof document.createElement("canvas").getContext?function(){return n.reject("No canvas support")}:m;t.exports=g;function y(e,t,n,r,s){var a,l=t.contentWindow,c=new i(l.document),h=new o(n,c),d=p(e),v="view"===n.type?r:(a=l.document,Math.max(Math.max(a.body.scrollWidth,a.documentElement.scrollWidth),Math.max(a.body.offsetWidth,a.documentElement.offsetWidth),Math.max(a.body.clientWidth,a.documentElement.clientWidth))),m="view"===n.type?s:(function(e){return Math.max(Math.max(e.body.scrollHeight,e.documentElement.scrollHeight),Math.max(e.body.offsetHeight,e.documentElement.offsetHeight),Math.max(e.body.clientHeight,e.documentElement.clientHeight))})(l.document),g=new n.renderer(v,m,h,n,document);return new u(e,g,c,h,n).ready.then(function(){f("Finished rendering");var r;r="view"===n.type?b(g.canvas,{width:g.canvas.width,height:g.canvas.height,top:0,left:0,x:0,y:0}):e===l.document.body||e===l.document.documentElement||null!=n.canvas?g.canvas:b(g.canvas,{width:null!=n.width?n.width:d.width,height:null!=n.height?n.height:d.height,top:d.top,left:d.left,x:0,y:0});(function(e,t){if(t.removeContainer){e.parentNode.removeChild(e);f("Cleaned up container")}})(t,n);return r})}function b(e,t){var n=document.createElement("canvas"),r=Math.min(e.width-1,Math.max(0,t.left)),i=Math.min(e.width,Math.max(1,t.left+t.width)),s=Math.min(e.height-1,Math.max(0,t.top)),o=Math.min(e.height,Math.max(1,t.top+t.height));n.width=t.width;n.height=t.height;var u=i-r,a=o-s;f("Cropping canvas at:","left:",t.left,"top:",t.top,"width:",u,"height:",a);f("Resulting crop with width",t.width,"and height",t.height,"with x",r,"and y",s);n.getContext("2d").drawImage(e,r,s,u,a,t.x,t.y,u,a);return n}},{"./clone":2,"./imageloader":11,"./log":13,"./nodecontainer":14,"./nodeparser":15,"./proxy":16,"./renderers/canvas":20,"./support":22,"./utils":26}],5:[function(e,t,r){var i=e("./log"),s=e("./utils").smallImage;t.exports=function e(t){this.src=t;i("DummyImageContainer for",t);if(!this.promise||!this.image){i("Initiating DummyImageContainer");e.prototype.image=new Image;var r=this.image;e.prototype.promise=new n(function(e,t){r.onload=e;r.onerror=t;r.src=s();!0===r.complete&&e(r)})}}},{"./log":13,"./utils":26}],6:[function(e,t,n){var r=e("./utils").smallImage;t.exports=function(e,t){var n,i,s=document.createElement("div"),o=document.createElement("img"),u=document.createElement("span");s.style.visibility="hidden";s.style.fontFamily=e;s.style.fontSize=t;s.style.margin=0;s.style.padding=0;document.body.appendChild(s);o.src=r();o.width=1;o.height=1;o.style.margin=0;o.style.padding=0;o.style.verticalAlign="baseline";u.style.fontFamily=e;u.style.fontSize=t;u.style.margin=0;u.style.padding=0;u.appendChild(document.createTextNode("Hidden Text"));s.appendChild(u);s.appendChild(o);n=o.offsetTop-u.offsetTop+1;s.removeChild(u);s.appendChild(document.createTextNode("Hidden Text"));s.style.lineHeight="normal";o.style.verticalAlign="super";i=o.offsetTop-s.offsetTop+1;document.body.removeChild(s);this.baseline=n;this.lineWidth=1;this.middle=i}},{"./utils":26}],7:[function(e,t,n){var r=e("./font");function i(){this.data={}}i.prototype.getMetrics=function(e,t){void 0===this.data[e+"-"+t]&&(this.data[e+"-"+t]=new r(e,t));return this.data[e+"-"+t]};t.exports=i},{"./font":6}],8:[function(e,t,r){var i=e("./utils").getBounds,s=e("./proxy").loadUrlDocument;function o(t,r,s){this.image=null;this.src=t;var o=this,u=i(t);this.promise=(r?new n(function(e){"about:blank"===t.contentWindow.document.URL||null==t.contentWindow.document.documentElement?t.contentWindow.onload=t.onload=function(){e(t)}:e(t)}):this.proxyLoad(s.proxy,u,s)).then(function(t){return e("./core")(t.contentWindow.document.documentElement,{type:"view",width:t.width,height:t.height,proxy:s.proxy,javascriptEnabled:s.javascriptEnabled,removeContainer:s.removeContainer,allowTaint:s.allowTaint,imageTimeout:s.imageTimeout/2})}).then(function(e){return o.image=e})}o.prototype.proxyLoad=function(e,t,n){var r=this.src;return s(r.src,e,r.ownerDocument,t.width,t.height,n)};t.exports=o},{"./core":4,"./proxy":16,"./utils":26}],9:[function(e,t,r){function i(e){this.src=e.value;this.colorStops=[];this.type=null;this.x0=.5;this.y0=.5;this.x1=.5;this.y1=.5;this.promise=n.resolve(!0)}i.TYPES={LINEAR:1,RADIAL:2};i.REGEXP_COLORSTOP=/^\s*(rgba?\(\s*\d{1,3},\s*\d{1,3},\s*\d{1,3}(?:,\s*[0-9\.]+)?\s*\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\s+(\d{1,3}(?:\.\d+)?)(%|px)?)?(?:\s|$)/i;t.exports=i},{}],10:[function(e,t,r){t.exports=function(e,t){this.src=e;this.image=new Image;var r=this;this.tainted=null;this.promise=new n(function(n,i){r.image.onload=n;r.image.onerror=i;t&&(r.image.crossOrigin="anonymous");r.image.src=e;!0===r.image.complete&&n(r.image)})}},{}],11:[function(e,t,r){var i=e("./log"),s=e("./imagecontainer"),o=e("./dummyimagecontainer"),u=e("./proxyimagecontainer"),a=e("./framecontainer"),f=e("./svgcontainer"),l=e("./svgnodecontainer"),c=e("./lineargradientcontainer"),h=e("./webkitgradientcontainer"),p=e("./utils").bind;function d(e,t){this.link=null;this.options=e;this.support=t;this.origin=this.getOrigin(window.location.href)}d.prototype.findImages=function(e){var t=[];e.reduce(function(e,t){switch(t.node.nodeName){case"IMG":return e.concat([{args:[t.node.src],method:"url"}]);case"svg":case"IFRAME":return e.concat([{args:[t.node],method:t.node.nodeName}])}return e},[]).forEach(this.addImage(t,this.loadImage),this);return t};d.prototype.findBackgroundImage=function(e,t){t.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(e,this.loadImage),this);return e};d.prototype.addImage=function(e,t){return function(n){n.args.forEach(function(r){if(!this.imageExists(e,r)){e.splice(0,0,t.call(this,n));i("Added image #"+e.length,"string"==typeof r?r.substring(0,100):r)}},this)}};d.prototype.hasImageBackground=function(e){return"none"!==e.method};d.prototype.loadImage=function(e){if("url"===e.method){var t=e.args[0];return!this.isSVG(t)||this.support.svg||this.options.allowTaint?t.match(/data:image\/.*;base64,/i)?new s(t.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),!1):this.isSameOrigin(t)||!0===this.options.allowTaint||this.isSVG(t)?new s(t,!1):this.support.cors&&!this.options.allowTaint&&this.options.useCORS?new s(t,!0):this.options.proxy?new u(t,this.options.proxy):new o(t):new f(t)}return"linear-gradient"===e.method?new c(e):"gradient"===e.method?new h(e):"svg"===e.method?new l(e.args[0],this.support.svg):"IFRAME"===e.method?new a(e.args[0],this.isSameOrigin(e.args[0].src),this.options):new o(e)};d.prototype.isSVG=function(e){return"svg"===e.substring(e.length-3).toLowerCase()||f.prototype.isInline(e)};d.prototype.imageExists=function(e,t){return e.some(function(e){return e.src===t})};d.prototype.isSameOrigin=function(e){return this.getOrigin(e)===this.origin};d.prototype.getOrigin=function(e){var t=this.link||(this.link=document.createElement("a"));t.href=e;t.href=t.href;return t.protocol+t.hostname+t.port};d.prototype.getPromise=function(e){return this.timeout(e,this.options.imageTimeout).catch(function(){return new o(e.src).promise.then(function(t){e.image=t})})};d.prototype.get=function(e){var t=null;return this.images.some(function(n){return(t=n).src===e})?t:null};d.prototype.fetch=function(e){this.images=e.reduce(p(this.findBackgroundImage,this),this.findImages(e));this.images.forEach(function(e,t){e.promise.then(function(){i("Succesfully loaded image #"+(t+1),e)},function(n){i("Failed loading image #"+(t+1),e,n)})});this.ready=n.all(this.images.map(this.getPromise,this));i("Finished searching images");return this};d.prototype.timeout=function(e,t){var r,s=n.race([e.promise,new n(function(n,s){r=setTimeout(function(){i("Timed out loading image",e);s(e)},t)})]).then(function(e){clearTimeout(r);return e});s.catch(function(){clearTimeout(r)});return s};t.exports=d},{"./dummyimagecontainer":5,"./framecontainer":8,"./imagecontainer":10,"./lineargradientcontainer":12,"./log":13,"./proxyimagecontainer":17,"./svgcontainer":23,"./svgnodecontainer":24,"./utils":26,"./webkitgradientcontainer":27}],12:[function(e,t,n){var r=e("./gradientcontainer"),i=e("./color");function s(e){r.apply(this,arguments);this.type=r.TYPES.LINEAR;var t=s.REGEXP_DIRECTION.test(e.args[0])||!r.REGEXP_COLORSTOP.test(e.args[0]);if(t)e.args[0].split(/\s+/).reverse().forEach(function(e,t){switch(e){case"left":this.x0=0;this.x1=1;break;case"top":this.y0=0;this.y1=1;break;case"right":this.x0=1;this.x1=0;break;case"bottom":this.y0=1;this.y1=0;break;case"to":var n=this.y0,r=this.x0;this.y0=this.y1;this.x0=this.x1;this.x1=r;this.y1=n;break;case"center":break;default:var i=.01*parseFloat(e,10);if(isNaN(i))break;if(0===t){this.y0=i;this.y1=1-this.y0}else{this.x0=i;this.x1=1-this.x0}}},this);else{this.y0=0;this.y1=1}this.colorStops=e.args.slice(t?1:0).map(function(e){var t=e.match(r.REGEXP_COLORSTOP),n=+t[2],s=0===n?"%":t[3];return{color:new i(t[1]),stop:"%"===s?n/100:null}});null===this.colorStops[0].stop&&(this.colorStops[0].stop=0);null===this.colorStops[this.colorStops.length-1].stop&&(this.colorStops[this.colorStops.length-1].stop=1);this.colorStops.forEach(function(e,t){null===e.stop&&this.colorStops.slice(t).some(function(n,r){if(null!==n.stop){e.stop=(n.stop-this.colorStops[t-1].stop)/(r+1)+this.colorStops[t-1].stop;return!0}return!1},this)},this)}s.prototype=Object.create(r.prototype);s.REGEXP_DIRECTION=/^\s*(?:to|left|right|top|bottom|center|\d{1,3}(?:\.\d+)?%?)(?:\s|$)/i;t.exports=s},{"./color":3,"./gradientcontainer":9}],13:[function(e,t,n){var r=function(){r.options.logging&&window.console&&window.console.log&&Function.prototype.bind.call(window.console.log,window.console).apply(window.console,[Date.now()-r.options.start+"ms","html2canvas:"].concat([].slice.call(arguments,0)))};r.options={logging:!1};t.exports=r},{}],14:[function(e,t,n){var r=e("./color"),i=e("./utils"),s=i.getBounds,o=i.parseBackgrounds,u=i.offsetBounds;function a(e,t){this.node=e;this.parent=t;this.stack=null;this.bounds=null;this.borders=null;this.clip=[];this.backgroundClip=[];this.offsetBounds=null;this.visible=null;this.computedStyles=null;this.colors={};this.styles={};this.backgroundImages=null;this.transformData=null;this.transformMatrix=null;this.isPseudoElement=!1;this.opacity=null}a.prototype.cloneTo=function(e){e.visible=this.visible;e.borders=this.borders;e.bounds=this.bounds;e.clip=this.clip;e.backgroundClip=this.backgroundClip;e.computedStyles=this.computedStyles;e.styles=this.styles;e.backgroundImages=this.backgroundImages;e.opacity=this.opacity};a.prototype.getOpacity=function(){return null===this.opacity?this.opacity=this.cssFloat("opacity"):this.opacity};a.prototype.assignStack=function(e){this.stack=e;e.children.push(this)};a.prototype.isElementVisible=function(){return this.node.nodeType===Node.TEXT_NODE?this.parent.visible:"none"!==this.css("display")&&"hidden"!==this.css("visibility")&&!this.node.hasAttribute("data-html2canvas-ignore")&&("INPUT"!==this.node.nodeName||"hidden"!==this.node.getAttribute("type"))};a.prototype.css=function(e){this.computedStyles||(this.computedStyles=this.isPseudoElement?this.parent.computedStyle(this.before?":before":":after"):this.computedStyle(null));return this.styles[e]||(this.styles[e]=this.computedStyles[e])};a.prototype.prefixedCss=function(e){var t=this.css(e);void 0===t&&["webkit","moz","ms","o"].some(function(n){return void 0!==(t=this.css(n+e.substr(0,1).toUpperCase()+e.substr(1)))},this);return void 0===t?null:t};a.prototype.computedStyle=function(e){return this.node.ownerDocument.defaultView.getComputedStyle(this.node,e)};a.prototype.cssInt=function(e){var t=parseInt(this.css(e),10);return isNaN(t)?0:t};a.prototype.color=function(e){return this.colors[e]||(this.colors[e]=new r(this.css(e)))};a.prototype.cssFloat=function(e){var t=parseFloat(this.css(e));return isNaN(t)?0:t};a.prototype.fontWeight=function(){var e=this.css("fontWeight");switch(parseInt(e,10)){case 401:e="bold";break;case 400:e="normal"}return e};a.prototype.parseClip=function(){var e=this.css("clip").match(this.CLIP);return e?{top:parseInt(e[1],10),right:parseInt(e[2],10),bottom:parseInt(e[3],10),left:parseInt(e[4],10)}:null};a.prototype.parseBackgroundImages=function(){return this.backgroundImages||(this.backgroundImages=o(this.css("backgroundImage")))};a.prototype.cssList=function(e,t){var n=(this.css(e)||"").split(",");1===(n=(n=n[t||0]||n[0]||"auto").trim().split(" ")).length&&(n=[n[0],f(n[0])?"auto":n[0]]);return n};a.prototype.parseBackgroundSize=function(e,t,n){var r,i,s=this.cssList("backgroundSize",n);if(f(s[0]))r=e.width*parseFloat(s[0])/100;else{if(/contain|cover/.test(s[0])){var o=e.width/e.height,u=t.width/t.height;return o<u^"contain"===s[0]?{width:e.height*u,height:e.height}:{width:e.width,height:e.width/u}}r=parseInt(s[0],10)}i="auto"===s[0]&&"auto"===s[1]?t.height:"auto"===s[1]?r/t.width*t.height:f(s[1])?e.height*parseFloat(s[1])/100:parseInt(s[1],10);"auto"===s[0]&&(r=i/t.height*t.width);return{width:r,height:i}};a.prototype.parseBackgroundPosition=function(e,t,n,r){var i,s,o=this.cssList("backgroundPosition",n);i=f(o[0])?(e.width-(r||t).width)*(parseFloat(o[0])/100):parseInt(o[0],10);s="auto"===o[1]?i/t.width*t.height:f(o[1])?(e.height-(r||t).height)*parseFloat(o[1])/100:parseInt(o[1],10);"auto"===o[0]&&(i=s/t.height*t.width);return{left:i,top:s}};a.prototype.parseBackgroundRepeat=function(e){return this.cssList("backgroundRepeat",e)[0]};a.prototype.parseTextShadows=function(){var e=this.css("textShadow"),t=[];if(e&&"none"!==e)for(var n=e.match(this.TEXT_SHADOW_PROPERTY),i=0;n&&i<n.length;i++){var s=n[i].match(this.TEXT_SHADOW_VALUES);t.push({color:new r(s[0]),offsetX:s[1]?parseFloat(s[1].replace("px","")):0,offsetY:s[2]?parseFloat(s[2].replace("px","")):0,blur:s[3]?s[3].replace("px",""):0})}return t};a.prototype.parseTransform=function(){if(!this.transformData)if(this.hasTransform()){var e=this.parseBounds(),t=this.prefixedCss("transformOrigin").split(" ").map(l).map(c);t[0]+=e.left;t[1]+=e.top;this.transformData={origin:t,matrix:this.parseTransformMatrix()}}else this.transformData={origin:[0,0],matrix:[1,0,0,1,0,0]};return this.transformData};a.prototype.parseTransformMatrix=function(){if(!this.transformMatrix){var e=this.prefixedCss("transform"),t=e?(function(e){if(e&&"matrix"===e[1])return e[2].split(",").map(function(e){return parseFloat(e.trim())});if(e&&"matrix3d"===e[1]){var t=e[2].split(",").map(function(e){return parseFloat(e.trim())});return[t[0],t[1],t[4],t[5],t[12],t[13]]}})(e.match(this.MATRIX_PROPERTY)):null;this.transformMatrix=t||[1,0,0,1,0,0]}return this.transformMatrix};a.prototype.parseBounds=function(){return this.bounds||(this.bounds=this.hasTransform()?u(this.node):s(this.node))};a.prototype.hasTransform=function(){return"1,0,0,1,0,0"!==this.parseTransformMatrix().join(",")||this.parent&&this.parent.hasTransform()};a.prototype.getValue=function(){var e,t,n=this.node.value||"";"SELECT"===this.node.tagName?n=(e=this.node,(t=e.options[e.selectedIndex||0])&&t.text||""):"password"===this.node.type&&(n=Array(n.length+1).join(""));return 0===n.length?this.node.placeholder||"":n};a.prototype.MATRIX_PROPERTY=/(matrix|matrix3d)\((.+)\)/;a.prototype.TEXT_SHADOW_PROPERTY=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g;a.prototype.TEXT_SHADOW_VALUES=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g;a.prototype.CLIP=/^rect\((\d+)px,? (\d+)px,? (\d+)px,? (\d+)px\)$/;function f(e){return-1!==e.toString().indexOf("%")}function l(e){return e.replace("px","")}function c(e){return parseFloat(e)}t.exports=a},{"./color":3,"./utils":26}],15:[function(e,t,r){var i=e("./log"),s=e("punycode"),o=e("./nodecontainer"),u=e("./textcontainer"),a=e("./pseudoelementcontainer"),f=e("./fontmetrics"),l=e("./color"),c=e("./stackingcontext"),h=e("./utils"),p=h.bind,d=h.getBounds,v=h.parseBackgrounds,m=h.offsetBounds;function g(e,t,r,s,u){i("Starting NodeParser");this.renderer=t;this.options=u;this.range=null;this.support=r;this.renderQueue=[];this.stack=new c(!0,1,e.ownerDocument,null);var a=new o(e,null);u.background&&t.rectangle(0,0,t.width,t.height,new l(u.background));if(e===e.ownerDocument.documentElement){var h=new o(a.color("backgroundColor").isTransparent()?e.ownerDocument.body:e.ownerDocument.documentElement,null);t.rectangle(0,0,t.width,t.height,h.color("backgroundColor"))}a.visibile=a.isElementVisible();this.createPseudoHideStyles(e.ownerDocument);this.disableAnimations(e.ownerDocument);this.nodes=z([a].concat(this.getChildren(a)).filter(function(e){return e.visible=e.isElementVisible()}).map(this.getPseudoElements,this));this.fontMetrics=new f;i("Fetched nodes, total:",this.nodes.length);i("Calculate overflow clips");this.calculateOverflowClips();i("Start fetching images");this.images=s.fetch(this.nodes.filter(j));this.ready=this.images.ready.then(p(function(){i("Images loaded, starting parsing");i("Creating stacking contexts");this.createStackingContexts();i("Sorting stacking contexts");this.sortStackingContexts(this.stack);this.parse(this.stack);i("Render queue created with "+this.renderQueue.length+" items");return new n(p(function(e){if(u.async)if("function"==typeof u.async)u.async.call(this,this.renderQueue,e);else if(this.renderQueue.length>0){this.renderIndex=0;this.asyncRenderer(this.renderQueue,e)}else e();else{this.renderQueue.forEach(this.paint,this);e()}},this))},this))}g.prototype.calculateOverflowClips=function(){this.nodes.forEach(function(e){if(j(e)){F(e)&&e.appendToDOM();e.borders=this.parseBorders(e);var t="hidden"===e.css("overflow")?[e.borders.clip]:[],n=e.parseClip();n&&-1!==["absolute","fixed"].indexOf(e.css("position"))&&t.push([["rect",e.bounds.left+n.left,e.bounds.top+n.top,n.right-n.left,n.bottom-n.top]]);e.clip=y(e)?e.parent.clip.concat(t):t;e.backgroundClip="hidden"!==e.css("overflow")?e.clip.concat([e.borders.clip]):e.clip;F(e)&&e.cleanDOM()}else I(e)&&(e.clip=y(e)?e.parent.clip:[]);F(e)||(e.bounds=null)},this)};function y(e){return e.parent&&e.parent.clip.length}g.prototype.asyncRenderer=function(e,t,n){n=n||Date.now();this.paint(e[this.renderIndex++]);e.length===this.renderIndex?t():n+20>Date.now()?this.asyncRenderer(e,t,n):setTimeout(p(function(){this.asyncRenderer(e,t)},this),0)};g.prototype.createPseudoHideStyles=function(e){this.createStyles(e,"."+a.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+':before { content: "" !important; display: none !important; }.'+a.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER+':after { content: "" !important; display: none !important; }')};g.prototype.disableAnimations=function(e){this.createStyles(e,"* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; -webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}")};g.prototype.createStyles=function(e,t){var n=e.createElement("style");n.innerHTML=t;e.body.appendChild(n)};g.prototype.getPseudoElements=function(e){var t=[[e]];if(e.node.nodeType===Node.ELEMENT_NODE){var n=this.getPseudoElement(e,":before"),r=this.getPseudoElement(e,":after");n&&t.push(n);r&&t.push(r)}return z(t)};g.prototype.getPseudoElement=function(e,t){var n=e.computedStyle(t);if(!n||!n.content||"none"===n.content||"-moz-alt-content"===n.content||"none"===n.display)return null;for(var r=(function(e){var t=e.substr(0,1);return t===e.substr(e.length-1)&&t.match(/'|"/)?e.substr(1,e.length-2):e})(n.content),i="url"===r.substr(0,3),s=document.createElement(i?"img":"html2canvaspseudoelement"),o=new a(s,e,t),f=n.length-1;f>=0;f--){var l=n.item(f).replace(/(\-[a-z])/g,function(e){return e.toUpperCase().replace("-","")});s.style[l]=n[l]}s.className=a.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+a.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER;if(i){s.src=v(r)[0].args[0];return[o]}var c=document.createTextNode(r);s.appendChild(c);return[o,new u(c,o)]};g.prototype.getChildren=function(e){return z([].filter.call(e.node.childNodes,D).map(function(t){var n=[t.nodeType===Node.TEXT_NODE?new u(t,e):new o(t,e)].filter(U);return t.nodeType===Node.ELEMENT_NODE&&n.length&&"TEXTAREA"!==t.tagName?n[0].isElementVisible()?n.concat(this.getChildren(n[0])):[]:n},this))};g.prototype.newStackingContext=function(e,t){var n=new c(t,e.getOpacity(),e.node,e.parent);e.cloneTo(n);(t?n.getParentStack(this):n.parent.stack).contexts.push(n);e.stack=n};g.prototype.createStackingContexts=function(){this.nodes.forEach(function(e){j(e)&&(this.isRootElement(e)||(function(e){return e.getOpacity()<1})(e)||(function(e){var t=e.css("position");return"auto"!==(-1!==["absolute","relative","fixed"].indexOf(t)?e.css("zIndex"):"auto")})(e)||this.isBodyWithTransparentRoot(e)||e.hasTransform())?this.newStackingContext(e,!0):j(e)&&(P(e)&&A(e)||(function(e){return-1!==["inline-block","inline-table"].indexOf(e.css("display"))})(e)||H(e))?this.newStackingContext(e,!1):e.assignStack(e.parent.stack)},this)};g.prototype.isBodyWithTransparentRoot=function(e){return"BODY"===e.node.nodeName&&e.parent.color("backgroundColor").isTransparent()};g.prototype.isRootElement=function(e){return null===e.parent};g.prototype.sortStackingContexts=function(e){e.contexts.sort((t=e.contexts.slice(0),function(e,n){return e.cssInt("zIndex")+t.indexOf(e)/t.length-(n.cssInt("zIndex")+t.indexOf(n)/t.length)}));var t;e.contexts.forEach(this.sortStackingContexts,this)};g.prototype.parseTextBounds=function(e){return function(t,n,r){if("none"!==e.parent.css("textDecoration").substr(0,4)||0!==t.trim().length){if(this.support.rangeBounds&&!e.parent.hasTransform()){var i=r.slice(0,n).join("").length;return this.getRangeBounds(e.node,i,t.length)}if(e.node&&"string"==typeof e.node.data){var s=e.node.splitText(t.length),o=this.getWrapperBounds(e.node,e.parent.hasTransform());e.node=s;return o}}else this.support.rangeBounds&&!e.parent.hasTransform()||(e.node=e.node.splitText(t.length));return{}}};g.prototype.getWrapperBounds=function(e,t){var n=e.ownerDocument.createElement("html2canvaswrapper"),r=e.parentNode,i=e.cloneNode(!0);n.appendChild(e.cloneNode(!0));r.replaceChild(n,e);var s=t?m(n):d(n);r.replaceChild(i,n);return s};g.prototype.getRangeBounds=function(e,t,n){var r=this.range||(this.range=e.ownerDocument.createRange());r.setStart(e,t);r.setEnd(e,t+n);return r.getBoundingClientRect()};function b(){}g.prototype.parse=function(e){var t=e.contexts.filter(k),n=e.children.filter(j),r=n.filter(B(H)),i=r.filter(B(P)).filter(B(O)),s=n.filter(B(P)).filter(H),o=r.filter(B(P)).filter(O),u=e.contexts.concat(r.filter(P)).filter(A),a=e.children.filter(I).filter(_),f=e.contexts.filter(L);t.concat(i).concat(s).concat(o).concat(u).concat(a).concat(f).forEach(function(e){this.renderQueue.push(e);if(M(e)){this.parse(e);this.renderQueue.push(new b)}},this)};g.prototype.paint=function(e){try{if(e instanceof b)this.renderer.ctx.restore();else if(I(e)){F(e.parent)&&e.parent.appendToDOM();this.paintText(e);F(e.parent)&&e.parent.cleanDOM()}else this.paintNode(e)}catch(e){i(e);if(this.options.strict)throw e}};g.prototype.paintNode=function(e){if(M(e)){this.renderer.setOpacity(e.opacity);this.renderer.ctx.save();e.hasTransform()&&this.renderer.setTransform(e.parseTransform())}"INPUT"===e.node.nodeName&&"checkbox"===e.node.type?this.paintCheckbox(e):"INPUT"===e.node.nodeName&&"radio"===e.node.type?this.paintRadio(e):this.paintElement(e)};g.prototype.paintElement=function(e){var t=e.parseBounds();this.renderer.clip(e.backgroundClip,function(){this.renderer.renderBackground(e,t,e.borders.borders.map(R))},this);this.renderer.clip(e.clip,function(){this.renderer.renderBorders(e.borders.borders)},this);this.renderer.clip(e.backgroundClip,function(){switch(e.node.nodeName){case"svg":case"IFRAME":var n=this.images.get(e.node);n?this.renderer.renderImage(e,t,e.borders,n):i("Error loading <"+e.node.nodeName+">",e.node);break;case"IMG":var r=this.images.get(e.node.src);r?this.renderer.renderImage(e,t,e.borders,r):i("Error loading <img>",e.node.src);break;case"CANVAS":this.renderer.renderImage(e,t,e.borders,{image:e.node});break;case"SELECT":case"INPUT":case"TEXTAREA":this.paintFormValue(e)}},this)};g.prototype.paintCheckbox=function(e){var t=e.parseBounds(),n=Math.min(t.width,t.height),r={width:n-1,height:n-1,top:t.top,left:t.left},i=[3,3],s=[i,i,i,i],o=[1,1,1,1].map(function(e){return{color:new l("#A5A5A5"),width:e}}),u=x(r,s,o);this.renderer.clip(e.backgroundClip,function(){this.renderer.rectangle(r.left+1,r.top+1,r.width-2,r.height-2,new l("#DEDEDE"));this.renderer.renderBorders(E(o,r,u,s));if(e.node.checked){this.renderer.font(new l("#424242"),"normal","normal","bold",n-3+"px","arial");this.renderer.text("",r.left+n/6,r.top+n-1)}},this)};g.prototype.paintRadio=function(e){var t=e.parseBounds(),n=Math.min(t.width,t.height)-2;this.renderer.clip(e.backgroundClip,function(){this.renderer.circleStroke(t.left+1,t.top+1,n,new l("#DEDEDE"),1,new l("#A5A5A5"));e.node.checked&&this.renderer.circle(Math.ceil(t.left+n/4)+1,Math.ceil(t.top+n/4)+1,Math.floor(n/2),new l("#424242"))},this)};g.prototype.paintFormValue=function(e){var t=e.getValue();if(t.length>0){var n=e.node.ownerDocument,r=n.createElement("html2canvaswrapper");["lineHeight","textAlign","fontFamily","fontWeight","fontSize","color","paddingLeft","paddingTop","paddingRight","paddingBottom","width","height","borderLeftStyle","borderTopStyle","borderLeftWidth","borderTopWidth","boxSizing","whiteSpace","wordWrap"].forEach(function(t){try{r.style[t]=e.css(t)}catch(e){i("html2canvas: Parse: Exception caught in renderFormValue: "+e.message)}});var s=e.parseBounds();r.style.position="fixed";r.style.left=s.left+"px";r.style.top=s.top+"px";r.textContent=t;n.body.appendChild(r);this.paintText(new u(r.firstChild,e));n.body.removeChild(r)}};g.prototype.paintText=function(e){e.applyTextTransform();var t,n=s.ucs2.decode(e.node.data),r=this.options.letterRendering&&!(function(e){return/^(normal|none|0px)$/.test(e.parent.css("letterSpacing"))})(e)||(t=e.node.data,/[^\u0000-\u00ff]/.test(t))?n.map(function(e){return s.ucs2.encode([e])}):(function(e){for(var t,n,r=[],i=0,o=!1;e.length;){if((n=e[i],-1!==[32,13,10,9,45].indexOf(n))===o){(t=e.splice(0,i)).length&&r.push(s.ucs2.encode(t));o=!o;i=0}else i++;i>=e.length&&(t=e.splice(0,i)).length&&r.push(s.ucs2.encode(t))}return r})(n),i=e.parent.fontWeight(),o=e.parent.css("fontSize"),u=e.parent.css("fontFamily"),a=e.parent.parseTextShadows();this.renderer.font(e.parent.color("color"),e.parent.css("fontStyle"),e.parent.css("fontVariant"),i,o,u);a.length?this.renderer.fontShadow(a[0].color,a[0].offsetX,a[0].offsetY,a[0].blur):this.renderer.clearShadow();this.renderer.clip(e.parent.clip,function(){r.map(this.parseTextBounds(e),this).forEach(function(t,n){if(t){this.renderer.text(r[n],t.left,t.bottom);this.renderTextDecoration(e.parent,t,this.fontMetrics.getMetrics(u,o))}},this)},this)};g.prototype.renderTextDecoration=function(e,t,n){switch(e.css("textDecoration").split(" ")[0]){case"underline":this.renderer.rectangle(t.left,Math.round(t.top+n.baseline+n.lineWidth),t.width,1,e.color("color"));break;case"overline":this.renderer.rectangle(t.left,Math.round(t.top),t.width,1,e.color("color"));break;case"line-through":this.renderer.rectangle(t.left,Math.ceil(t.top+n.middle+n.lineWidth),t.width,1,e.color("color"))}};var w={inset:[["darken",.6],["darken",.1],["darken",.1],["darken",.6]]};g.prototype.parseBorders=function(e){var t=e.parseBounds(),n=(function(e){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(t){var n=e.css("border"+t+"Radius").split(" ");n.length<=1&&(n[1]=n[0]);return n.map(q)})})(e),r=["Top","Right","Bottom","Left"].map(function(t,n){var r=e.css("border"+t+"Style"),i=e.color("border"+t+"Color");"inset"===r&&i.isBlack()&&(i=new l([255,255,255,i.a]));var s=w[r]?w[r][n]:null;return{width:e.cssInt("border"+t+"Width"),color:s?i[s[0]](s[1]):i,args:null}}),i=x(t,n,r);return{clip:this.parseBackgroundClip(e,i,r,n,t),borders:E(r,t,i,n)}};function E(e,t,n,r){return e.map(function(i,s){if(i.width>0){var o=t.left,u=t.top,a=t.width,f=t.height-e[2].width;switch(s){case 0:f=e[0].width;i.args=N({c1:[o,u],c2:[o+a,u],c3:[o+a-e[1].width,u+f],c4:[o+e[3].width,u+f]},r[0],r[1],n.topLeftOuter,n.topLeftInner,n.topRightOuter,n.topRightInner);break;case 1:o=t.left+t.width-e[1].width;a=e[1].width;i.args=N({c1:[o+a,u],c2:[o+a,u+f+e[2].width],c3:[o,u+f],c4:[o,u+e[0].width]},r[1],r[2],n.topRightOuter,n.topRightInner,n.bottomRightOuter,n.bottomRightInner);break;case 2:u=u+t.height-e[2].width;f=e[2].width;i.args=N({c1:[o+a,u+f],c2:[o,u+f],c3:[o+e[3].width,u],c4:[o+a-e[3].width,u]},r[2],r[3],n.bottomRightOuter,n.bottomRightInner,n.bottomLeftOuter,n.bottomLeftInner);break;case 3:a=e[3].width;i.args=N({c1:[o,u+f+e[2].width],c2:[o,u],c3:[o+a,u+e[0].width],c4:[o+a,u+f]},r[3],r[0],n.bottomLeftOuter,n.bottomLeftInner,n.topLeftOuter,n.topLeftInner)}}return i})}g.prototype.parseBackgroundClip=function(e,t,n,r,i){var s=[];switch(e.css("backgroundClip")){case"content-box":case"padding-box":C(s,r[0],r[1],t.topLeftInner,t.topRightInner,i.left+n[3].width,i.top+n[0].width);C(s,r[1],r[2],t.topRightInner,t.bottomRightInner,i.left+i.width-n[1].width,i.top+n[0].width);C(s,r[2],r[3],t.bottomRightInner,t.bottomLeftInner,i.left+i.width-n[1].width,i.top+i.height-n[2].width);C(s,r[3],r[0],t.bottomLeftInner,t.topLeftInner,i.left+n[3].width,i.top+i.height-n[2].width);break;default:C(s,r[0],r[1],t.topLeftOuter,t.topRightOuter,i.left,i.top);C(s,r[1],r[2],t.topRightOuter,t.bottomRightOuter,i.left+i.width,i.top);C(s,r[2],r[3],t.bottomRightOuter,t.bottomLeftOuter,i.left+i.width,i.top+i.height);C(s,r[3],r[0],t.bottomLeftOuter,t.topLeftOuter,i.left,i.top+i.height)}return s};function S(e,t,n,r){var i=(Math.sqrt(2)-1)/3*4,s=n*i,o=r*i,u=e+n,a=t+r;return{topLeft:T({x:e,y:a},{x:e,y:a-o},{x:u-s,y:t},{x:u,y:t}),topRight:T({x:e,y:t},{x:e+s,y:t},{x:u,y:a-o},{x:u,y:a}),bottomRight:T({x:u,y:t},{x:u,y:t+o},{x:e+s,y:a},{x:e,y:a}),bottomLeft:T({x:u,y:a},{x:u-s,y:a},{x:e,y:t+o},{x:e,y:t})}}function x(e,t,n){var r=e.left,i=e.top,s=e.width,o=e.height,u=t[0][0]<s/2?t[0][0]:s/2,a=t[0][1]<o/2?t[0][1]:o/2,f=t[1][0]<s/2?t[1][0]:s/2,l=t[1][1]<o/2?t[1][1]:o/2,c=t[2][0]<s/2?t[2][0]:s/2,h=t[2][1]<o/2?t[2][1]:o/2,p=t[3][0]<s/2?t[3][0]:s/2,d=t[3][1]<o/2?t[3][1]:o/2,v=s-f,m=o-h,g=s-c,y=o-d;return{topLeftOuter:S(r,i,u,a).topLeft.subdivide(.5),topLeftInner:S(r+n[3].width,i+n[0].width,Math.max(0,u-n[3].width),Math.max(0,a-n[0].width)).topLeft.subdivide(.5),topRightOuter:S(r+v,i,f,l).topRight.subdivide(.5),topRightInner:S(r+Math.min(v,s+n[3].width),i+n[0].width,v>s+n[3].width?0:f-n[3].width,l-n[0].width).topRight.subdivide(.5),bottomRightOuter:S(r+g,i+m,c,h).bottomRight.subdivide(.5),bottomRightInner:S(r+Math.min(g,s-n[3].width),i+Math.min(m,o+n[0].width),Math.max(0,c-n[1].width),h-n[2].width).bottomRight.subdivide(.5),bottomLeftOuter:S(r,i+y,p,d).bottomLeft.subdivide(.5),bottomLeftInner:S(r+n[3].width,i+y,Math.max(0,p-n[3].width),d-n[2].width).bottomLeft.subdivide(.5)}}function T(e,t,n,r){var i=function(e,t,n){return{x:e.x+(t.x-e.x)*n,y:e.y+(t.y-e.y)*n}};return{start:e,startControl:t,endControl:n,end:r,subdivide:function(s){var o=i(e,t,s),u=i(t,n,s),a=i(n,r,s),f=i(o,u,s),l=i(u,a,s),c=i(f,l,s);return[T(e,o,f,c),T(c,l,a,r)]},curveTo:function(e){e.push(["bezierCurve",t.x,t.y,n.x,n.y,r.x,r.y])},curveToReversed:function(r){r.push(["bezierCurve",n.x,n.y,t.x,t.y,e.x,e.y])}}}function N(e,t,n,r,i,s,o){var u=[];if(t[0]>0||t[1]>0){u.push(["line",r[1].start.x,r[1].start.y]);r[1].curveTo(u)}else u.push(["line",e.c1[0],e.c1[1]]);if(n[0]>0||n[1]>0){u.push(["line",s[0].start.x,s[0].start.y]);s[0].curveTo(u);u.push(["line",o[0].end.x,o[0].end.y]);o[0].curveToReversed(u)}else{u.push(["line",e.c2[0],e.c2[1]]);u.push(["line",e.c3[0],e.c3[1]])}if(t[0]>0||t[1]>0){u.push(["line",i[1].end.x,i[1].end.y]);i[1].curveToReversed(u)}else u.push(["line",e.c4[0],e.c4[1]]);return u}function C(e,t,n,r,i,s,o){if(t[0]>0||t[1]>0){e.push(["line",r[0].start.x,r[0].start.y]);r[0].curveTo(e);r[1].curveTo(e)}else e.push(["line",s,o]);(n[0]>0||n[1]>0)&&e.push(["line",i[0].start.x,i[0].start.y])}function k(e){return e.cssInt("zIndex")<0}function L(e){return e.cssInt("zIndex")>0}function A(e){return 0===e.cssInt("zIndex")}function O(e){return-1!==["inline","inline-block","inline-table"].indexOf(e.css("display"))}function M(e){return e instanceof c}function _(e){return e.node.data.trim().length>0}function D(e){return e.nodeType===Node.TEXT_NODE||e.nodeType===Node.ELEMENT_NODE}function P(e){return"static"!==e.css("position")}function H(e){return"none"!==e.css("float")}function B(e){var t=this;return function(){return!e.apply(t,arguments)}}function j(e){return e.node.nodeType===Node.ELEMENT_NODE}function F(e){return!0===e.isPseudoElement}function I(e){return e.node.nodeType===Node.TEXT_NODE}function q(e){return parseInt(e,10)}function R(e){return e.width}function U(e){return e.node.nodeType!==Node.ELEMENT_NODE||-1===["SCRIPT","HEAD","TITLE","OBJECT","BR","OPTION"].indexOf(e.node.nodeName)}function z(e){return[].concat.apply([],e)}t.exports=g},{"./color":3,"./fontmetrics":7,"./log":13,"./nodecontainer":14,"./pseudoelementcontainer":18,"./stackingcontext":21,"./textcontainer":25,"./utils":26,punycode:1}],16:[function(e,t,r){var i=e("./xhr"),s=e("./utils"),o=e("./log"),u=e("./clone"),a=s.decode64;function f(e,t,r){var s="withCredentials"in new XMLHttpRequest;if(!t)return n.reject("No proxy configured");var o=h(s),u=p(t,e,o);return s?i(u):c(r,u,o).then(function(e){return a(e.content)})}var l=0;function c(e,t,r){return new n(function(n,i){var s=e.createElement("script"),o=function(){delete window.OfficeBrowserFeedback.html2canvas.proxy[r];e.body.removeChild(s)};window.OfficeBrowserFeedback.html2canvas.proxy[r]=function(e){o();n(e)};s.src=t;s.onerror=function(e){o();i(e)};e.body.appendChild(s)})}function h(e){return e?"":"html2canvas_"+Date.now()+"_"+ ++l+"_"+Math.round(1e5*Math.random())}function p(e,t,n){return e+"?url="+encodeURIComponent(t)+(n.length?"&callback=html2canvas.proxy."+n:"")}function d(e){return function(t){var n,r=new DOMParser;try{n=r.parseFromString(t,"text/html")}catch(e){o("DOMParser not supported, falling back to createHTMLDocument");n=document.implementation.createHTMLDocument("");try{n.open();n.write(t);n.close()}catch(e){o("createHTMLDocument write not supported, falling back to document.body.innerHTML");n.body.innerHTML=t}}var i=n.querySelector("base");if(!i||!i.href.host){var s=n.createElement("base");s.href=e;n.head.insertBefore(s,n.head.firstChild)}return n}}r.Proxy=f;r.ProxyURL=function(e,t,r){var i="crossOrigin"in new Image,s=h(i),o=p(t,e,s);return i?n.resolve(o):c(r,o,s).then(function(e){return"data:"+e.type+";base64,"+e.content})};r.loadUrlDocument=function(e,t,n,r,i,s){return new f(e,t,window.document).then(d(e)).then(function(e){return u(e,n,r,i,s,0,0)})}},{"./clone":2,"./log":13,"./utils":26,"./xhr":28}],17:[function(e,t,r){var i=e("./proxy").ProxyURL;t.exports=function(e,t){var r=document.createElement("a");r.href=e;e=r.href;this.src=e;this.image=new Image;var s=this;this.promise=new n(function(n,r){s.image.crossOrigin="Anonymous";s.image.onload=n;s.image.onerror=r;new i(e,t,document).then(function(e){s.image.src=e}).catch(r)})}},{"./proxy":16}],18:[function(e,t,n){var r=e("./nodecontainer");function i(e,t,n){r.call(this,e,t);this.isPseudoElement=!0;this.before=":before"===n}i.prototype.cloneTo=function(e){i.prototype.cloneTo.call(this,e);e.isPseudoElement=!0;e.before=this.before};i.prototype=Object.create(r.prototype);i.prototype.appendToDOM=function(){this.before?this.parent.node.insertBefore(this.node,this.parent.node.firstChild):this.parent.node.appendChild(this.node);this.parent.node.className+=" "+this.getHideClass()};i.prototype.cleanDOM=function(){this.node.parentNode.removeChild(this.node);this.parent.node.className=this.parent.node.className.replace(this.getHideClass(),"")};i.prototype.getHideClass=function(){return this["PSEUDO_HIDE_ELEMENT_CLASS_"+(this.before?"BEFORE":"AFTER")]};i.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before";i.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after";t.exports=i},{"./nodecontainer":14}],19:[function(e,t,n){var r=e("./log");function i(e,t,n,r,i){this.width=e;this.height=t;this.images=n;this.options=r;this.document=i}i.prototype.renderImage=function(e,t,n,r){var i=e.cssInt("paddingLeft"),s=e.cssInt("paddingTop"),o=e.cssInt("paddingRight"),u=e.cssInt("paddingBottom"),a=n.borders,f=t.width-(a[1].width+a[3].width+i+o),l=t.height-(a[0].width+a[2].width+s+u);this.drawImage(r,0,0,r.image.width||f,r.image.height||l,t.left+i+a[3].width,t.top+s+a[0].width,f,l)};i.prototype.renderBackground=function(e,t,n){if(t.height>0&&t.width>0){this.renderBackgroundColor(e,t);this.renderBackgroundImage(e,t,n)}};i.prototype.renderBackgroundColor=function(e,t){var n=e.color("backgroundColor");n.isTransparent()||this.rectangle(t.left,t.top,t.width,t.height,n)};i.prototype.renderBorders=function(e){e.forEach(this.renderBorder,this)};i.prototype.renderBorder=function(e){e.color.isTransparent()||null===e.args||this.drawShape(e.args,e.color)};i.prototype.renderBackgroundImage=function(e,t,n){e.parseBackgroundImages().reverse().forEach(function(i,s,o){switch(i.method){case"url":var u=this.images.get(i.args[0]);u?this.renderBackgroundRepeating(e,t,u,o.length-(s+1),n):r("Error loading background-image",i.args[0]);break;case"linear-gradient":case"gradient":var a=this.images.get(i.value);a?this.renderBackgroundGradient(a,t,n):r("Error loading background-image",i.args[0]);break;case"none":break;default:r("Unknown background-image type",i.args[0])}},this)};i.prototype.renderBackgroundRepeating=function(e,t,n,r,i){var s=e.parseBackgroundSize(t,n.image,r),o=e.parseBackgroundPosition(t,n.image,r,s);switch(e.parseBackgroundRepeat(r)){case"repeat-x":case"repeat no-repeat":this.backgroundRepeatShape(n,o,s,t,t.left+i[3],t.top+o.top+i[0],99999,s.height,i);break;case"repeat-y":case"no-repeat repeat":this.backgroundRepeatShape(n,o,s,t,t.left+o.left+i[3],t.top+i[0],s.width,99999,i);break;case"no-repeat":this.backgroundRepeatShape(n,o,s,t,t.left+o.left+i[3],t.top+o.top+i[0],s.width,s.height,i);break;default:this.renderBackgroundRepeat(n,o,s,{top:t.top,left:t.left},i[3],i[0])}};t.exports=i},{"./log":13}],20:[function(e,t,n){var r=e("../renderer"),i=e("../lineargradientcontainer"),s=e("../log");function o(e,t){r.apply(this,arguments);this.canvas=this.options.canvas||this.document.createElement("canvas");if(!this.options.canvas){this.canvas.width=e;this.canvas.height=t}this.ctx=this.canvas.getContext("2d");this.taintCtx=this.document.createElement("canvas").getContext("2d");this.ctx.textBaseline="bottom";this.variables={};s("Initialized CanvasRenderer with size",e,"x",t)}o.prototype=Object.create(r.prototype);o.prototype.setFillStyle=function(e){this.ctx.fillStyle="object"==typeof e&&e.isColor?e.toString():e;return this.ctx};o.prototype.rectangle=function(e,t,n,r,i){this.setFillStyle(i).fillRect(e,t,n,r)};o.prototype.circle=function(e,t,n,r){this.setFillStyle(r);this.ctx.beginPath();this.ctx.arc(e+n/2,t+n/2,n/2,0,2*Math.PI,!0);this.ctx.closePath();this.ctx.fill()};o.prototype.circleStroke=function(e,t,n,r,i,s){this.circle(e,t,n,r);this.ctx.strokeStyle=s.toString();this.ctx.stroke()};o.prototype.drawShape=function(e,t){this.shape(e);this.setFillStyle(t).fill()};o.prototype.taints=function(e){if(null===e.tainted){this.taintCtx.drawImage(e.image,0,0);try{this.taintCtx.getImageData(0,0,1,1);e.tainted=!1}catch(t){this.taintCtx=document.createElement("canvas").getContext("2d");e.tainted=!0}}return e.tainted};o.prototype.drawImage=function(e,t,n,r,i,s,o,u,a){this.taints(e)&&!this.options.allowTaint||this.ctx.drawImage(e.image,t,n,r,i,s,o,u,a)};o.prototype.clip=function(e,t,n){this.ctx.save();e.filter(u).forEach(function(e){this.shape(e).clip()},this);t.call(n);this.ctx.restore()};o.prototype.shape=function(e){this.ctx.beginPath();e.forEach(function(e,t){"rect"===e[0]?this.ctx.rect.apply(this.ctx,e.slice(1)):this.ctx[0===t?"moveTo":e[0]+"To"].apply(this.ctx,e.slice(1))},this);this.ctx.closePath();return this.ctx};o.prototype.font=function(e,t,n,r,i,s){this.setFillStyle(e).font=[t,n,r,i,s].join(" ").split(",")[0]};o.prototype.fontShadow=function(e,t,n,r){this.setVariable("shadowColor",e.toString()).setVariable("shadowOffsetY",t).setVariable("shadowOffsetX",n).setVariable("shadowBlur",r)};o.prototype.clearShadow=function(){this.setVariable("shadowColor","rgba(0,0,0,0)")};o.prototype.setOpacity=function(e){this.ctx.globalAlpha=e};o.prototype.setTransform=function(e){this.ctx.translate(e.origin[0],e.origin[1]);this.ctx.transform.apply(this.ctx,e.matrix);this.ctx.translate(-e.origin[0],-e.origin[1])};o.prototype.setVariable=function(e,t){this.variables[e]!==t&&(this.variables[e]=this.ctx[e]=t);return this};o.prototype.text=function(e,t,n){this.ctx.fillText(e,t,n)};o.prototype.backgroundRepeatShape=function(e,t,n,r,i,s,o,u,a){var f=[["line",Math.round(i),Math.round(s)],["line",Math.round(i+o),Math.round(s)],["line",Math.round(i+o),Math.round(u+s)],["line",Math.round(i),Math.round(u+s)]];this.clip([f],function(){this.renderBackgroundRepeat(e,t,n,r,a[3],a[0])},this)};o.prototype.renderBackgroundRepeat=function(e,t,n,r,i,s){var o=Math.round(r.left+t.left+i),u=Math.round(r.top+t.top+s);this.setFillStyle(this.ctx.createPattern(this.resizeImage(e,n),"repeat"));this.ctx.translate(o,u);this.ctx.fill();this.ctx.translate(-o,-u)};o.prototype.renderBackgroundGradient=function(e,t){if(e instanceof i){var n=this.ctx.createLinearGradient(t.left+t.width*e.x0,t.top+t.height*e.y0,t.left+t.width*e.x1,t.top+t.height*e.y1);e.colorStops.forEach(function(e){n.addColorStop(e.stop,e.color.toString())});this.rectangle(t.left,t.top,t.width,t.height,n)}};o.prototype.resizeImage=function(e,t){var n=e.image;if(n.width===t.width&&n.height===t.height)return n;var r=document.createElement("canvas");r.width=t.width;r.height=t.height;r.getContext("2d").drawImage(n,0,0,n.width,n.height,0,0,t.width,t.height);return r};function u(e){return e.length>0}t.exports=o},{"../lineargradientcontainer":12,"../log":13,"../renderer":19}],21:[function(e,t,n){var r=e("./nodecontainer");function i(e,t,n,i){r.call(this,n,i);this.ownStacking=e;this.contexts=[];this.children=[];this.opacity=(this.parent?this.parent.stack.opacity:1)*t}i.prototype=Object.create(r.prototype);i.prototype.getParentStack=function(e){var t=this.parent?this.parent.stack:null;return t?t.ownStacking?t:t.getParentStack(e):e.stack};t.exports=i},{"./nodecontainer":14}],22:[function(e,t,n){function r(e){this.rangeBounds=this.testRangeBounds(e);this.cors=this.testCORS();this.svg=this.testSVG()}r.prototype.testRangeBounds=function(e){var t,n,r=!1;if(e.createRange&&(t=e.createRange()).getBoundingClientRect){(n=e.createElement("boundtest")).style.height="123px";n.style.display="block";e.body.appendChild(n);t.selectNode(n);123===t.getBoundingClientRect().height&&(r=!0);e.body.removeChild(n)}return r};r.prototype.testCORS=function(){return void 0!==(new Image).crossOrigin};r.prototype.testSVG=function(){var e=new Image,t=document.createElement("canvas"),n=t.getContext("2d");e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(e,0,0);t.toDataURL()}catch(e){return!1}return!0};t.exports=r},{}],23:[function(e,t,r){var i=e("./xhr"),s=e("./utils").decode64;function o(e){this.src=e;this.image=null;var t=this;this.promise=this.hasFabric().then(function(){return t.isInline(e)?n.resolve(t.inlineFormatting(e)):i(e)}).then(function(e){return new n(function(n){window.OfficeBrowserFeedback.html2canvas.svg.fabric.loadSVGFromString(e,t.createCanvas.call(t,n))})})}o.prototype.hasFabric=function(){return window.OfficeBrowserFeedback.html2canvas.svg&&window.OfficeBrowserFeedback.html2canvas.svg.fabric?n.resolve():n.reject(new Error("html2canvas.svg.js is not loaded, cannot render svg"))};o.prototype.inlineFormatting=function(e){return/^data:image\/svg\+xml;base64,/.test(e)?this.decode64(this.removeContentType(e)):this.removeContentType(e)};o.prototype.removeContentType=function(e){return e.replace(/^data:image\/svg\+xml(;base64)?,/,"")};o.prototype.isInline=function(e){return/^data:image\/svg\+xml/i.test(e)};o.prototype.createCanvas=function(e){var t=this;return function(n,r){var i=new window.OfficeBrowserFeedback.html2canvas.svg.fabric.StaticCanvas("c");t.image=i.lowerCanvasEl;i.setWidth(r.width).setHeight(r.height).add(window.OfficeBrowserFeedback.html2canvas.svg.fabric.util.groupSVGElements(n,r)).renderAll();e(i.lowerCanvasEl)}};o.prototype.decode64=function(e){return"function"==typeof window.atob?window.atob(e):s(e)};t.exports=o},{"./utils":26,"./xhr":28}],24:[function(e,t,r){var i=e("./svgcontainer");function s(e,t){this.src=e;this.image=null;var r=this;this.promise=t?new n(function(t,n){r.image=new Image;r.image.onload=t;r.image.onerror=n;r.image.src="data:image/svg+xml,"+(new XMLSerializer).serializeToString(e);!0===r.image.complete&&t(r.image)}):this.hasFabric().then(function(){return new n(function(t){window.OfficeBrowserFeedback.html2canvas.svg.fabric.parseSVGDocument(e,r.createCanvas.call(r,t))})})}s.prototype=Object.create(i.prototype);t.exports=s},{"./svgcontainer":23}],25:[function(e,t,n){var r=e("./nodecontainer");function i(e,t){r.call(this,e,t)}i.prototype=Object.create(r.prototype);i.prototype.applyTextTransform=function(){this.node.data=this.transform(this.parent.css("textTransform"))};i.prototype.transform=function(e){var t=this.node.data;switch(e){case"lowercase":return t.toLowerCase();case"capitalize":return t.replace(/(^|\s|:|-|\(|\))([a-z])/g,s);case"uppercase":return t.toUpperCase();default:return t}};function s(e,t,n){if(e.length>0)return t+n.toUpperCase()}t.exports=i},{"./nodecontainer":14}],26:[function(e,t,n){n.smallImage=function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"};n.bind=function(e,t){return function(){return e.apply(t,arguments)}};n.decode64=function(e){var t,n,r,i,s,o,u,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=e.length,l="";for(t=0;t<f;t+=4){s=a.indexOf(e[t])<<2|(n=a.indexOf(e[t+1]))>>4;o=(15&n)<<4|(r=a.indexOf(e[t+2]))>>2;u=(3&r)<<6|(i=a.indexOf(e[t+3]));l+=64===r?String.fromCharCode(s):64===i||-1===i?String.fromCharCode(s,o):String.fromCharCode(s,o,u)}return l};n.getBounds=function(e){if(e.getBoundingClientRect){var t=e.getBoundingClientRect(),n=null==e.offsetWidth?t.width:e.offsetWidth;return{top:t.top,bottom:t.bottom||t.top+t.height,right:t.left+n,left:t.left,width:n,height:null==e.offsetHeight?t.height:e.offsetHeight}}return{}};n.offsetBounds=function(e){var t=e.offsetParent?n.offsetBounds(e.offsetParent):{top:0,left:0};return{top:e.offsetTop+t.top,bottom:e.offsetTop+e.offsetHeight+t.top,right:e.offsetLeft+t.left+e.offsetWidth,left:e.offsetLeft+t.left,width:e.offsetWidth,height:e.offsetHeight}};n.parseBackgrounds=function(e){var t,n,r,i,s,o,u,a=[],f=0,l=0,c=function(){if(t){'"'===n.substr(0,1)&&(n=n.substr(1,n.length-2));n&&u.push(n);if("-"===t.substr(0,1)&&(i=t.indexOf("-",1)+1)>0){r=t.substr(0,i);t=t.substr(i)}a.push({prefix:r,method:t.toLowerCase(),value:s,args:u,image:null})}u=[];t=r=n=s=""};u=[];t=r=n=s="";e.split("").forEach(function(e){if(!(0===f&&" \r\n\t".indexOf(e)>-1)){switch(e){case'"':o?o===e&&(o=null):o=e;break;case"(":if(o)break;if(0===f){f=1;s+=e;return}l++;break;case")":if(o)break;if(1===f){if(0===l){f=0;s+=e;c();return}l--}break;case",":if(o)break;if(0===f){c();return}if(1===f&&0===l&&!t.match(/^url$/i)){u.push(n);n="";s+=e;return}}s+=e;0===f?t+=e:n+=e}});c();return a}},{}],27:[function(e,t,n){var r=e("./gradientcontainer");function i(e){r.apply(this,arguments);this.type="linear"===e.args[0]?r.TYPES.LINEAR:r.TYPES.RADIAL}i.prototype=Object.create(r.prototype);t.exports=i},{"./gradientcontainer":9}],28:[function(e,t,r){t.exports=function(e){return new n(function(t,n){var r=new XMLHttpRequest;r.open("GET",e);r.onload=function(){200===r.status?t(r.responseText):n(new Error(r.statusText))};r.onerror=function(){n(new Error("Network Error"))};r.send()})}},{}]},{},[4])(4)}}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"es6-promise":42}]},{},[45,46,95])}).call(this,n(712))}}]);