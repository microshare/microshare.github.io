(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["1"],{2906:function(e,t,n){var r,i,s,o;(r||(r={})).version="2.9.0";!(function(e){!(function(e){!(function(e){e[e.BT_STOP=0]="BT_STOP",e[e.BT_STOP_BASE=1]="BT_STOP_BASE",e[e.BT_BOOL=2]="BT_BOOL",e[e.BT_UINT8=3]="BT_UINT8",e[e.BT_UINT16=4]="BT_UINT16",e[e.BT_UINT32=5]="BT_UINT32",e[e.BT_UINT64=6]="BT_UINT64",e[e.BT_FLOAT=7]="BT_FLOAT",e[e.BT_DOUBLE=8]="BT_DOUBLE",e[e.BT_STRING=9]="BT_STRING",e[e.BT_STRUCT=10]="BT_STRUCT",e[e.BT_LIST=11]="BT_LIST",e[e.BT_SET=12]="BT_SET",e[e.BT_MAP=13]="BT_MAP",e[e.BT_INT8=14]="BT_INT8",e[e.BT_INT16=15]="BT_INT16",e[e.BT_INT32=16]="BT_INT32",e[e.BT_INT64=17]="BT_INT64",e[e.BT_WSTRING=18]="BT_WSTRING",e[e.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"})(e.BondDataType||(e.BondDataType={}));!(function(e){e[e.MARSHALED_PROTOCOL=0]="MARSHALED_PROTOCOL",e[e.MAFIA_PROTOCOL=17997]="MAFIA_PROTOCOL",e[e.COMPACT_PROTOCOL=16963]="COMPACT_PROTOCOL",e[e.JSON_PROTOCOL=21322]="JSON_PROTOCOL",e[e.PRETTY_JSON_PROTOCOL=20554]="PRETTY_JSON_PROTOCOL",e[e.SIMPLE_PROTOCOL=20563]="SIMPLE_PROTOCOL"})(e.ProtocolType||(e.ProtocolType={}))})(e.Bond||(e.Bond={}))})(i||(i={}));!(function(e){!(function(e){!(function(e){var t=(function(){function e(){this._buffer=[]}return e.prototype.Add=function(e){for(var t=0;t<this._buffer.length&&this._buffer[t]!=e;++t);t==this._buffer.length&&this._buffer.push(e)},e.prototype.Count=function(){return this._buffer.length},e.prototype.GetBuffer=function(){return this._buffer},e})();e.Set=t;var n=(function(){function e(){this._buffer=[]}return e.prototype.Add=function(e,t){-1==this._getIndex(e)&&this._buffer.push({Key:e,Value:t})},e.prototype.AddOrReplace=function(e,t){var n=this._getIndex(e);n>=0?this._buffer[n]={Key:e,Value:t}:this._buffer.push({Key:e,Value:t})},e.prototype.Remove=function(e){var t=this._getIndex(e);t>=0&&this._buffer.splice(t,1)},e.prototype.Count=function(){return this._buffer.length},e.prototype.GetBuffer=function(){return this._buffer},e.prototype.ContainsKey=function(e){return this._getIndex(e)>=0},e.prototype.Get=function(e){var t=this._getIndex(e);return t>=0?this._buffer[t].Value:null},e.prototype._getIndex=function(e){for(var t=0,n=-1;t<this._buffer.length;++t)if(this._buffer[t].Key==e){n=t;break}return n},e})();e.Map=n})(e.Collections||(e.Collections={}))})(e.Bond||(e.Bond={}))})(i||(i={}));!(function(e){!(function(t){!(function(e){var r=(function(){function e(){}return e.GetBytes=function(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?t.push(192|r>>6,128|63&r):r<55296||r>=57344?t.push(224|r>>12,128|r>>6&63,128|63&r):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++n)),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return t},e})();e.Utf8=r;var i=(function(){function e(){}return e.GetString=function(e){var t,n,r,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=[],o=e.length%3,u=function(e){return[i.charAt(e>>18&63),i.charAt(e>>12&63),i.charAt(e>>6&63),i.charAt(63&e)].join("")};for(t=0,r=e.length-o;t<r;t+=3)n=(e[t]<<16)+(e[t+1]<<8)+e[t+2],s.push(u(n));switch(o){case 1:n=e[e.length-1],s.push(i.charAt(n>>2)),s.push(i.charAt(n<<4&63)),s.push("==");break;case 2:n=(e[e.length-2]<<8)+e[e.length-1],s.push(i.charAt(n>>10)),s.push(i.charAt(n>>4&63)),s.push(i.charAt(n<<2&63)),s.push("=")}return s.join("")},e})();e.Base64=i;var s=(function(){function e(){}return e.GetBytes=function(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t},e})();e.Varint=s;var o=(function(){function e(){}return e.GetBytes=function(e){for(var t=e.low,n=e.high,r=[];n||4294967168&t;)r.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return r.push(127&t),r},e})();e.Varint64=o;var u=(function(){function e(){}return e.GetBytes=function(e){if(t.BrowserChecker.IsDataViewSupport()){var r=new DataView(new ArrayBuffer(4));r.setFloat32(0,e,!0);for(var i=[],s=0;s<4;++s)i.push(r.getUint8(s));return i}return n.ConvertNumberToArray(e,!1)},e})();e.Float=u;var a=(function(){function e(){}return e.GetBytes=function(e){if(t.BrowserChecker.IsDataViewSupport()){var r=new DataView(new ArrayBuffer(8));r.setFloat64(0,e,!0);for(var i=[],s=0;s<8;++s)i.push(r.getUint8(s));return i}return n.ConvertNumberToArray(e,!0)},e})();e.Double=a;var f=(function(){function e(){}return e.EncodeZigzag16=function(e){return(e=t.Number.ToInt16(e))<<1^e>>15},e.EncodeZigzag32=function(e){return(e=t.Number.ToInt32(e))<<1^e>>31},e.EncodeZigzag64=function(e){var n=e.low,r=e.high,i=r<<1|n>>>31,s=n<<1;2147483648&r&&(i=~i,s=~s);var o=new t.UInt64("0");return o.low=s,o.high=i,o},e})();e.Zigzag=f})(t.Encoding||(t.Encoding={}));!(function(r){var i=(function(){function e(){}return e.GetString=function(e){for(var t=[],n=0;n<e.length;++n){var r=e[n];if(r<=191)t.push(String.fromCharCode(r));else if(r<=223){var i=e[++n];t.push(String.fromCharCode((31&r)<<6|63&i))}else if(r<=239){i=e[++n];var s=e[++n];t.push(String.fromCharCode((15&r)<<12|(63&i)<<6|63&s))}else{r=(7&r)<<18|(63&(i=e[++n]))<<12|(63&(s=e[++n]))<<6|63&e[++n],r-=65536,t.push(String.fromCharCode(55296|r>>10&1023)),t.push(String.fromCharCode(56320|1023&r))}}return t.join("")},e})();r.Utf8=i;var s=(function(){function e(){}return e.GetBytes=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],r=0;r<e.length;++r){var i=t.indexOf(e.charAt(r++)),s=t.indexOf(e.charAt(r++)),o=t.indexOf(e.charAt(r++)),u=t.indexOf(e.charAt(r));n.push(i<<2|s>>4),o>=0&&(n.push(s<<4&240|o>>2),u>=0&&n.push(o<<6&192|u))}return n},e})();r.Base64=s;var o=(function(){function t(){}return t.GetInt64=function(t){var n=new e.Bond.Int64("0"),r=this._Read(t);return n.low=r[0],r.length>1&&(n.high=r[1]),n},t.GetNumber=function(e){return this._Read(e)[0]},t._Read=function(e){for(var t=[],n=0,r=!0,i=0;r;){if(r=0!=(128&(s=e.shift())),s&=127,!(i<28)){n|=s<<i,t.push(n),n=s>>4,i=3;break}n|=s<<i,i+=7}for(;r;){var s;if(r=0!=(128&(s=e.shift())),n|=(s&=127)<<i,(i+=7)>=32)break}return t.push(n),t},t})();r.Varint=o;var u=(function(){function e(){}return e.GetNumber=function(e){if(t.BrowserChecker.IsDataViewSupport()){for(var r=new DataView(new ArrayBuffer(4)),i=0;i<4;++i)r.setUint8(i,e[i]);return r.getFloat32(0,!0)}return n.ConvertArrayToNumber(e,!1)},e})();r.Float=u;var a=(function(){function e(){}return e.GetNumber=function(e){if(t.BrowserChecker.IsDataViewSupport()){for(var r=new DataView(new ArrayBuffer(8)),i=0;i<8;++i)r.setUint8(i,e[i]);return r.getFloat64(0,!0)}return n.ConvertArrayToNumber(e,!0)},e})();r.Double=a;var f=(function(){function t(){}return t.DecodeZigzag16=function(e){return((65535&e)>>>1^-(1&e))<<16>>16},t.DecodeZigzag32=function(e){return e>>>1^-(1&e)},t.DecodeZigzag64=function(t){var n=1&t.high,r=t.high>>>1,i=1&t.low,s=t.low>>>1;s|=n<<31,i&&(s^=4294967295,r^=4294967295);var o=new e.Bond.UInt64("0");return o.low=s,o.high=r,o},t})();r.Zigzag=f})(t.Decoding||(t.Decoding={}));var n=(function(){function e(){}return e.ConvertNumberToArray=function(e,t){if(!e)return t?this._doubleZero:this._floatZero;var n=t?52:23,r=(1<<(t?11:8)-1)-1,i=1-r,s=r,o=e<0?1:0;e=Math.abs(e);for(var u=Math.floor(e),a=e-u,f=2*(r+2)+n,l=new Array(f),c=0;c<f;)l[c++]=0;for(c=r+2;c&&u;)l[--c]=u%2,u=Math.floor(u/2);for(c=r+1;c<f-1&&a>0;)(a*=2)>=1?(l[++c]=1,--a):l[++c]=0;for(var h=0;h<f&&!l[h];++h);var p=r+1-h,d=h+n;if(l[d+1]){for(c=d;c>h&&!(l[c]=1-l[c]);--c);c==h&&++p}if(p>s||u)return o?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(p<i)return t?this._doubleZero:this._floatZero;if(t){var v=0;for(c=0;c<20;++c)v=v<<1|l[++h];for(var m=0;c<52;++c)m=m<<1|l[++h];return[255&m,m>>8&255,m>>16&255,m>>>24,255&(v=o<<31|2147483647&(v|=p+r<<20)),v>>8&255,v>>16&255,v>>>24]}var g=0;for(c=0;c<23;++c)g=g<<1|l[++h];return[255&(g=o<<31|2147483647&(g|=p+r<<23)),g>>8&255,g>>16&255,g>>>24]},e.ConvertArrayToNumber=function(e,n){var r=(1<<(n?11:8)-1)-1,i=0!=(128&e[n?7:3]),s=n?(127&e[7])<<4|(240&e[6])>>4:(127&e[3])<<1|(128&e[2])>>7;if(255==s)throw new t.Exception("Not a valid float/double buffer.");var o=1,u=1;if(n){var a=(15&e[6])<<28|(255&e[5])<<20|(255&e[4])<<12,f=e[3]<<24|(255&e[2])<<16|(255&e[1])<<8|255&e[0];if(!s&&!a&&!f)return 0;for(var l=0;l<20;++l)u/=2,a<0&&(o+=u),a<<=1;for(l=0;l<32;++l)u/=2,f<0&&(o+=u),f<<=1}else{var c=(127&e[2])<<25|(255&e[1])<<17|(255&e[0])<<9;if(!s&&!c)return 0;for(l=0;l<23;++l)u/=2,c<0&&(o+=u),c<<=1}return o*=Math.pow(2,s-r),i?0-o:o},e})();n._floatZero=[0,0,0,0],n._doubleZero=[0,0,0,0,0,0,0,0],n._floatInifinity=[0,0,128,127],n._floatNegInifinity=[0,0,128,255],n._doubleInifinity=[0,0,0,0,0,0,240,127],n._doubleNegInifinity=[0,0,0,0,0,0,240,255]})(e.Bond||(e.Bond={}))})(i||(i={}));!(function(e){!(function(e){!(function(t){var n=(function(){function t(){this._buffer=[]}return t.prototype.WriteByte=function(t){this._buffer.push(e.Number.ToByte(t))},t.prototype.Write=function(e,t,n){for(;n--;)this.WriteByte(e[t++])},t.prototype.GetBuffer=function(){return this._buffer},t})();t.MemoryStream=n})(e.IO||(e.IO={}))})(e.Bond||(e.Bond={}))})(i||(i={}));!(function(e){!(function(e){var t=function(e,t){this.Type=e,this.Id=t};e.FieldTag=t;var n=function(e,t){this.ElementType=e,this.Size=t};e.ContainerTag=n;var r=function(e,t,n){this.KeyType=e,this.ValueType=t,this.Size=n};e.KeyValueContainerTag=r;var i=function(){};e.Bonded=i;var s=(function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e),this.low<0&&(this.high=-1)}return e.prototype.Equals=function(t){var n=new e(t);return this.low==n.low&&this.high==n.high},e})();e.Int64=s;var o=(function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e)}return e.prototype.Equals=function(t){var n=new e(t);return this.low==n.low&&this.high==n.high},e})();e.UInt64=o;var u=(function(){function e(){}return e.ToByte=function(e){return this.ToUInt8(e)},e.ToInt8=function(e){return 127&e|(128&e)<<24>>24},e.ToInt16=function(e){return 32767&e|(32768&e)<<16>>16},e.ToInt32=function(e){return 2147483647&e|2147483648&e},e.ToUInt8=function(e){return 255&e},e.ToUInt16=function(e){return 65535&e},e.ToUInt32=function(e){return 4294967295&e},e})();e.Number=u;var a=function(e){this.Message=e};e.Exception=a;var f=function(){};e.KeyValuePair=f;var l=(function(){function e(){}return e.IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},e})();e.BrowserChecker=l})(e.Bond||(e.Bond={}))})(i||(i={})),(function(e){!(function(e){var t=(function(){function t(e){this._stream=e}return t.prototype.WriteBlob=function(e){this._stream.Write(e,0,e.length)},t.prototype.WriteBool=function(e){this._stream.WriteByte(e?1:0)},t.prototype.WriteContainerBegin=function(e,t){this.WriteUInt8(t),this.WriteUInt32(e)},t.prototype.WriteMapContainerBegin=function(e,t,n){this.WriteUInt8(t),this.WriteUInt8(n),this.WriteUInt32(e)},t.prototype.WriteContainerEnd=function(){},t.prototype.WriteDouble=function(t){var n=e.Encoding.Double.GetBytes(t);this._stream.Write(n,0,n.length)},t.prototype.WriteFloat=function(t){var n=e.Encoding.Float.GetBytes(t);this._stream.Write(n,0,n.length)},t.prototype.WriteFieldBegin=function(e,t,n){t<=5?this._stream.WriteByte(e|t<<5):t<=255?(this._stream.WriteByte(192|e),this._stream.WriteByte(t)):(this._stream.WriteByte(224|e),this._stream.WriteByte(t),this._stream.WriteByte(t>>8))},t.prototype.WriteFieldEnd=function(){},t.prototype.WriteFieldOmitted=function(e,t,n){},t.prototype.WriteInt16=function(t){t=e.Encoding.Zigzag.EncodeZigzag16(t),this.WriteUInt16(t)},t.prototype.WriteInt32=function(t){t=e.Encoding.Zigzag.EncodeZigzag32(t),this.WriteUInt32(t)},t.prototype.WriteInt64=function(t){this.WriteUInt64(e.Encoding.Zigzag.EncodeZigzag64(t))},t.prototype.WriteInt8=function(t){this._stream.WriteByte(e.Number.ToInt8(t))},t.prototype.WriteString=function(t){if(""==t)this.WriteUInt32(0);else{var n=e.Encoding.Utf8.GetBytes(t);this.WriteUInt32(n.length),this._stream.Write(n,0,n.length)}},t.prototype.WriteStructBegin=function(e,t){},t.prototype.WriteStructEnd=function(t){this.WriteUInt8(t?e.BondDataType.BT_STOP_BASE:e.BondDataType.BT_STOP)},t.prototype.WriteUInt16=function(t){var n=e.Encoding.Varint.GetBytes(e.Number.ToUInt16(t));this._stream.Write(n,0,n.length)},t.prototype.WriteUInt32=function(t){var n=e.Encoding.Varint.GetBytes(e.Number.ToUInt32(t));this._stream.Write(n,0,n.length)},t.prototype.WriteUInt64=function(t){var n=e.Encoding.Varint64.GetBytes(t);this._stream.Write(n,0,n.length)},t.prototype.WriteUInt8=function(t){this._stream.WriteByte(e.Number.ToUInt8(t))},t.prototype.WriteWString=function(e){this.WriteUInt32(e.length);for(var t=0;t<e.length;++t){var n=e.charCodeAt(t);this._stream.WriteByte(n),this._stream.WriteByte(n>>>8)}},t})();e.CompactBinaryProtocolWriter=t;var n=function(){};e.CompactBinaryProtocolReader=n})(e.Bond||(e.Bond={}))})(i||(i={}));!(function(e){var t=(function(){function t(){}return t.IsSafari=function(){if(null===t._isSafari)if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.toLowerCase();e.indexOf("safari")>=0&&e.indexOf("chrome")<0?t._isSafari=!0:t._isSafari=!1}else t._isSafari=!1;return t._isSafari},t.IsReactNative=function(){return null===t._isReactNative&&("undefined"!=typeof navigator&&navigator.product?t._isReactNative="ReactNative"===navigator.product:t._isReactNative=!1),t._isReactNative},t.IsUint8ArrSupported=function(){return!e.Utils.IsSafari()&&"undefined"!=typeof Uint8Array&&!e.Utils.IsReactNative()},t.ajax=function(e,n){var r=t._createConnection();if(e.headers){var i="qsp=true";for(var s in e.headers)i+="&",i+=encodeURIComponent(s),i+="=",i+=encodeURIComponent(e.headers[s]);e.url.indexOf("?")<0?e.url+="?":e.url+="&",e.url+=i}r.open(e.type,e.url,!n),e.complete&&(r.onload=function(){e.complete(r)},r.ontimeout=function(){e.complete(r)},r.onerror=function(){e.complete(r)},r.onabort=function(){e.complete(r)}),r.send(e.data)},t.keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},t.IsUsingXDomainRequest=function(){if(null==t._usingXDomainRequest){void 0===(new XMLHttpRequest).withCredentials&&"undefined"!=typeof XDomainRequest?t._usingXDomainRequest=!0:t._usingXDomainRequest=!1}return t._usingXDomainRequest},t._createConnection=function(){var e=new XMLHttpRequest;return t.IsUsingXDomainRequest()?new XDomainRequest:e},t})();t._isSafari=null,t._isReactNative=null,t._usingXDomainRequest=null,e.Utils=t})(s||(s={}));!(function(e){!(function(e){!(function(e){!(function(t){var n=(function(){function e(){}return e.GetGuid=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1,5)};return[e(),e(),"-",e(),"-",e(),"-",e(),"-",e(),e(),e()].join("")},e.GetTimeStamp=function(){var e=(new Date).getTime(),t=new i.Bond.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},e.GetTimeStampWithValue=function(e){var t=new i.Bond.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},e})();t.utils=n;!(function(e){e[e.NotSet=0]="NotSet",e[e.Event=1]="Event",e[e.PerformanceCounter=2]="PerformanceCounter",e[e.Anomaly=3]="Anomaly",e[e.Prediction=4]="Prediction",e[e.TraceLog=5]="TraceLog",e[e.EventSourceLog=6]="EventSourceLog",e[e.HttpLog=7]="HttpLog",e[e.PerformanceCounterAzure=8]="PerformanceCounterAzure",e[e.PerformanceCounterGfs=9]="PerformanceCounterGfs"})(t.RecordType||(t.RecordType={}));!(function(e){e[e.NotSet=0]="NotSet",e[e.O365=1]="O365",e[e.SkypeBI=2]="SkypeBI",e[e.SkypeData=3]="SkypeData"})(t.PIIScrubber||(t.PIIScrubber={}));!(function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"})(t.PIIKind||(t.PIIKind={}));!(function(e){e[e.Unknown=0]="Unknown",e[e.MSACID=1]="MSACID",e[e.MSAPUID=2]="MSAPUID",e[e.ANID=3]="ANID",e[e.OrgIdCID=4]="OrgIdCID",e[e.OrgIdPUID=5]="OrgIdPUID",e[e.UserObjectId=6]="UserObjectId",e[e.Skype=7]="Skype",e[e.Yammer=8]="Yammer",e[e.EmailAddress=9]="EmailAddress",e[e.PhoneNumber=10]="PhoneNumber",e[e.SipAddress=11]="SipAddress",e[e.MUID=12]="MUID"})(t.UserIdType||(t.UserIdType={}));var r=(function(){function t(){this.ScrubType=e.datamodels.PIIScrubber.NotSet,this.Kind=e.datamodels.PIIKind.NotSet,this.RawContent=""}return t.prototype.Write=function(e){this.WriteImpl(e,!1)},t.prototype.WriteImpl=function(t,n){t.WriteStructBegin(null,n),this.ScrubType!=e.datamodels.PIIScrubber.NotSet?(t.WriteFieldBegin(i.Bond.BondDataType.BT_INT32,1,null),t.WriteInt32(this.ScrubType),t.WriteFieldEnd()):t.WriteFieldOmitted(i.Bond.BondDataType.BT_INT32,1,null),this.Kind!=e.datamodels.PIIKind.NotSet?(t.WriteFieldBegin(i.Bond.BondDataType.BT_INT32,2,null),t.WriteInt32(this.Kind),t.WriteFieldEnd()):t.WriteFieldOmitted(i.Bond.BondDataType.BT_INT32,2,null),""!=this.RawContent?(t.WriteFieldBegin(i.Bond.BondDataType.BT_STRING,3,null),t.WriteString(this.RawContent),t.WriteFieldEnd()):t.WriteFieldOmitted(i.Bond.BondDataType.BT_STRING,3,null),t.WriteStructEnd(n)},t.prototype.Read=function(e){this.ReadImpl(e,!1)},t.prototype.ReadImpl=function(e,t){},t})();t.PII=r;var s=(function(){function t(){this.Id=n.GetGuid(),this.Timestamp=n.GetTimeStamp(),this.Type="",this.EventType="",this.Extension=new i.Bond.Collections.Map,this.RecordType=e.datamodels.RecordType.NotSet,this.PIIExtensions=new i.Bond.Collections.Map}return t.prototype.AddOrReplacePII=function(t,n,r){var i=new e.datamodels.PII;i.RawContent=n,i.Kind=r,i.ScrubType=e.datamodels.PIIScrubber.O365,this.PIIExtensions.AddOrReplace(t,i)},t.prototype.Write=function(e){this.WriteImpl(e,!1)},t.prototype.WriteImpl=function(t,n){if(t.WriteStructBegin(null,n),""!=this.Id?(t.WriteFieldBegin(i.Bond.BondDataType.BT_STRING,1,null),t.WriteString(this.Id),t.WriteFieldEnd()):t.WriteFieldOmitted(i.Bond.BondDataType.BT_STRING,1,null),this.Timestamp.Equals("0")?t.WriteFieldOmitted(i.Bond.BondDataType.BT_INT64,3,null):(t.WriteFieldBegin(i.Bond.BondDataType.BT_INT64,3,null),t.WriteInt64(this.Timestamp),t.WriteFieldEnd()),""!=this.Type?(t.WriteFieldBegin(i.Bond.BondDataType.BT_STRING,5,null),t.WriteString(this.Type),t.WriteFieldEnd()):t.WriteFieldOmitted(i.Bond.BondDataType.BT_STRING,5,null),""!=this.EventType?(t.WriteFieldBegin(i.Bond.BondDataType.BT_STRING,6,null),t.WriteString(this.EventType),t.WriteFieldEnd()):t.WriteFieldOmitted(i.Bond.BondDataType.BT_STRING,6,null),this.Extension.Count()){t.WriteFieldBegin(i.Bond.BondDataType.BT_MAP,13,null),t.WriteMapContainerBegin(this.Extension.Count(),i.Bond.BondDataType.BT_STRING,i.Bond.BondDataType.BT_STRING);for(var r=0;r<this.Extension.GetBuffer().length;++r)t.WriteString(this.Extension.GetBuffer()[r].Key),t.WriteString(this.Extension.GetBuffer()[r].Value);t.WriteContainerEnd(),t.WriteFieldEnd()}else t.WriteFieldOmitted(i.Bond.BondDataType.BT_MAP,13,null);if(this.RecordType!=e.datamodels.RecordType.NotSet?(t.WriteFieldBegin(i.Bond.BondDataType.BT_INT32,24,null),t.WriteInt32(this.RecordType),t.WriteFieldEnd()):t.WriteFieldOmitted(i.Bond.BondDataType.BT_INT32,24,null),this.PIIExtensions.Count()){t.WriteFieldBegin(i.Bond.BondDataType.BT_MAP,30,null),t.WriteMapContainerBegin(this.PIIExtensions.Count(),i.Bond.BondDataType.BT_STRING,i.Bond.BondDataType.BT_STRUCT);for(var s=0;s<this.PIIExtensions.GetBuffer().length;++s)t.WriteString(this.PIIExtensions.GetBuffer()[s].Key),this.PIIExtensions.GetBuffer()[s].Value.WriteImpl(t,!1);t.WriteContainerEnd(),t.WriteFieldEnd()}else t.WriteFieldOmitted(i.Bond.BondDataType.BT_MAP,30,null);t.WriteStructEnd(n)},t.prototype.Read=function(e){this.ReadImpl(e,!1)},t.prototype.ReadImpl=function(e,t){},t})();t.Record=s;var o=(function(){function e(){this.Source="",this.DataPackageId="",this.Timestamp=new i.Bond.Int64("0"),this.Records=[]}return e.prototype.Write=function(e){this.WriteImpl(e,!1)},e.prototype.WriteImpl=function(e,t){if(e.WriteStructBegin(null,t),""!=this.Source?(e.WriteFieldBegin(i.Bond.BondDataType.BT_STRING,2,null),e.WriteString(this.Source),e.WriteFieldEnd()):e.WriteFieldOmitted(i.Bond.BondDataType.BT_STRING,2,null),""!=this.DataPackageId?(e.WriteFieldBegin(i.Bond.BondDataType.BT_STRING,5,null),e.WriteString(this.DataPackageId),e.WriteFieldEnd()):e.WriteFieldOmitted(i.Bond.BondDataType.BT_STRING,5,null),this.Timestamp.Equals("0")?e.WriteFieldOmitted(i.Bond.BondDataType.BT_INT64,6,null):(e.WriteFieldBegin(i.Bond.BondDataType.BT_INT64,6,null),e.WriteInt64(this.Timestamp),e.WriteFieldEnd()),this.Records.length){e.WriteFieldBegin(i.Bond.BondDataType.BT_LIST,8,null),e.WriteContainerBegin(this.Records.length,i.Bond.BondDataType.BT_STRUCT);for(var n=0;n<this.Records.length;++n)this.Records[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(i.Bond.BondDataType.BT_LIST,8,null);e.WriteStructEnd(t)},e.prototype.Read=function(e){this.ReadImpl(e,!1)},e.prototype.ReadImpl=function(e,t){},e})();t.DataPackage=o;var u=(function(){function e(){this.DataPackages=[],this.RequestRetryCount=0}return e.prototype.Write=function(e){this.WriteImpl(e,!1)},e.prototype.WriteImpl=function(e,t){if(e.WriteStructBegin(null,t),this.DataPackages.length){e.WriteFieldBegin(i.Bond.BondDataType.BT_LIST,1,null),e.WriteContainerBegin(this.DataPackages.length,i.Bond.BondDataType.BT_STRUCT);for(var n=0;n<this.DataPackages.length;++n)this.DataPackages[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(i.Bond.BondDataType.BT_LIST,1,null);0!=this.RequestRetryCount?(e.WriteFieldBegin(i.Bond.BondDataType.BT_INT32,2,null),e.WriteInt32(this.RequestRetryCount),e.WriteFieldEnd()):e.WriteFieldOmitted(i.Bond.BondDataType.BT_INT32,2,null),e.WriteStructEnd(t)},e.prototype.Read=function(e){this.ReadImpl(e,!1)},e.prototype.ReadImpl=function(e,t){},e})();t.ClientToCollectorRequest=u})(e.datamodels||(e.datamodels={}))})(e.telemetry||(e.telemetry={}))})(e.applications||(e.applications={}))})(o||(o={}));!(function(e){!(function(e){!(function(e){!(function(t){var n,o;!(function(e){e[e.SENT=0]="SENT",e[e.SEND_FAILED=1]="SEND_FAILED"})(n=t.CallbackEventType||(t.CallbackEventType={}));!(function(e){e[e.DATARV_ERROR_OK=0]="DATARV_ERROR_OK",e[e.DATARV_ERROR_INVALID_EVENT=1]="DATARV_ERROR_INVALID_EVENT",e[e.DATARV_ERROR_INVALID_CONFIG=2]="DATARV_ERROR_INVALID_CONFIG",e[e.DATARV_ERROR_INVALID_DEPENDENCIES=3]="DATARV_ERROR_INVALID_DEPENDENCIES",e[e.DATARV_ERROR_INVALID_STATUS=4]="DATARV_ERROR_INVALID_STATUS",e[e.DATARV_ERROR_INVALID_ARG=5]="DATARV_ERROR_INVALID_ARG"})(o=t.DATARV_ERROR||(t.DATARV_ERROR={}));var u=(function(){function e(e){this._errorCode=o.DATARV_ERROR_OK,this._errorCode=e}return e.prototype.ErrorCode=function(){return this._errorCode},e.prototype.toString=function(){switch(this._errorCode){case o.DATARV_ERROR_OK:return"DATARV_ERROR_OK";case o.DATARV_ERROR_INVALID_EVENT:return"Event is invalid. Either event.Id is empty, or event.Timestamp is empty, or event.EventType is empty.";case o.DATARV_ERROR_INVALID_CONFIG:return"Invalid configuration. CollectorUrl is missing.";case o.DATARV_ERROR_INVALID_DEPENDENCIES:return"DATARV_ERROR_INVALID_DEPENDENCIES";case o.DATARV_ERROR_INVALID_STATUS:return"Telemetry Manager is not initialized.";case o.DATARV_ERROR_INVALID_ARG:return"TenantToken is null or empty, or events is null.";default:return"Unknown error"}},e})();t.Exception=u;var a=function(){};t.TelemetryConfig=a;var f=(function(){function e(){}return e.CreateTelemetryManager=function(){return new h},e})();t.TelemetryManagerFactory=f;var l,c=(function(){function e(){}return e.MaxPackageSizeInBytes=function(){return 3e6},e.TimeIntervalForNextSendInMS=function(){return 1e3},e})();!(function(e){e[e.Created=0]="Created",e[e.Initialized=1]="Initialized",e[e.Started=2]="Started"})(l||(l={}));var h=(function(){function t(){this._MaxPackageSizeInBytes=c.MaxPackageSizeInBytes(),this._listeners=[],this._status=l.Created,this._etag=null,this._testServerResponseHook=null,this._isPaused=!1}return t.prototype.Initialize=function(e){if(this._status!=l.Created)throw new u(o.DATARV_ERROR_INVALID_STATUS);if(!e||!e.collectorUrl)throw new u(o.DATARV_ERROR_INVALID_CONFIG);this._config=e,this._Reset(),this._status=l.Initialized,this._Verbose("Initialize() done")},t.prototype.AddListener=function(e){if(this._status<l.Initialized)throw new u(o.DATARV_ERROR_INVALID_STATUS);this._Verbose(["AddListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return void this._Verbose("the listener has been added already, index: "+t);this._listeners.push(e),this._Verbose("AddListener() done, the new length: "+this._listeners.length)},t.prototype.RemoveListener=function(e){if(this._status<l.Initialized)throw new u(o.DATARV_ERROR_INVALID_STATUS);this._Verbose(["RemoveListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return 1==this._listeners.length?this._listeners=[]:t==this._listeners.length-1?this._listeners.pop():this._listeners[t]=this._listeners.pop(),void this._Verbose(["this listener has been found, index: ",t,"new length: ",this._listeners.length].join(""));this._Verbose("listener isn't been found, new length"+this._listeners.length)},t.prototype.Start=function(){if(this._status<l.Initialized)throw new u(o.DATARV_ERROR_INVALID_STATUS);this._Verbose(["Start(), status:",this._status,"tag:",t._tag].join(" ")),this._status>=l.Started&&this._Verbose("Start() already, ignore"),++t._tag,this._status=l.Started,this._Verbose(["Start() done, status: ",this._status,"tag: ",t._tag].join(""))},t.prototype.Stop=function(){if(this._status<l.Initialized)throw new u(o.DATARV_ERROR_INVALID_STATUS);return this._Verbose("Stop(), status: "+this._status),this._status==l.Initialized?void this._Verbose("Stop() already, ignore"):(this._Reset(),this._status=l.Initialized,void this._Verbose("Stop() done, status: "+this._status))},t.prototype.Pause=function(){this._isPaused=!0,this._CleanTimer()},t.prototype.Resume=function(){this._isPaused=!1,this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1)},t.prototype.Flush=function(e){this._eventsCache.IsEmpty()||this._WorkThread(e,!0)},t.prototype.SendAsync=function(e,n){if(this._status<l.Initialized)throw new u(o.DATARV_ERROR_INVALID_STATUS);if(this._Verbose(["SendAsync(), status:",this._status,"tenantToken:",e,"count:",n.length].join(" ")),this._status<l.Started)return this._Info("SendAsync(), not started, ignore, return false"),!1;if(!e||!n)throw this._Error("SendAsync(), tenantToken or events is null or empty"),new u(o.DATARV_ERROR_INVALID_ARG);for(var r=0;r<n.length;++r)if(!n[r].Id||!t._eventTypeRegex.test(n[r].EventType)||n[r].Timestamp.Equals("0"))throw this._Error(["eventId:",n[r].Id,"eventType:",n[r].EventType,"timestamp high:",n[r].Timestamp.high,"timestamp low:",n[r].Timestamp.low].join("")),new u(o.DATARV_ERROR_INVALID_EVENT);return this._eventsCache.AddEvents(e,n),this._Verbose(["SendAsync(), currentTimer: ",this._timer,"eventsCacheIsEmpty",this._eventsCache.IsEmpty()].join(" ")),this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1),this._Verbose("SendAsync() done"),!0},t.prototype._WorkThread=function(e,n){var o=this;try{if(this._Verbose("_WorkThread, status: "+this._status),this._status<l.Started)return void this._Verbose("_WorkThread, status is not started, return");var u=this._eventsCache.DequeuEvents();if(null==u)return this._Verbose("_WorkThread, No events found, return"),void this._CleanTimer();var a=this._PackEvents(u.tenantToken,u.events);if(this._eventsCache.AddEvents(u.tenantToken,a.remainedEvents),null==a.buffer||0==a.buffer.length)return void(this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1)));if(this._testServerResponseHook){var f=this._testServerResponseHook();return void setTimeout(this._SendCallback(h,u.tenantToken,a.sendEvents,f,!1,null),100)}var c={type:"POST",url:this._config.collectorUrl,processData:!1,headers:{"content-type":"application/bond-compact-binary","client-id":"NO_AUTH","sdk-version":"ACT-Web-JS-"+r.version},complete:function(t){return o._SendCallback(h,u.tenantToken,a.sendEvents,t,n,e)}};s.Utils.IsUint8ArrSupported()?(this._Verbose("Uint8Array is defined, send with binary format directly."),c.data=new Uint8Array(a.buffer)):(this._Verbose("Uint8Array is undefined, send with base64 encode."),c.data=i.Bond.Encoding.Base64.GetString(a.buffer),c.headers["content-encoding"]="base64"),u.tenantToken&&(c.headers["x-apikey"]=u.tenantToken);var h=t._tag;this._lastActiveTime=(new Date).getTime(),s.Utils.ajax(c,n),this._Verbose("_Workthread, send via jquery, tag: "+h)}catch(e){this._Error("_WorkThread, exception: "+e)}},t.prototype._PackEvents=function(t,n){this._Verbose("_PackageEvents, total Count: "+n.length);var r=new e.datamodels.ClientToCollectorRequest,i=new e.datamodels.DataPackage;i.Source="JS_default_source",i.DataPackageId=e.datamodels.utils.GetGuid(),i.Timestamp=e.datamodels.utils.GetTimeStamp();var s,o=n;for(n=[];i.Records=[],i.Records.push.apply(i.Records,o),r.DataPackages=[],r.DataPackages.push(i),s=this._Serialize(r),this._Verbose(["_PackageEvents, sendEvents.length:",o.length,"buffer.length:",s.length,"MaxPackageSize:",this._MaxPackageSizeInBytes].join("")),!(s.length<this._MaxPackageSizeInBytes);){if(1==o.length){o=[],s=null;break}var u=o.splice(0,Math.floor(o.length/2));this._Verbose("_PackageEvents, too large, package again"),n.push.apply(n,o),o=u}return this._Verbose(["_PakcageEvents done, sendEventsCount:",o.length,"buffer.length:",null==s?0:s.length,"remained events:",n.length].join("")),{buffer:s,sendEvents:o,remainedEvents:n}},t.prototype._Serialize=function(e){var t=new i.Bond.IO.MemoryStream,n=new i.Bond.CompactBinaryProtocolWriter(t);return e.Write(n),t.GetBuffer()},t.prototype._SendCallback=function(e,r,i,s,o,u){if(this._Verbose(["_SendCallback","tag:",e,"current tag:",t._tag,"tenantToken:",r,"events count:",i.length,"jqXHR:",s].join("")),u&&u(s?s.status:0,r,i),!o){var a=s&&void 0!==s.status&&200===s.status;if(this._status<l.Started||e<t._tag)return void this._Verbose("_SendCallback, is not started, or tag is not the same, return");if(!a){if(s&&void 0!==s.status&&501!==s.status&&505!==s.status&&(s.status<300||s.status>=500||408===s.status)||!s||void 0===s.status)return this._Verbose("retry statusCode: "+(s?s.status:0)),this._eventsCache.AddEvents(r,i),void this._ScheduleTimer(!0)}for(var f=0;f<this._listeners.length;++f)this._listeners[f](a?n.SENT:n.SEND_FAILED,s?s.status:0,r,i);this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1))}},t.prototype._CleanTimer=function(){this._Verbose("_CleanTimer(), timer: "+this._timer),this._timer&&(clearTimeout(this._timer),this._timer=null)},t.prototype._ScheduleTimer=function(e){var t=this;if(!this._isPaused)if(this._Verbose("_ScheduleTimer: isRetry: "+e),this._CleanTimer(),e){this._Verbose("_ScheduleTimer, current factor: "+this._rescheduleFactor);var n=Math.floor(5*this._rescheduleFactor*(1+Math.random()));this._timer=setTimeout(function(){return t._WorkThread(null,!1)},1e3*n),this._Verbose("_ScheduleTimer, next try (s): "+n),this._rescheduleFactor<<=1,this._rescheduleFactor>64&&(this._rescheduleFactor=1)}else{n=0;var r=(new Date).getTime()-this._lastActiveTime;n=r>c.TimeIntervalForNextSendInMS()?0:c.TimeIntervalForNextSendInMS()-r,this._timer=setTimeout(function(){return t._WorkThread(null,!1)},n),this._Verbose("_ScheduleTimer, next try: "+n),this._rescheduleFactor=1}},t.prototype._Verbose=function(e){this._config.log&&this._config.log.Verbose("[TelemetryManagerImpl]: "+e)},t.prototype._Info=function(e){this._config.log&&this._config.log.Info("[TelemetryManagerImpl]: "+e)},t.prototype._Error=function(e){this._config.log&&this._config.log.Error("[TelemetryManagerImpl]: "+e)},t.prototype._Reset=function(){this._Verbose("Reset()"),this._CleanTimer(),this._lastActiveTime=0,this._rescheduleFactor=1,this._sendingEvents=[],this._eventsCache=new p},t.prototype.__GetListenerArray=function(){return this._listeners},t.prototype.__GetTotalEventsCount=function(){return this._eventsCache.GetTotalEventsCount()},t.prototype.__IsScheduled=function(){return null!=this._timer},t.prototype.__ChageMaxPackageSizeInKB=function(e){this._MaxPackageSizeInBytes=1024*e},t.prototype.__SetTestServerResponseHook=function(e){this._testServerResponseHook=e},t})();h._eventTypeRegex=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,h._tag=0;var p=(function(){function e(){this._events={},this._tokens=[]}return e.prototype.AddEvents=function(e,t){t.length&&(this._events[e]||(this._events[e]=[],this._tokens.push(e)),this._events[e].push.apply(this._events[e],t))},e.prototype.IsEmpty=function(){return 0==this._tokens.length},e.prototype.DequeuEvents=function(){if(0==this._tokens.length)return null;var e=this._tokens.shift(),t=this._events[e];return delete this._events[e],{tenantToken:e,events:t}},e.prototype.GetTotalEventsCount=function(){var e=0;for(var t in this._events)e+=this._events[t].length;return e},e})()})(e._sender||(e._sender={}))})(e.telemetry||(e.telemetry={}))})(e.applications||(e.applications={}))})(o||(o={}));!(function(e){!(function(t){!(function(t){var n=t._sender.TelemetryManagerFactory.CreateTelemetryManager(),i=function(){this.collectorUrl=null,this.enableAutoUserSession=!1,this.browserOverrides=null,this.disableCookies=!1};i.COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",i.COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",i.COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",i.COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",i.COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/",t.LogConfiguration=i;var s=function(){this.onSaveData=null,this.onGetData=null};t.LogConfigurationBrowserOverrides=s;var o,u=(function(){function e(){this.value=null,this.pii=null}return e._isPii=function(e){return null!=e&&e!==t.datamodels.PIIKind.NotSet&&!isNaN(e)&&void 0!==t.datamodels.PIIKind[e]},e})(),a=(function(){function e(){this.name=null,this.timestamp=null,this.properties={},this.eventType=null}return e.prototype.setProperty=function(n,r,i){if(!n||!e._propertyNameRegex.test(n))throw new f(o.INVALID_PROPERTY_NAME);this.properties[n]=i?{value:r,pii:i!=t.datamodels.PIIKind.NotSet?i:null}:{value:r,pii:null}},e})();a._propertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,t.EventProperties=a;!(function(e){e[e.INVALID_TENANT_TOKEN=1]="INVALID_TENANT_TOKEN",e[e.MISSING_EVENT_PROPERTIES_NAME=2]="MISSING_EVENT_PROPERTIES_NAME",e[e.INVALID_PROPERTY_NAME=3]="INVALID_PROPERTY_NAME",e[e.MISSING_FAILURE_SIGNATURE=5]="MISSING_FAILURE_SIGNATURE",e[e.MISSING_FAILURE_DETAIL=6]="MISSING_FAILURE_DETAIL",e[e.MISSING_PAGEVIEW_ID=7]="MISSING_PAGEVIEW_ID",e[e.MISSING_PAGEVIEW_NAME=8]="MISSING_PAGEVIEW_NAME",e[e.INVALID_SESSION_STATE=9]="INVALID_SESSION_STATE",e[e.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET=10]="INVALID_CONFIGURATION_USE_CUSTOM_GET_SET"})(o=t.TelemetryError||(t.TelemetryError={}));var f=(function(){function e(e){this.errorCode=null,this.errorCode=e}return e.prototype.ErrorCode=function(){return this.errorCode},e.prototype.toString=function(){switch(this.errorCode){case o.INVALID_TENANT_TOKEN:return"Invalid tenant token";case o.MISSING_EVENT_PROPERTIES_NAME:return"Eventproperties.name can not be null or empty";case o.INVALID_PROPERTY_NAME:return"Invalid Key. Key does not conform to regular expression ^[a-zA-Z0-9](([a-zA-Z0-9|_|.]){0,98}[a-zA-Z0-9])?$";case o.MISSING_FAILURE_SIGNATURE:return"Failure signature can't be null or empty.";case o.MISSING_FAILURE_DETAIL:return"Failure detail can't be null or empty.";case o.MISSING_PAGEVIEW_ID:return"Pageview id can't be null or empty.";case o.MISSING_PAGEVIEW_NAME:return"Pageview name can't be null or empty.";case o.INVALID_SESSION_STATE:return"Session state has to be a value from the SessionState enum.";case o.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET:return"Invalid configuration provided during initialization. Both onGetConfigData and onSaveConfigData must be provided together.  These are manditory when running in a non-brower enviornment";default:return"Unknown error"}},e})();t.Exception=f;var l=(function(){function n(e){this.contextMap={},this.piiKind=t.datamodels.PIIKind.NotSet,this._allowDeviceInfoFields=!1,this._allowDeviceInfoFields=e}return n.prototype.setAppId=function(e){e&&(this.contextMap["AppInfo.Id"]=e)},n.prototype.setAppVersion=function(e){e&&(this.contextMap["AppInfo.Version"]=e)},n.prototype.setAppLanguage=function(e){e&&(this.contextMap["AppInfo.Language"]=e)},n.prototype.setDeviceId=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.Id"]=e,h.checkAndUpdateDeviceId(e))},n.prototype.setDeviceOsName=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.OsName"]=e)},n.prototype.setDeviceOsVersion=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.OsVersion"]=e)},n.prototype.setDeviceBrowserName=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.BrowserName"]=e)},n.prototype.setDeviceBrowserVersion=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.BrowserVersion"]=e)},n.prototype.setUserId=function(t,n,r){if(t&&(this.contextMap["UserInfo.Id"]=t),r)this.contextMap["UserInfo.IdType"]=r;else{var i;switch(n){case e.applications.telemetry.datamodels.PIIKind.SipAddress:i=e.applications.telemetry.datamodels.UserIdType.SipAddress;break;case e.applications.telemetry.datamodels.PIIKind.PhoneNumber:i=e.applications.telemetry.datamodels.UserIdType.PhoneNumber;break;case e.applications.telemetry.datamodels.PIIKind.SmtpAddress:i=e.applications.telemetry.datamodels.UserIdType.EmailAddress;break;default:i=e.applications.telemetry.datamodels.UserIdType.Unknown}this.contextMap["UserInfo.IdType"]=i}if(n)u._isPii(n)&&(this.piiKind=n);else{var s;switch(r){case e.applications.telemetry.datamodels.UserIdType.Skype:s=e.applications.telemetry.datamodels.PIIKind.Identity;break;case e.applications.telemetry.datamodels.UserIdType.EmailAddress:s=e.applications.telemetry.datamodels.PIIKind.SmtpAddress;break;case e.applications.telemetry.datamodels.UserIdType.PhoneNumber:s=e.applications.telemetry.datamodels.PIIKind.PhoneNumber;break;case e.applications.telemetry.datamodels.UserIdType.SipAddress:s=e.applications.telemetry.datamodels.PIIKind.SipAddress;break;default:s=e.applications.telemetry.datamodels.PIIKind.NotSet}u._isPii(s)&&(this.piiKind=s)}},n.prototype.setUserMsaId=function(e){e&&(this.contextMap["UserInfo.MsaId"]=e)},n.prototype.setUserANID=function(e){e&&(this.contextMap["UserInfo.ANID"]=e)},n.prototype.setUserAdvertisingId=function(e){e&&(this.contextMap["UserInfo.AdvertisingId"]=e)},n.prototype.setUserTimeZone=function(e){e&&(this.contextMap["UserInfo.TimeZone"]=e)},n.prototype.setUserLanguage=function(e){e&&(this.contextMap["UserInfo.Language"]=e)},n})();t.SemanticContext=l;var c,h=(function(){function e(){}return e.initialize=function(n,r){this._overrides=n,this._disableCookies=r;var i=e._getAppLanguage();i&&e.semanticContext.setAppLanguage(i);var s=e._getUserLanguage();s&&e.semanticContext.setUserLanguage(s);var o=(new Date).getTimezoneOffset(),u=o%60,a=(o-u)/60,f="+";a>0&&(f="-"),e.semanticContext.setUserTimeZone(f+(a<10?"0"+a:a.toString())+":"+(u<10?"0"+u:u.toString()));if(e._getUserAgent()&&(e.semanticContext.setDeviceBrowserName(e._getBrowserName()),e.semanticContext.setDeviceBrowserVersion(e._getBrowserVersion()),e.semanticContext.setDeviceOsName(e._getOsName()),e.semanticContext.setDeviceOsVersion(e._getOsVersion())),this._disableCookies&&!this._overrides)return e._deleteCookie(e.DEVICE_ID_COOKIE),void e._deleteCookie(e.FIRST_LAUNCH_TIME_COOKIE);var l=e._getData(e.DEVICE_ID_COOKIE);l&&""!=l||(l=t.datamodels.utils.GetGuid()),e.semanticContext.setDeviceId(l)},e.checkAndUpdateDeviceId=function(t){var n=e._getData(e.DEVICE_ID_COOKIE),r=e._getData(e.FIRST_LAUNCH_TIME_COOKIE);n!==t&&(r=(new Date).getTime().toString()),e.firstLaunchTime=parseInt(r),e._saveData(e.DEVICE_ID_COOKIE,t),e._saveData(e.FIRST_LAUNCH_TIME_COOKIE,r)},e._saveData=function(t,n){if(this._overrides)this._overrides.onSaveData(t,n);else if("undefined"!=typeof document&&void 0!==document.cookie&&!e._disableCookies){var r=new Date;r.setTime(r.getTime()+31536e6);var i="expires="+r.toUTCString();document.cookie=t+"="+n+"; "+i}},e._getData=function(t){if(this._overrides)return this._overrides.onGetData(t)||"";if("undefined"!=typeof document&&void 0!==document.cookie&&!e._disableCookies)for(var n=t+"=",r=document.cookie.split(";"),i=0;i<r.length;i++){for(var s=r[i],o=0;" "==s.charAt(o);)o++;if(0==(s=s.substring(o)).indexOf(n))return s.substring(n.length,s.length)}return""},e._getUserAgent=function(){return"undefined"!=typeof navigator&&navigator.userAgent||""},e._getAppLanguage=function(){return"undefined"!=typeof document&&document.documentElement?document.documentElement.lang:null},e._getUserLanguage=function(){return"undefined"!=typeof navigator?navigator.userLanguage||navigator.language:null},e._userAgentContainsString=function(t){return e._getUserAgent().indexOf(t)>-1},e._isIe=function(){return e._userAgentContainsString("Trident")},e._isEdge=function(){return e._userAgentContainsString(e.BROWSERS.EDGE)},e._isOpera=function(){return e._userAgentContainsString("OPR/")},e._getBrowserName=function(){return e._isOpera()?e.BROWSERS.UNKNOWN:e._userAgentContainsString(e.BROWSERS.PHANTOMJS)?e.BROWSERS.PHANTOMJS:e._isIe()?e.BROWSERS.MSIE:e._isEdge()?e.BROWSERS.EDGE:e._userAgentContainsString(e.BROWSERS.ELECTRON)?e.BROWSERS.ELECTRON:e._userAgentContainsString(e.BROWSERS.CHROME)?e.BROWSERS.CHROME:e._userAgentContainsString(e.BROWSERS.FIREFOX)?e.BROWSERS.FIREFOX:e._userAgentContainsString(e.BROWSERS.SAFARI)?e.BROWSERS.SAFARI:e._userAgentContainsString(e.BROWSERS.SKYPE_SHELL)?e.BROWSERS.SKYPE_SHELL:e.BROWSERS.UNKNOWN},e._getBrowserVersion=function(){return e._isIe()?(function(){var t,n=e._getUserAgent(),r=n.match(new RegExp(e.BROWSERS.MSIE+" "+e.REGEX_VERSION));return r?r[1]:(t=n.match(new RegExp("rv:"+e.REGEX_VERSION)))?t[1]:void 0})():(function(t){var n;return t===e.BROWSERS.SAFARI&&(t="Version"),(n=e._getUserAgent().match(new RegExp(t+"/"+e.REGEX_VERSION)))?n[1]:e.UNKNOWN_VERSION})(e._getBrowserName())},e._getOsName=function(){return e._getUserAgent().match(/windows\sphone\s\d+\.\d+/i)?e.OPERATING_SYSTEMS.WINDOWS_PHONE:e._getUserAgent().match(/ arm;/i)?e.OPERATING_SYSTEMS.WINDOWS_RT:e._getUserAgent().match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?e.OPERATING_SYSTEMS.IOS:e._getUserAgent().match(/android/i)?e.OPERATING_SYSTEMS.ANDROID:e._getUserAgent().match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i)?e.OPERATING_SYSTEMS.LINUX:e._getUserAgent().match(/(macintosh|mac os x)/i)?e.OPERATING_SYSTEMS.MACOSX:e._getUserAgent().match(/(windows|win32)/i)?e.OPERATING_SYSTEMS.WINDOWS:e.OPERATING_SYSTEMS.UNKNOWN},e._getOsVersion=function(){return e._getOsName()===e.OPERATING_SYSTEMS.WINDOWS?(function(){var t=e._getUserAgent().match(new RegExp("Windows NT "+e.REGEX_VERSION));return t&&e.VERSION_MAPPINGS[t[1]]?e.VERSION_MAPPINGS[t[1]]:e.UNKNOWN_VERSION})():e._getOsName()===e.OPERATING_SYSTEMS.MACOSX?(function(){var t=e._getUserAgent().match(new RegExp(e.OPERATING_SYSTEMS.MACOSX+" "+e.REGEX_VERSION_MAC));if(t){var n=t[1].replace(/_/g,".");if(n){var r=(function(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null})(n);return r?n.split(r)[0]:n}}return e.UNKNOWN_VERSION})():e.UNKNOWN_VERSION},e})();h.semanticContext=new l(!0),h.firstLaunchTime=-1,h.BROWSERS={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",UNKNOWN:"Unknown"},h.OPERATING_SYSTEMS={WINDOWS:"Windows",MACOSX:"Mac OS X",WINDOWS_PHONE:"Windows Phone",WINDOWS_RT:"Windows RT",IOS:"iOS",ANDROID:"Android",LINUX:"Linux",UNKNOWN:"Unknown"},h.VERSION_MAPPINGS={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},h.REGEX_VERSION="([\\d,.]+)",h.REGEX_VERSION_MAC="([\\d,_,.]+)",h.UNKNOWN_VERSION="Unknown",h.DEVICE_ID_COOKIE="MicrosoftApplicationsTelemetryDeviceId",h.FIRST_LAUNCH_TIME_COOKIE="MicrosoftApplicationsTelemetryFirstLaunchTime",h._deleteCookie=function(e){"undefined"!=typeof document&&void 0!==document.cookie&&(document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},h._disableCookies=!1;!(function(e){e[e.STARTED=0]="STARTED",e[e.ENDED=1]="ENDED"})(c=t.SessionState||(t.SessionState={}));var p=(function(){function e(){}return e.initialize=function(t,r){if(!e._initialized){if(!t)throw new f(o.INVALID_TENANT_TOKEN);if(e._defaultToken=t,e._tmConfig.collectorUrl="https://browser.pipe.aria.microsoft.com/Collector/3.0/",e._configuration=r,!("undefined"!=typeof window||r&&r.browserOverrides&&r.browserOverrides.onGetData))throw new f(o.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET);var i=null;if(r)if(r.collectorUrl&&(e._tmConfig.collectorUrl=r.collectorUrl),r.browserOverrides){if(i=new s,r.browserOverrides.onGetData?!r.browserOverrides.onSaveData:r.browserOverrides.onSaveData)throw new f(o.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET);i.onGetData=r.browserOverrides.onGetData,i.onSaveData=r.browserOverrides.onSaveData}else r.disableCookies&&(e._sessionEnabled=!1);n.Initialize(e._tmConfig),n.Start(),h.initialize(i,r.disableCookies),e._initialized=!0,"undefined"!=typeof window&&window.addEventListener&&(r&&r.enableAutoUserSession&&(e._logger=new d,e._logger.logSession(c.STARTED)),window.addEventListener("beforeunload",e._teardown))}},e.pauseTransmission=function(){n.Pause()},e.resumeTransmission=function(){n.Resume()},e.flush=function(e){n.Flush(e)},e.addCallbackListener=function(t){e._initialized&&n.AddListener(t)},e.setContext=function(t,n,r){e._contextProperties.setProperty(t,n,r)},e.isInitialized=function(){return e._initialized},e.getDefaultToken=function(){return e._defaultToken},e.getSemanticContext=function(){return e._semanticContext},e._getInitIdForToken=function(n){return e._initIdMap[n]||(e._initIdMap[n]=t.datamodels.utils.GetGuid()),e._initIdMap[n]},e._getSequenceForToken=function(t){return e._sequenceMap[t]||(e._sequenceMap[t]=0),e._sequenceMap[t]++,e._sequenceMap[t]},e._teardown=function(){e._logger&&e._logger.logSession(c.ENDED),e.flush()},e.__backToUninitialized=function(){e._tmConfig=new t._sender.TelemetryConfig,e._semanticContext=new l(!0),e._contextProperties=new a,e._configuration=null,n=t._sender.TelemetryManagerFactory.CreateTelemetryManager(),e._initialized=!1,e._initIdMap={},e._sequenceMap={}},e})();p._initialized=!1,p._defaultToken=null,p._tmConfig=new t._sender.TelemetryConfig,p._logger=null,p._initIdMap={},p._sequenceMap={},p._configuration=null,p._contextProperties=new a,p._semanticContext=new l(!0),p._sessionEnabled=!0,t.LogManager=p;var d=(function(){function e(e){this._initId=null,this._tenantToken=null,this._contextProperties=new a,this._semanticContext=new l(!1),this._sessionStartTime=0,this._sessionId=null,this._tenantToken=e||p.getDefaultToken(),this._initId=p._getInitIdForToken(this._tenantToken)}return e.prototype.logEvent=function(e){if(!e.name)throw new f(o.MISSING_EVENT_PROPERTIES_NAME);var t=this._createEventRecord(e.name,e.eventType);this._addPropertiesAndSendEvent(t,e)},e.prototype.logFailure=function(e,t,n,r,i){if(!e)throw new f(o.MISSING_FAILURE_SIGNATURE);if(!t)throw new f(o.MISSING_FAILURE_DETAIL);var s=this._createEventRecord("failure","failure");s.Extension.Add("Failure.Signature",e),s.Extension.Add("Failure.Detail",t),n&&s.Extension.Add("Failure.Category",n),r&&s.Extension.Add("Failure.Id",r),this._addPropertiesAndSendEvent(s,i)},e.prototype.logPageView=function(e,t,n,r,i,s){if(!e)throw new f(o.MISSING_PAGEVIEW_ID);if(!t)throw new f(o.MISSING_PAGEVIEW_NAME);var u=this._createEventRecord("pageview","pageview");u.Extension.Add("PageView.Id",e),u.Extension.Add("PageView.Name",t),n&&u.Extension.Add("PageView.Category",n),r&&u.Extension.Add("PageView.Uri",r),i&&u.Extension.Add("PageView.ReferrerUri",i),this._addPropertiesAndSendEvent(u,s)},e.prototype.logSession=function(e,n){if(p._sessionEnabled){if(e!==c.STARTED&&e!==c.ENDED)throw new f(o.INVALID_SESSION_STATE);var r=this._createEventRecord("session","session");if(e===c.STARTED){if(this._sessionStartTime>0)return;this._sessionStartTime=(new Date).getTime(),this._sessionId=t.datamodels.utils.GetGuid(),r.Extension.Add("Session.Id",this._sessionId),r.Extension.Add("Session.State","Started")}else if(e===c.ENDED){if(0==this._sessionStartTime)return;var i=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);r.Extension.Add("Session.Duration",i.toString()),r.Extension.Add("Session.DurationBucket",this._getSessionDurationFromTime(i)),r.Extension.Add("Session.Id",this._sessionId),r.Extension.Add("Session.State","Ended"),this._sessionId=null,this._sessionStartTime=0}r.Extension.Add("Session.FirstLaunchTime",this._getISOString(new Date(h.firstLaunchTime))),this._addPropertiesAndSendEvent(r,n)}},e.prototype.getSessionId=function(){return this._sessionId},e.prototype.setContext=function(e,t,n){this._contextProperties.setProperty(e,t,n)},e.prototype.getSemanticContext=function(){return this._semanticContext},e.prototype._getSessionDurationFromTime=function(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"},e.prototype._createEventRecord=function(e,n){var i=new t.datamodels.Record;n||(n="custom"),i.EventType=e.toLowerCase(),i.Type=n.toLowerCase(),i.Extension.Add("EventInfo.Source","JS_default_source"),i.Extension.Add("EventInfo.InitId",this._initId),i.Extension.Add("EventInfo.Sequence",p._getSequenceForToken(this._tenantToken).toString()),i.Extension.Add("EventInfo.Name",e.toLowerCase());var s=new Date;return i.Timestamp=t.datamodels.utils.GetTimeStampWithValue(s.getTime()),i.Extension.Add("EventInfo.Time",this._getISOString(s)),i.Extension.Add("EventInfo.SdkVersion","ACT-Web-JS-"+r.version),i},e.prototype._getISOString=function(e){function t(e){return e<10?"0"+e:e.toString()}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+(function(e){return e<10?"00"+e:e<100?"0"+e:e.toString()})(e.getUTCMilliseconds())+"Z"},e.prototype._addCustomPropertiesToEvent=function(e,t){this._addSemanticContext(e,h.semanticContext),this._addSemanticContext(e,p._semanticContext),this._addSemanticContext(e,this._semanticContext),this._sessionId&&e.Extension.Add("Session.Id",this._sessionId),this._addEventPropertiesToEvent(e,p._contextProperties),this._addEventPropertiesToEvent(e,this._contextProperties),this._addEventPropertiesToEvent(e,t)},e.prototype._addSemanticContext=function(e,n){if(n&&n.contextMap){var r=n.contextMap;for(var i in n.contextMap)"UserInfo.Id"==i&&n.piiKind!=t.datamodels.PIIKind.NotSet?e.AddOrReplacePII(i,r[i],n.piiKind):e.Extension.AddOrReplace(i,r[i])}},e.prototype._addEventPropertiesToEvent=function(e,n){if(n){n.timestamp&&n.timestamp>=new Date("1/1/2000").getTime()&&(e.Timestamp=t.datamodels.utils.GetTimeStampWithValue(n.timestamp),e.Extension.AddOrReplace("EventInfo.Time",this._getISOString(new Date(n.timestamp)))),n.name&&(e.EventType=n.name.toLowerCase(),e.Extension.AddOrReplace("EventInfo.Name",n.name.toLowerCase()));var r=n.properties;if(r)for(var i in r)i&&(r[i].value||!1===r[i].value||0==r[i].value||""==r[i].value)&&(u._isPii(r[i].pii)?(e.AddOrReplacePII(i,r[i].value.toString(),r[i].pii),e.Extension.Remove(i)):(e.Extension.AddOrReplace(i,r[i].value.toString()),e.PIIExtensions.Remove(i)))}},e.prototype._addPropertiesAndSendEvent=function(e,t){this._addCustomPropertiesToEvent(e,t),p.isInitialized()&&(this._sanitizeName(e),n.SendAsync(this._tenantToken,[e]))},e.prototype._sanitizeName=function(e){var t=e.EventType.replace(/\./g,"_");e.EventType=t,e.Extension.AddOrReplace("EventInfo.Name",t)},e})();t.Logger=d})(t.telemetry||(t.telemetry={}))})(e.applications||(e.applications={}))})(o||(o={})),e.exports=o.applications.telemetry;e.exports=o.applications.telemetry}}]);